{
	"status": "ok",
	"feed": {
		"title": "余舜哲的 One Piece",
		"link": "http://chocoluffy.com/",
		"author": "Shunzhe Yu",
		"description": null,
		"image": ""
	},
	"items": [
		{
			"title": "写给高考三年后自己的一封信",
			"link": "http://chocoluffy.com/2016/06/11/%E5%86%99%E7%BB%99%E9%AB%98%E8%80%83%E4%B8%89%E5%B9%B4%E5%90%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%80%E5%B0%81%E4%BF%A1/",
			"guid": "http://chocoluffy.com/2016/06/11/写给高考三年后自己的一封信/",
			"pubDate": "2016-06-11T20:49:24.000Z",
			"categories": [
				"公众号文章",
				"日记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>这篇随笔，记为我对我高中思维的审判。 写给高考结束三年后的自己， 也写给所有刚刚结束高考乃至即将开始高中生活的小伙伴们。</p>",
			"content": "<p>这篇随笔，记为我对我高中思维的审判。 写给高考结束三年后的自己， 也写给所有刚刚结束高考乃至即将开始高中生活的小伙伴们。</p>\n<a></a>\n<blockquote>“One Piece到底存不存在，我不想知道。”</blockquote>\n\n<p><img src=\"http://ww2.sinaimg.cn/large/72f96cbagw1f4ryvevg44j21fn0cl79q\" alt=\"one piece\"></p>\n<p>3年前， 我刚结束高考， 坐在爸妈的车上一起从学校回家， 路上没多少车， 很像我当时空空的心。</p>\n<p>我是一个很容易有抽离感的人， 和周围的人与声音闹腾久了， 仿佛像一根针戳破了泡泡，我会安静下来。 还记得那天高考最后一门结束之后， 一群家长拥挤了课室， 突然一下子把我推进了陌生的热气腾腾。 然而我已经不记得当时的我送上了多少笑脸， 但我清楚的记得那种从未有过的空旷， 是高考的戛然而止意犹未尽也好， 还是一种抵达终点的疲态彷徨， 我站在那里， 听着最熟悉而陌生的寒暄， 无所适从。直到在人群里瞅见了爸爸妈妈， 我才回过了神， 当时就想一直抱着他们。</p>\n<p>太多人的掌声和欢呼让你觉得高考就是终点， 可没有多少人理解你的彷徨和张望。</p>\n<p>“好像一下子什么都结束了……”</p>\n<p>3年后，或是命运的偶然和眷顾， 我碾转在中山大学， 加州伯克利大学， 并于去年落脚在多伦多大学。 回望高中毕业这几年我走过的脚印， 太多太多的人与事牵扯着我， 震撼着我， 改变着我。 相比现在能够掌握着自己努力的痕迹和方向， “高考”两字对现在的我而言， 更像是翻看儿时日记那般哭笑不得旳嫌弃和惋惜。 嫌弃当时自己那种不能够再真实的空阔无助， 惋惜， 或许能够更早些为热爱的东西付出更多的机会。也正是这份切切实实的想法， 有时候让我发梦：如果让我回去三年前， 看着课桌前傻乎乎的自己， 我会和自己说写什么。</p>\n<p>一、</p>\n<p>我相信偶然， 不是否定去勤奋、去努力的意义， 不是去反驳人定胜天、铁杵成针的精神， 而是我希望更多的宽容。初中高中大量大量不需要天赋而强调记忆的训练， 中考高考前弥漫的三个月苦学逆袭的故事与激励， 太容易让我们去接受一个线性因果论的世界， 因为我这般这般的“付出”与训练， 我一定能得到即时可见的成果， 而往往成绩也很服气的提高更让我相信， “这条路我没有选错， 只是我还不够努力而已”， “他们的成绩还没有提高， 一定是还不够努力”的幻想。 很难讲这种思路对那个人的高考帮助到底大不大， 但这却是一种很残酷的逻辑。</p>\n<p>试想想， 在一个付出就有回报的世界里， 你所有的成功与荣光， 都只与你自己相关， 别人的失手挫折， 都只因为他们付出的不够多； 富人的富， 是天经地义的， 而穷人的穷， 也都无非是他们活该； 善良与同情变得胆怯了， 伸出的援手好像也因为“到底他值不值得我的帮助”的打量而颤抖， 我们生活在这样的世界里， 太容易变得坚硬而自负， 人定胜天不再是面对过程的鼓励而成了面对结果的嚣张。一个失去了尊重和惊喜的世界， 我不喜欢。</p>\n<p>我们想要尊重与惊喜， 我们会因此想要理解对方的不同和允许那变幻莫测的运气， 会想起宽容。 不是“如何如何原谅别人的错误”，而是相信自己的任何成就都离不开周遭人的相助与教诲， 都离不开前人的经验和教训， 相信没有那么理所当然。 感觉又像说起了大道理， 可对于一个高中生， 乃至现在许多的成年人过分的自我价值追求， 这最最简单的一条， 却一直不肯承认。</p>\n<p>我记得很清楚， 我初高中时候的“努力轨迹”。到初三前一直是吊车尾， 只到发现自己玩的最好的一群小伙伴和自己喜欢的女生都可以毫不费力地进省级重点班， 这成了自己当时努力的理由； 一直喜欢听宣布自己理科成绩的那一刻的掌声和赞叹， 这成了我选择奥数、奥化的理由； 因为老师在作业本上给我写了个“有灵气”， 成了我那三年那门课必须考满分的理由； 因为想要证明我比另一个同学更厉害， 成了我必须保持年纪前列不断去争第一的理由。林林总总的理由， 有笑有泪其中不乏充满了记忆与感动的理由， 只可惜， 没有一个理由是因为我喜欢……</p>\n<p>我所谓的成就， 不过是在某学科某考试上考的相对好一点罢了， 可我所付出的， 却是一段“太专注”的冲刺， 以致于根本没来得及想自己的热情和兴趣所在， 而自顾自地认为“我值得一切结果与荣誉”。 就像跑在跑道里的我们， 从来好像都没有质疑过跑道的方向， 而越跑越忘记了自己所属的那个方向， 乃至奔跑的意义。</p>\n<p>每个人都有走近舞台中央的时刻， 学会宽容打在自己身上的光，学会理解运气和偶然， 想的清楚别人的扶持与帮助， 更看得清自己究竟属不属于这个舞台， 毕竟这个世界上最简单而粗暴的忽悠， 就是叫你去看着别人跑到哪儿， 你也去那儿。 </p>\n<p>二、</p>\n<p>没有一个能解决所有问题的答案， 但是可以有一个更倾向改变的角度。</p>\n<p>下面这个故事是我在知乎上看到的一个印象很深刻的故事。 2016年普利兹克建筑奖得主Alejandro Aravena在2014年Ted论坛上的讲述他的设计哲学，开篇说道：如果设计有任何力量的话，那就是整合的力量。</p>\n<p>事情的起因源于12年前Alejandro曾接到的一个项目，他要为智利北部伊基克市中心非法占据了半公顷土地的100个家庭设计一套社会保障性住房。而得到的预算是1万美元。1万美元的用途，包括买地，建房子，以及建相关基础设施。绝对的资金匮乏让他提出了一个绝妙的方案：“一个普通中产家庭拥有80平方米的住房是可接受的，但如果资金不够，这个家庭可能只好去买40平方米的小房子。如果我们把这个40平方米的小房子，看做是一个80平方米的“好房子的一半”（half of a good house），来建造并提供给这些家庭，给予这些家庭另外40平方米的可拓展空间，那么这无疑鼓励了这些家庭在未来财力足够的时候“扩建”自己的房子，成功拥有一个完整的好房子。”（摘自知乎原文）很惊喜的是， 这些家庭大部分都同意了兴建， 不仅同意， 在主动助力修建工作， 因为未来的另一半也是要他们自己建的， 这是他们自己的房子。每户家庭想到的不再是如何和政府拉锯谈判， 而是对未来自己的房子的憧憬和期待。一个很简单却也更有人情味的角度， “撬动了人们的自发性，我认为，这就是一种“整合”，就是“设计的力量””。</p>\n<p>经济学的小伙伴可能很快就看出来了， 这貌似就是所谓的“外部利益内部化”的一个更经典的例子嘛。 小到多人合租房间的打扫卫生， 工作在大公司成为其中一颗齿轮， 大到保护地球生态环境， “搭便车行为”无所不在， “公地悲剧”也不断上演。 非要深究原因的话， 书上说是因为“公共物品产权难以界定”， 我说， 也不过就是当规模大了， 涉及的人多了， 就慢慢失去了归属感罢了。归属感， 一个带着温度的词语。 我不想去深入探讨“拥有”（所谓的“产权”）和“归属”到底区别在哪里， 简单来讲， 你“拥有的”并不一定能带给你“归属”感， 而归属， 自愿付出， 本身就沾着承诺与责任的味道。</p>\n<p>“拥有好房子的一半（half of a good house）”这简单的口号没有解决任何资源稀缺的问题， 而只是， 给了伊基克市中心的居民们重新清晰的归属感， 房子是自己未来好房子的一半， 我会认真粉刷， 仔细打扮， 悉心准备装饰那另一半的到来……没有一个能解决所有问题的答案， 但是可以找到一个更加打动的角度， 一个更有人情味儿的角度， 毕竟所有问题最终归根结底都回到人， 而人， 因为曾被温柔相待的归属， 更倾向改变。</p>\n<p>类似地， 精致有心旳设计， 真实客观的摄影， 复杂而饱满的戏剧， 这些艺术解决不了大部分现实问题， 却苦勤于人心。 他们努力提出一个角度， 无谓对与错， 更没办法用高中习惯的判分标准参考答案来审判， 往往出其不意， 往往保守误解， 可也因那更多数的理解和感动而孵育着改变。很难讲艺术的意义究竟是什么， 但如果一定要用一句话来概括， 我想是：</p>\n<p>我也会想成为温柔的人， 因为曾被温柔的人那样对待， 深深了解那种被温柔相待的感觉。</p>\n<p>或许这就是改变的初衷吧。</p>\n<p>三、</p>\n<p>“One Piece到底存不存在，我不想知道。”</p>\n<p>《海贼王》里面描述过很多不同身世背景的伙伴和路飞一起战斗的精彩剧情， 但对我来说同样难忘的， 还有另一幕， 当乌索普问冥王雷利， “那个独一无二的大秘宝One Piece， 究竟……”， 还没等乌索普说完， 路飞大吼一声， 谁也没有见过路飞这样严肃的表情， “宝藏在哪里我不想知道，连宝藏又没有我也不想知道， 虽然什么都不知道， 但是大家都是这样赌上性命出海的， 要是在这里就被大叔透露了……我就不当海贼了”。</p>\n<p>对于终点和意义的讨论从来没有停止过， 而高考， 在其重大的社会责任下背负了太多塑造一生、决定一生的名声， 可就像生命里其他重要的选择一样， 听过掌声， 走过低谷， 我们依旧要继续上路。意义是很私人的东西， 你做不到让别人帮你生活， 也做不到按图索骥去参悟旅行的意义， 希冀的快乐也远远不同于世界上其他任何人。 过早地接受了终点的模样而擦身而过无数或美妙或苦涩却都精彩无比的可能性， 或许正是所谓的“终点”最大的诅咒了吧。</p>\n<p>冥王雷利幽幽地问道， “伟大航路的艰险远远超出了你们的想象， 敌人都很强悍， 你办得到吗？统治这片大海。”， 路飞看着雷利， 咧开一个笑容， “我才不要统治呢， 这片大海上最自由的人， 就是海贼王！”</p>\n<p>时间仿佛停止在这一刻， 思绪宛若卷入一幕幕电影场景般跳跃， 肃立在舞台的正中央看着灯光慢慢聚拢， 光脚游走在柔和的森林， 再跳入环游世界的海贼船把手臂高高举起……想起了好多好多， 感慨了好多好多， 终于回过神， 才恍然自己有多么幸运。 高中的学习课余生活让我成长了太多， 在省实也让我认识了可以一起撒娇打诨很久很久的朋友。 但同时我也慢慢意识到， 面向高考的教育仿佛无可避免地让我们更容易接受线性因果的世界观， 存在面面俱到的标准答案和一种风光却道听途说的生活。</p>\n<p>这篇随笔，记为我对我高中思维的审判。 写给高考结束三年后的自己， 也写给所有刚刚结束高考乃至即将开始高中生活的小伙伴们。</p>\n<p>说实话， 在我刚上高中那年级， 脑子里除了跑跑卡丁车， 就是怪物猎人了吧。 日子过得特别慢， 谁会花功夫想这些折腾呢！</p>\n<p>虽然一直不擅于文字， 却很庆幸自己还存留着对文字的眷恋。也是想看看和文字里的自己一起成长吧。 </p>\n<p>新世相最近一篇关于高考的文章很有意思， 还记得里面开头的一个提问， 过去很多年，我真的从高考中夺回自己的控制权吗？</p>\n<p>Yes, finally.</p>"
		},
		{
			"title": "socket.io开发多人聊天室教程",
			"link": "http://chocoluffy.com/2016/05/23/socket-io%E5%BC%80%E5%8F%91%E5%A4%9A%E4%BA%BA%E8%81%8A%E5%A4%A9%E5%AE%A4%E6%95%99%E7%A8%8B/",
			"guid": "http://chocoluffy.com/2016/05/23/socket-io开发多人聊天室教程/",
			"pubDate": "2016-05-24T02:43:41.000Z",
			"categories": [
				"AWS",
				"nodejs",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>用socket.io搭配express写的一个多人聊天室应用， 同时借这个机会复习了一下socket及TCP/IP的一些细节知识， 在UI上用jquery， 简洁而快速地完成一些基础前端样式的开发， 开发时用nodemon和browser-sync来辅助开发流程。<a href=\"http://52.20.64.23/chatroom\">在线Demo-网页版</a>, <a href=\"https://github.com/chocoluffy/chatroom\">github源代码</a>, 欢迎提交bug issue或者pull request~</p>",
			"content": "<p>用socket.io搭配express写的一个多人聊天室应用， 同时借这个机会复习了一下socket及TCP/IP的一些细节知识， 在UI上用jquery， 简洁而快速地完成一些基础前端样式的开发， 开发时用nodemon和browser-sync来辅助开发流程。<a href=\"http://52.20.64.23/chatroom\" target=\"_blank\" rel=\"external\">在线Demo-网页版</a>, <a href=\"https://github.com/chocoluffy/chatroom\" target=\"_blank\" rel=\"external\">github源代码</a>, 欢迎提交bug issue或者pull request~</p>\n<a></a>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/1a5c1f59080e5cc1.png\" alt=\"socket.io\"></p>\n<h2>什么是socket?</h2><p>socket是对TCP/IP协议的封装， 本身是一个调用接口， 也就是我们常说的API， 用socket可以让程序员更方便的使用TCP/IP协议而已。 </p>\n<p>在学习C语言(csc209)的时候大家接触到的socket的接口函数比如<code>create/listen/connect/accept/send/read/write</code>， 实际上正是针对TCP编程的接口， 在课程里我们用C语言来实现TCP最基础的一个socket链接， 监听， 包括server-client之间的通信，同样的， socket这个调用接口也可以用java, python和nodejs任何后端语言来实现， 也会出现在各种各样需要服务器端和客户端通信的应用中。</p>\n<p>而什么是TCP呢？</p>\n<p>Transmission Control Protocol (TCP) 就是其中发送文本信息的<strong>规则规范</strong>而已。 TCP依赖更底层的函数实现来在网络上传输binary data。 这里和大家介绍telnet\\putty这些利用TCP在command line上帮助你发送和接受纯文本消息的应用， 你可以利用telnet来， 比如， 发送消息到google.com：<code>telnet google.com 80</code> 在端口80连接到google.com(80默认给网络请求)。我们当然不会随便发文本消息给google.com， 因为我们知道google.com不会接受随意的， 没有结构的文本请求。 是的， 我们需要一个<strong>标准(protocol)</strong>来规范交流的方式。我们在浏览器输出<a href=\"http://google.com%EF%BC%8C/\" target=\"_blank\" rel=\"external\">http://google.com，</a> 这意味着：</p>\n<ul><li>在port 80用TCP协议连接google.com的服务器。</li>\n<li>请求返回资源“／”（默认资源）。</li>\n<li>将请求用http（hypertext transfer protocol）的形式来规范。</li>\n</ul><h2>什么是socket.io?</h2><p>“Socket.IO goes a step beyond just providing an easy-to-use and more robust API on top<br>of web sockets. It also provides the ability to seamlessly use other real-time protocols if WebSockets are not available. For example, it will fall back on JSON long polling in the absence of WebSocket support.” from Rohit Rai</p>\n<p>简单来说，socket.io来socket本身的接口函数上再抽象了一层， 让程序员可以专注应用逻辑的开发， 而由socket.io来操作底层的函数调用和优化， 比如有些时候， 由于浏览器的原因不能使用web socket时， 可以默认用long polling来达到同样的效果。</p>\n<p>在socket.io出现之前，我们会采用很多的hack来解决一个问题：<strong>怎样在server和client端更有效率地双向传递信息？</strong>比如上文提到的long polling,  client端发送XHR请求， 然后在server端挂住， 直到server收到数据， 就回传数据， 还是比较常见的hack。</p>\n<p>直到HTML5的大规模使用， 出现了两种从服务器端推送数据到客户端的新方法， 一个是Server-Sent Events (SSE)， 另一个是今天的主角， 支持双向通信的WebSockets.</p>\n<h2>怎么用socket.io?</h2><h3>http模块实现</h3><p>下面用一个简单的例子来说明socket的使用， 很明确， 在服务器段当有新的连接的时候， 向客户端发送一个”greeting-from-server”的消息， 同时还监听客户端发来的”greeting-from-client”的事件，将消息打印在console里面。 </p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br></pre></td><td><pre><span><span>// plain http's version of server.js</span></span><br><span><span>var</span> http = <span>require</span>(<span>'http'</span>);</span><br><span>\tsocketIO = <span>require</span>(<span>'socket.io'</span>);</span><br><span>\tfs = <span>require</span>(<span>'fs'</span>);</span><br><span></span><br><span><span>// if using express framework, we can define router easier!</span></span><br><span><span>var</span> server = http.createServer(<span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\tfs.readFile(__dirname + <span>'/index.html'</span>, <span><span>function</span>(<span>err, data</span>)</span>{</span><br><span>\t\tres.writeHead(<span>200</span>);</span><br><span>\t\tres.end(data);</span><br><span>\t});</span><br><span>});</span><br><span></span><br><span><span>// The above code is used for create a server to serve the static index.html file under the current directory. The following part is the main idea of how to use socket.io to construct and listen to events.</span></span><br><span>server.listen(<span>3000</span>);</span><br><span><span>console</span>.log(<span>'listen on http://localhost:3000'</span>);</span><br><span></span><br><span>io = socketIO(server);</span><br><span></span><br><span>io.on(<span>'connection'</span>, <span><span>function</span>(<span>socket</span>)</span>{</span><br><span>\tsocket.emit(<span>'greeting-from-server'</span>, {</span><br><span>\t\tgreeting: <span>'Hello client!'</span></span><br><span>\t});</span><br><span></span><br><span>\tsocket.on(<span>'greeting-from-client'</span>, <span><span>function</span>(<span>msg</span>)</span>{</span><br><span>\t\t<span>console</span>.log(msg);</span><br><span>\t});</span><br><span>});</span><br></pre></td></tr></table></figure><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></pre></td><td><pre><span><span>&lt;!-- client side index.html  --&gt;</span></span><br><span><span>&lt;!DOCTYPE html&gt;</span></span><br><span><span>&lt;<span>html</span>&gt;</span></span><br><span>    <span>&lt;<span>head</span>&gt;</span></span><br><span>    <span>&lt;/<span>head</span>&gt;</span></span><br><span>    <span>&lt;<span>body</span>&gt;</span></span><br><span>        <span>&lt;<span>script</span> <span>src</span>=<span>\"/socket.io/socket.io.js\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span>        <span>&lt;<span>script</span>&gt;</span><span></span><br><span>            <span>var</span> socket = io(<span>'http://localhost:3000'</span>);</span><br><span>            socket.on(<span>'greeting-from-server'</span>, <span><span>function</span> (<span>message</span>) </span>{</span><br><span>                <span>document</span>.body.appendChild(</span><br><span>                    <span>document</span>.createTextNode(message.greeting)</span><br><span>                );</span><br><span>                socket.emit(<span>'greeting-from-client'</span>, {</span><br><span>                    greeting: <span>'Hello Server'</span></span><br><span>                });</span><br><span>            });</span><br><span>        </span><span>&lt;/<span>script</span>&gt;</span></span><br><span>    <span>&lt;/<span>body</span>&gt;</span></span><br><span><span>&lt;/<span>html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>代码很简洁。以上是用node原生的http模块来搭建的本地服务器， 还可以尝试使用express这个最负盛名的node框架之一来重新实现一下相同的逻辑。</p>\n<h3>Express模块实现</h3><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br></pre></td><td><pre><span><span>// express's version of server.js</span></span><br><span><span>var</span> express = <span>require</span>(<span>'express'</span>),</span><br><span>    app = express(),</span><br><span>    http = <span>require</span>(<span>'http'</span>),</span><br><span>    socketIO = <span>require</span>(<span>'socket.io'</span>),</span><br><span>    server, io;</span><br><span></span><br><span>app.get(<span>'/'</span>, <span><span>function</span> (<span>req, res</span>) </span>{</span><br><span>  res.sendFile(__dirname + <span>'/index.html'</span>);</span><br><span>});</span><br><span></span><br><span>server = http.Server(app);</span><br><span>server.listen(<span>5000</span>);</span><br><span>io = socketIO(server);</span><br><span></span><br><span>io.on(<span>'connection'</span>, <span><span>function</span> (<span>socket</span>) </span>{</span><br><span>  socket.emit(<span>'greeting-from-server'</span>, {</span><br><span>      greeting: <span>'Hello Client'</span></span><br><span>  });</span><br><span>  </span><br><span>  socket.on(<span>'greeting-from-client'</span>, <span><span>function</span> (<span>message</span>) </span>{</span><br><span>    <span>console</span>.log(message);</span><br><span>  });</span><br><span>});</span><br></pre></td></tr></table></figure><blockquote>\n<p>Express is a collection of HTTP utilities and middleware that make it easier to use Node as a web server.</p>\n</blockquote>\n<p>用<code>var app = express()</code>来创建一个Express应用，将这个Express app当作第一个参数传入HTTP模块得到本地的简易服务器，we told Node that we wanted to use Express as our handler for HTTP requests. 而这个服务器的作用是在接收到对“／”默认资源的请求时， 将index.html文件传回给客户端，也就是我们的浏览器上显示出内容。</p>\n<p>Next, we passed the HTTP server directly to the SocketIO method exactly as we would have if we were using a nonExpress HTTP server. Socket.IO took the server instance to listen for new socket connections on it. </p>\n<p>其中一个小细节：用 <code>emit</code> 来传输named message, 用 <code>send</code> 来传输a message without name.</p>\n<h2>多人在线聊天室</h2><p>下面是对以上应用的一个简单拓展。使用一个轮播(broadcasting)的方式， 将客户端传来的消息显示给每一个在线的用户。</p>\n<p><a href=\"https://github.com/chocoluffy/chatroom\" target=\"_blank\" rel=\"external\">github源代码    </a></p>\n<p><a href=\"http://52.20.64.23/chatroom\" target=\"_blank\" rel=\"external\">在线Demo-网页版</a></p>\n<p>在手机上也是可以用的， 不过UI没有专门针对移动端优化， 会有点糗的感觉😭。有bug汇报到Issue呀， 谢谢~</p>\n<h3>效果图Demo:</h3><p>[1] pick a nickname:<br><img src=\"http://ac-tc2vc5tu.clouddn.com/8d0dd106f5f226f4.png\" alt=\"demo-nickname\"></p>\n<p>[2] chatroom initialization:<br><img src=\"http://ac-tc2vc5tu.clouddn.com/8b9309129959f85e.png\" alt=\"demo-init\"></p>\n<p>[3] multi users chatting(one in chrome, another in safari):<br><img src=\"http://ac-tc2vc5tu.clouddn.com/4aa537ca52ea8080.png\" alt=\"demo-multusers\"></p>\n<h3>server端源代码</h3><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br></pre></td><td><pre><span><span>// A fragment of server.js</span></span><br><span><span>var</span> port = process.env.PORT || <span>3000</span>;</span><br><span>server.listen(port);</span><br><span><span>console</span>.log(<span>'listen on '</span> + port);</span><br><span></span><br><span><span>var</span> io = socketIO(server);</span><br><span><span>var</span> sockets = [];</span><br><span><span>var</span> ID2user = {}; <span>// username </span></span><br><span></span><br><span>io.on(<span>'connection'</span>, <span><span>function</span>(<span>socket</span>)</span>{</span><br><span>\tsockets.push(socket);</span><br><span>\t</span><br><span>\t<span>var</span> updateUserNum = <span><span>function</span>(<span>skt</span>)</span>{</span><br><span>\t\t<span>var</span> people = sockets.length === <span>1</span> ? <span>'person'</span> : <span>'people'</span>;</span><br><span>\t\tskt.emit(<span>'greeting-from-server'</span>, {</span><br><span>\t\t\tgreeting: <span>'Welcome! '</span> + sockets.length + <span>' '</span> + people + <span>' online now!'</span></span><br><span>\t\t});</span><br><span>\t};</span><br><span></span><br><span>\tupdateUserNum(socket);</span><br><span></span><br><span>\t<span>// boardcast?!</span></span><br><span>\tsocket.on(<span>'message'</span>, <span><span>function</span>(<span>message</span>)</span>{</span><br><span>\t\t<span>var</span> userlistChanged = <span>false</span>;</span><br><span>\t\t<span>if</span>(!ID2user[socket.id]){ <span>// if new user comes in.</span></span><br><span>\t\t\t<span>var</span> profile = {</span><br><span>\t\t\t\tusername: message.username,</span><br><span>\t\t\t\tavatar: message.avatar</span><br><span>\t\t\t};</span><br><span>\t\t\tID2user[socket.id] = profile;</span><br><span>\t\t\tuserlistChanged = <span>true</span>;</span><br><span>\t\t}</span><br><span>\t\t<span>for</span>(<span>var</span> i=<span>0</span>; i &lt; sockets.length; i++){</span><br><span>\t\t\tsockets[i].emit(<span>'message'</span>, message);</span><br><span>\t\t\t<span>if</span>(userlistChanged){ <span>// update userlist when new user comes in.</span></span><br><span>\t\t\t\t<span>console</span>.log(ID2user[socket.id].username + <span>'(id: '</span> + socket.id + <span>' )'</span> + <span>'joins!'</span>);</span><br><span>\t\t\t\tsockets[i].emit(<span>'userlist'</span>, ID2user);</span><br><span>\t\t\t\tupdateUserNum(sockets[i]);</span><br><span>\t\t\t}</span><br><span>\t\t}</span><br><span>\t});</span><br><span></span><br><span>\tsocket.on(<span>'disconnect'</span>, <span><span>function</span>(<span></span>)</span>{</span><br><span>\t\t<span>for</span>(<span>var</span> i=<span>0</span>; i&lt;sockets.length; i++){</span><br><span>\t\t\t<span>if</span>(sockets[i].id === socket.id){</span><br><span>\t\t\t\tsockets.splice(i, <span>1</span>);</span><br><span>\t\t\t}</span><br><span>\t\t}</span><br><span>\t\t<span>var</span> usernameOut = ID2user[socket.id].username;</span><br><span>\t\t<span>delete</span> ID2user[socket.id]; <span>// remove user from online users.</span></span><br><span>\t\t<span>// send to client an updated userlist.</span></span><br><span>\t\t<span>for</span>(<span>var</span> i=<span>0</span>; i &lt; sockets.length; i++){</span><br><span>\t\t\t<span>console</span>.log(usernameOut + <span>'(id: '</span> + socket.id + <span>' )'</span> + <span>'leaves...'</span>);</span><br><span>\t\t\tsockets[i].emit(<span>'userlist'</span>, ID2user);</span><br><span>\t\t\tupdateUserNum(sockets[i]);</span><br><span>\t\t}</span><br><span>\t\t<span>console</span>.log(<span>\"There are \"</span> + sockets.length + <span>\" active sockets remaining.\"</span>);</span><br><span>\t});</span><br><span>});</span><br></pre></td></tr></table></figure><p>由于我们需要将这个应用放在服务器上看效果， 所以port number就不能一直是本地的localhost了， 需要改成<code>var port = process.env.PORT || 3000;</code>。</p>\n<h3>达到的效果</h3><ul><li>显示同时在线的人数和user list。根据你自己选的nickname在user list上显示。</li>\n<li>每当有人加入或者disconnect的时候，更新所有客户端的user list。同时console都会有记录。</li>\n<li>每当有客户端发送消息的时候， broadcasting给所有在线用户。</li>\n</ul><h3>TODOs</h3><ul><li>local cache most frequent online users, to make the message transfer much much more efficient and effective. </li>\n<li>support image transfer, which should be quite similar to text message, but rather using binary image data. </li>\n<li>introduce animation!! this part should be quite familiar to me but I’s just being lazy……</li>\n<li>social media ;)</li>\n</ul><h3>client端源代码</h3><p>下面是部分client端的代码：由于监听了一些事件（毕竟我还是调整了前端的😂）, 所以代码有点长， 下面只显示核心部分：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br></pre></td><td><pre><span>// part of index.html's script</span><br><span>var socket = io();</span><br><span>socket.on('connect', function(){</span><br><span></span><br><span>    // ... some codes here ...</span><br><span></span><br><span>\tsocket.on('greeting-from-server', function(msg){</span><br><span>\t\t$('#greeting').empty();</span><br><span>\t\t$('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').addClass('headline').text(msg.greeting).appendTo($('#greeting'));</span><br><span>\t})</span><br><span></span><br><span>    // MAIN IDEA: if message comes, append to right place, and self adjust the view!</span><br><span>\tsocket.on('message', function(msg){</span><br><span></span><br><span>\t\tvar container = $('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').attr('id', 'container');</span><br><span>\t\tvar bubble = $('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').addClass('talk-bubble tri-right left-in border');</span><br><span>\t\tvar textWrapper = $('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').addClass('talktext').appendTo(bubble);</span><br><span>\t\t$('<span>&lt;<span>p</span>&gt;</span><span>&lt;/<span>p</span>&gt;</span>').html(msg.messageText).appendTo(textWrapper);</span><br><span></span><br><span>\t\t// append the jquery clone to target destination.</span><br><span>\t\tvar nameClone = username2jqy(msg.username);</span><br><span>\t\tvar avaClone = avatar2jqy(msg.avatar);</span><br><span></span><br><span>\t\tavaClone.appendTo(container);</span><br><span>\t\tnameClone.appendTo(container);</span><br><span>\t\tbubble.clone().appendTo(container);</span><br><span>\t\tcontainer.clone().appendTo($('#messages'));</span><br><span></span><br><span>\t\t$('<span>&lt;<span>br</span>&gt;</span>').appendTo($('#messages'));</span><br><span></span><br><span>\t\t// self-adjust scrolling height.</span><br><span>\t\tvar msgWrapper = document.getElementById('messages');</span><br><span>\t\tmsgWrapper.scrollTop = msgWrapper.scrollHeight;</span><br><span>\t});</span><br><span></span><br><span>    // MAIN IDEA: when user list need to update, do it!</span><br><span>\tsocket.on('userlist', function(userlist){</span><br><span>\t\t$('#userlist').empty();</span><br><span>\t\t$('<span>&lt;<span>h2</span>&gt;</span><span>&lt;/<span>h2</span>&gt;</span>').text('Online users:').appendTo($('#userlist'));</span><br><span>\t\tObject.keys(userlist).map(function(d){</span><br><span>\t\t\tvar usrImg = $('<span>&lt;<span>img</span>&gt;</span><span>&lt;/<span>img</span>&gt;</span>').attr('src', userlist[d].avatar);</span><br><span>\t\t\tvar usrName = $('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').text(userlist[d].username).addClass('listname');</span><br><span>\t\t\tvar profileWrapper = $('<span>&lt;<span>div</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>').addClass('userlistProfile');</span><br><span>\t\t\tusrImg.appendTo(profileWrapper);</span><br><span>\t\t\tusrName.appendTo(profileWrapper);</span><br><span>\t\t\tprofileWrapper.appendTo($('#userlist'));</span><br><span>\t\t})</span><br><span>\t});</span><br><span></span><br><span>});</span><br></pre></td></tr></table></figure><h2>背景知识补充</h2><p>完成一个小demo的开发同样会需要很多边角料信息的补充， 没有人会记得所有javascript各种处理对象的函数， 也没有人需要记得。留个note给自己， 也再以后查纠的之后方便回忆。</p>\n<ul><li><a href=\"http://ios.jobbole.com/85230/\" target=\"_blank\" rel=\"external\">微信,QQ这类IM app怎么做——谈谈Websocket</a></li>\n<li><a href=\"http://betterexplained.com/articles/a-simple-introduction-to-computer-networking/\" target=\"_blank\" rel=\"external\">A Simple Introduction To Computer Networking</a></li>\n<li><code>array.splice(i, 1);</code> will remove one item from ith index in that array, namely, in this case, remove the ith item from array.</li>\n<li><code>docuemnt.createTextNode(string) \\ document.createElement('div'); \\  document.getElementById('SOMEID').appendChild(element);</code> are some common DOM objects munipulations example.</li>\n<li>refer to this post: <a href=\"http://stackoverflow.com/questions/8894226/javascript-submit-textbox-on-enter\" target=\"_blank\" rel=\"external\">send message by pressing enter</a>, by adding an eventlistener function to message-box, we listent on the keyCode we press, if it is 13(Enter key), then we trigger the message send function.</li>\n<li>refer to this post: <a href=\"http://codepen.io/Founts/pen/gmhcl\" target=\"_blank\" rel=\"external\">styling for chat bubble</a></li>\n<li>Know how to create DOM elements in jquery: <code>$('&lt;div&gt;&lt;/div&gt;').addClass('headline').html(msg).appendTo($('#greeting'));</code></li>\n<li>create modal in a visually good-looking way, refer to this post: <a href=\"https://github.com/kylefox/jquery-modal\" target=\"_blank\" rel=\"external\">jquery.modal.js</a></li>\n<li>add user a good-looking avatar! <a href=\"https://github.com/adorableio/avatars-api\" target=\"_blank\" rel=\"external\">adorable avatar!</a></li>\n<li>change html input focus, refer to this post: <a href=\"https://api.jquery.com/focus/\" target=\"_blank\" rel=\"external\">html input focus</a></li>\n<li>auto-adjust the scrolling top to the latest message, refer to this post: <a href=\"http://stackoverflow.com/questions/15432691/css-overflow-value-for-chat\" target=\"_blank\" rel=\"external\">srollTop = scrollHeight</a></li>\n</ul>"
		},
		{
			"title": "前端开发工具库[第一期]-npm script",
			"link": "http://chocoluffy.com/2016/05/15/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E5%BA%93-%E7%AC%AC%E4%B8%80%E6%9C%9F-npm-script/",
			"guid": "http://chocoluffy.com/2016/05/15/前端开发工具库-第一期-npm-script/",
			"pubDate": "2016-05-15T21:48:45.000Z",
			"categories": [
				"javascript",
				"nodejs",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>在自动构建工具grunt\\webpack等红噪一时的背景下，为什么我想用npm script而不是grunt和gulp等其他工具?</p>",
			"content": "<p>在自动构建工具grunt\\webpack等红噪一时的背景下，为什么我想用npm script而不是grunt和gulp等其他工具?</p>\n<a></a>\n<h2>前言</h2><p>为什么我们需要自动构建工具？</p>\n<p>在前端开发的时候，会遇到很多实际产品开发之外上的需求，比如开发者希望做到“所写即所得”，可以一边在编辑器里面修改和开发代码，浏览器可以同步更新而不需要我们手动去refresh页面； 比如我们希望可以压缩最后的成品代码， 图片资源的大小，让每次浏览器下载所需要的js代码的时间可以更短，或者考虑CDN； 比如我们希望我们写的scss可以适配任何类型的浏览器等等。</p>\n<p>很多功能曾经是要开发者手动引入script文件的，但鉴于npm上活跃的开发者将很多需求的module开发并发布出来， 我们可以利用npm这个包管理器来配置使用这些方便的module，在能够达到同样功能的工具里面比如bower, grunt, gulp，我认为对于一个轻量的小项目， 个人项目来说, npm script是最方便的， 最容易上手的。<strong>没有最好的工具， 只有最合适的使用场景。</strong></p>\n<p>而今天的主题：在配置工具grunt\\webpack等红噪一时的背景下，为什么我想用npm script而不是grunt和gulp等其他工具?</p>\n<p><strong>因为simplicity matters。</strong>没有必要在需要用的时候才去找那些数量有限的grunt, gulp plugins，而直接将node modules拿来用。对于个人开发和维护的小项目， 有没有必要花时间去研究Gruntfile.js怎么去配置， 或者说， 在配置上花的时间相对短期集中开发的时间来说值不值？不是说反对使用grunt, gulp和webpack等工具， 而是我们没有必要拿大炮去打蚊子， 我们想要agile development。 也正是simplicy， 所以才有RoR, meteor等全栈框架的出现来挑战java等较为臃肿的开发流程不是么？</p>\n<p>下图是截止至今年1月为止的各平台的插件数量，仍在不断地增加中。</p>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/f247d4b81bd3044a.png\" alt=\"npm script\"></p>\n<h2>什么是npm script</h2><p>其实npm script就是希望执行的command的alias， 类似与command line里面的make， 通过提前设置希望执行的命令， 我们可以通过<code>npm run &lt;alias&gt;</code>来执行我们预先设置的命令。</p>\n<h2>如何config你的npm script</h2><p>而目前npm上有很多很棒的module可以直接处理项目， 下面列出来的是我平时自己经常使用的module: </p>\n<p>比如: browserfy将文件的各种文件和浏览器同步; postcss和autofixer可以将css文件添加适配各种浏览器的前缀同时进行压缩; js-lint用来检查js文件的各种格式细节; uglify用来压缩js文件的大小; imagemin用来压缩各种图片文件的大小， 在各种大型网站中， 图片的大小占据了大部分。</p>\n<h3>node－sass</h3><p>下面是一些具体使用的例子：比如我们想将sass compile成css。</p>\n<figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span>npm install --save-dev node-sass</span><br></pre></td></tr></table></figure><p>将<code>node-sass</code>这个module装在developing环境之后，可以直接<code>node-sass --output-style compressed -o dist/css src/scss</code>来将”src/scss“这个文件夹下面的sass文件compile出来并保存在”dist/css“文件夹下面； 或者一个更便捷的做法，是使用npm script：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span><span>\"scripts\"</span>: {</span><br><span>  <span>\"scss\"</span>: <span>\"node-sass --output-style compressed -o dist/css src/scss\"</span></span><br><span>}</span><br></pre></td></tr></table></figure><p>然后在console里run <code>npm run scss</code>就可以执行这个相同命令了。和makefile的原理和使用习惯可以类比， 只不过使用场景和平台不同。</p>\n<h3>autoprefixer</h3><p>同理对上文提到的autoprefixer这个module， <code>npm install --save-dev postcss-cli autoprefixer</code>来安装， 然后配置script：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span><span>\"scripts\"</span>: {</span><br><span>  ...</span><br><span>  <span>\"autoprefixer\"</span>: <span>\"postcss -u autoprefixer -r dist/css/*\"</span></span><br><span>}</span><br></pre></td></tr></table></figure><p>那么<code>npm run autoprefixer</code>这个效果就相当于<code>postcss -u autoprefixer --autoprefixer.browsers '&gt; 5%, ie 9' -r dist/css/*</code>。</p>\n<h3>eslint</h3><p>类似地还有eslint这个对js文件进行syntax testing的常用module：<code>npm install --save-dev eslint</code>或者使用shortcut：<code>npm i -D eslint</code>, 然后配置package.json的script部分：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span><span>\"scripts\"</span>: {</span><br><span>  ...</span><br><span>  <span>\"lint\"</span>: <span>\"eslint src/js\"</span></span><br><span>}</span><br></pre></td></tr></table></figure><h2>项目源代码示例</h2><p>一个实战项目的源代码使用在这里和大家分享：</p>\n<p>考虑到开发和生产环境的不同，还需要配置不同的环境，这个项目在开发上有浏览器同步更新，语法检查，压缩源文件， 监听端口， s3同步备份的自动化优势， 还引入了前端的jade框架代替html， stylus框架代替css，mocha的testing框架和karma驱动。</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br></pre></td><td><pre><span>{</span><br><span>  <span>\"name\"</span>: <span>\"npm-scripts-example\"</span>,</span><br><span>  <span>\"version\"</span>: <span>\"1.0.0\"</span>,</span><br><span>  <span>\"description\"</span>: <span>\"An example of how to use npm scripts\"</span>,</span><br><span>  <span>\"main\"</span>: <span>\"index.js\"</span>,</span><br><span>  <span>\"license\"</span>: <span>\"MIT\"</span>,</span><br><span>  <span>\"devDependencies\"</span>: {</span><br><span>    <span>\"browserify\"</span>: <span>\"^6.3.2\"</span>,</span><br><span>    <span>\"hashmark\"</span>: <span>\"^2.0.0\"</span>,</span><br><span>    <span>\"http-server\"</span>: <span>\"^0.7.3\"</span>,</span><br><span>    <span>\"jade\"</span>: <span>\"^1.7.0\"</span>,</span><br><span>    <span>\"jshint\"</span>: <span>\"^2.5.10\"</span>,</span><br><span>    <span>\"karma\"</span>: <span>\"^0.12.28\"</span>,</span><br><span>    <span>\"karma-browserify\"</span>: <span>\"^1.0.0\"</span>,</span><br><span>    <span>\"karma-cli\"</span>: <span>\"^0.0.4\"</span>,</span><br><span>    <span>\"karma-mocha\"</span>: <span>\"^0.1.10\"</span>,</span><br><span>    <span>\"karma-phantomjs-launcher\"</span>: <span>\"^0.1.4\"</span>,</span><br><span>    <span>\"live-reload\"</span>: <span>\"^0.2.0\"</span>,</span><br><span>    <span>\"minifyify\"</span>: <span>\"^6.0.0\"</span>,</span><br><span>    <span>\"mocha\"</span>: <span>\"^2.0.1\"</span>,</span><br><span>    <span>\"nodemon\"</span>: <span>\"^1.2.1\"</span>,</span><br><span>    <span>\"opener\"</span>: <span>\"^1.4.0\"</span>,</span><br><span>    <span>\"parallelshell\"</span>: <span>\"^1.0.0\"</span>,</span><br><span>    <span>\"rimraf\"</span>: <span>\"^2.2.8\"</span>,</span><br><span>    <span>\"s3-cli\"</span>: <span>\"^0.11.1\"</span>,</span><br><span>    <span>\"stylus\"</span>: <span>\"^0.49.3\"</span></span><br><span>  },</span><br><span>  <span>\"scripts\"</span>: {</span><br><span>    <span>\"clean\"</span>: <span>\"rimraf dist/*\"</span>,</span><br><span></span><br><span>    <span>\"prebuild\"</span>: <span>\"npm run clean -s\"</span>,</span><br><span>    <span>\"build\"</span>: <span>\"npm run build:scripts -s &amp;&amp; npm run build:styles -s &amp;&amp; npm run build:markup -s\"</span>,</span><br><span>    <span>\"build:scripts\"</span>: <span>\"browserify -d assets/scripts/main.js -p [minifyify --compressPath . --map main.js.map --output dist/main.js.map] | hashmark -n dist/main.js -s -l 8 -m assets.json 'dist/{name}{hash}{ext}'\"</span>,</span><br><span>    <span>\"build:styles\"</span>: <span>\"stylus assets/styles/main.styl -m -o dist/ &amp;&amp; hashmark -s -l 8 -m assets.json dist/main.css 'dist/{name}{hash}{ext}'\"</span>,</span><br><span>    <span>\"build:markup\"</span>: <span>\"jade assets/markup/index.jade --obj assets.json -o dist\"</span>,</span><br><span></span><br><span>    <span>\"test\"</span>: <span>\"karma start --singleRun\"</span>,</span><br><span></span><br><span>    <span>\"watch\"</span>: <span>\"parallelshell \\\"npm run watch:test -s\\\" \\\"npm run watch:build -s\\\"\"</span>,</span><br><span>    <span>\"watch:test\"</span>: <span>\"karma start\"</span>,</span><br><span>    <span>\"watch:build\"</span>: <span>\"nodemon -q -w assets/ --ext '.' --exec 'npm run build'\"</span>,</span><br><span></span><br><span>    <span>\"open:prod\"</span>: <span>\"opener http://example.com\"</span>,</span><br><span>    <span>\"open:stage\"</span>: <span>\"opener http://staging.example.internal\"</span>,</span><br><span>    <span>\"open:dev\"</span>: <span>\"opener http://localhost:9090\"</span>,</span><br><span></span><br><span>    <span>\"deploy:prod\"</span>: <span>\"s3-cli sync ./dist/ s3://example-com/prod-site/\"</span>,</span><br><span>    <span>\"deploy:stage\"</span>: <span>\"s3-cli sync ./dist/ s3://example-com/stage-site/\"</span>,</span><br><span></span><br><span>    <span>\"serve\"</span>: <span>\"http-server -p 9090 dist/\"</span>,</span><br><span>    <span>\"live-reload\"</span>: <span>\"live-reload --port 9091 dist/\"</span>,</span><br><span></span><br><span>    <span>\"dev\"</span>: <span>\"npm run open:dev -s &amp;&amp; parallelshell \\\"npm run live-reload -s\\\" \\\"npm run serve -s\\\" \\\"npm run watch -s\\\"\"</span></span><br><span>  }</span><br><span>}</span><br></pre></td></tr></table></figure><p>很多时候就是因为准备的工具效率高， 开发者也因此得以集中精力于产品逻辑， 在更短的时间内开发出更好更稳定的产品。</p>\n<h2>后记小结</h2><p>npm script不是没有缺点的，就像我一再强调的，没有最好的工具， 只有最合适的使用场景， 在个人小项目适合的npm script，在大项目， 动辄几十万的前端项目的构建和测试下， npm script会显得特别臃肿和难以维护。 而目前大热的grunt\\gulp\\webpack也迎来了他们的舞台。下一期，集中介绍grunt和webpack，公司里使用的也是grunt，为什么它会在众多工具中脱颖而出。</p>\n<h2>参考链接</h2><ul><li><a href=\"https://www.zybuluo.com/yangfch3/note/249328\" target=\"_blank\" rel=\"external\">用npm搭配脚本执行</a> npm 不仅可以用于模块管理，还可以用于执行脚本。对于多个任务的操作很方便！</li>\n<li><a href=\"https://www.nczonline.net/blog/2016/03/mimicking-npm-script-in-node-js/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+nczonline+%28NCZOnline+-+The+Official+Web+Site+of+Nicholas+C.+Zakas%29\" target=\"_blank\" rel=\"external\">Mimicking npm script in Node.js</a> The underlying mechanism of using npm script is that npm modifies the PATH environment variable so that it affects the lookup of executables. Run <code>npm install --save-dev eslint</code>, then do <code>npm run lint</code>, it works because npm script is actually running <code>node_modules/.bin/eslint</code>.</li>\n<li><a href=\"http://gon.to/2015/02/26/gulp-is-awesome-but-do-we-really-need-it/\" target=\"_blank\" rel=\"external\">Gulp is awesome, but do we really need it?</a></li>\n<li><a href=\"http://blog.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/\" target=\"_blank\" rel=\"external\">How to Use npm as a Build Tool</a></li>\n</ul>"
		},
		{
			"title": "另一种鼓声-读《途客圈》有感",
			"link": "http://chocoluffy.com/2016/05/13/%E5%8F%A6%E4%B8%80%E7%A7%8D%E9%BC%93%E5%A3%B0-%E8%AF%BB%E3%80%8A%E9%80%94%E5%AE%A2%E5%9C%88%E3%80%8B%E6%9C%89%E6%84%9F/",
			"guid": "http://chocoluffy.com/2016/05/13/另一种鼓声-读《途客圈》有感/",
			"pubDate": "2016-05-14T01:45:08.000Z",
			"categories": [
				"创业",
				"商业评论",
				"读书笔记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>“如果你清醒地知道你要去哪儿，脑海中还保留着那份憧憬，那么你就能逢山开路，遇水搭桥，所有的阻碍都将成为一个个里程碑，被踩在你的身后……”</p>",
			"content": "<p>“如果你清醒地知道你要去哪儿，脑海中还保留着那份憧憬，那么你就能逢山开路，遇水搭桥，所有的阻碍都将成为一个个里程碑，被踩在你的身后……”</p>\n<a></a>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/7c3aa7a1e64bda62.png\" alt=\"生命不能承受之重\"></p>\n<h2>前言</h2><p>在<a href=\"http://chocoluffy.com/2016/04/25/%E5%85%B3%E4%BA%8E%E5%88%9B%E4%B8%9A%EF%BC%8C-%E9%82%A3%E4%BA%9B%E4%B8%8D%E8%83%BD%E8%AF%B4%E7%9A%84%E7%A7%98%E5%AF%86/\">关于创业, 那些不能说的秘密</a>里主要记录了阅读<the hard=\"\" thing=\"\" about=\"\" things=\"\">的阅读手记， 而另一本几乎同时完成的书&lt;途客圈创业记&gt;的阅读记录思考，在这里分享。</the></p>\n<p>在一个充斥着来自CEO乃至风险投资人视角的创业回顾的环境下， 一个来自技术合伙人(CTO)的视角显得尤为可贵。 从最早的技术选型， 到带领其它技术人员的开发和维护， 到技术过渡和商业选择， 陈天给了一份很详细和真挚的参考选项。</p>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/6ceefbf6929babac.png\"></p>\n<p>每本书， 每个文字对不同的人意义都是不同的。 下面纪录了我在看完这本书之后的想法。</p>\n<h2>关于创业，那所有无关技术的事</h2><p>一开始不要设置过高的期权池， 期权池的主要目的是未来吸引和留住人才。期权与股权不同，股权代表所有权，期权代表的则是在特定的时间、以特定的价格购买特定所有权的权利，它可被视作是员工与公司之间关于股权买卖的一份合同。行权之后员工获得的股份是普通股。</p>\n<h3>在创新工场里的打拼</h3><p>在和创新工场就入驻细节的交谈中：</p>\n<ul><li><p>清算优先权</p>\n</li>\n<li><p>反稀释条款</p>\n</li>\n</ul><p>如何雇佣到最好的人， 的确拥有创新工场这个名字更容易发现更好的技术人员。</p>\n<p>nanfang就是通过创新工厂的招聘进来的。同时alex的官方博客和知乎都可以用来获取人才的来源。</p>\n<h3>技术选型和工具库</h3><p>当时作者使用的是amazon的四台最小免费计算单元， 用4个账号注册的。一台用来跑翻译， 一台跑wordpress， 一台跑toureet.com， 和另一台。 现在国内的云服务可以考虑阿里云。</p>\n<p>在UI上要直观和实用。 一定要在第一轮宣传之前完成UI的设计和构架， 毕竟第一轮宣传之后， 往后的宣传的力度和效果都将大大不如之前。</p>\n<p>同时也需要考虑的就是域名和注册的问题!!</p>\n<p>要把钱花在刀刃上， 要舍得去花钱。app的制作是必须的!!!!!!!!尽管大家使用web的时间很多， 但是下载了一个app就是护城河。</p>\n<p><strong>对于一些特别优秀的人， 一定要和他们经常讨论产品的发展方向， 因为对于他们来说， 他们之所以加入你， 已经不是因为技术的吸引力了， 而是因为他的声音很可能在塑造他准备推出的产品， 因为从未有的对产品的掌控力。而这， 也是创业的魅力吧!</strong></p>\n<h3>市场推广</h3><p>历时一个月的推广大赛， 烧了30万（加上员工的工资）， 换来的是一次性的用户， 看热闹的用户， 注册了3万多人， 然而没有什么用。</p>\n<p>如果你战略上不是很清晰，你再做什么也是没有用的，<strong>是在用战术性的疲劳掩盖战略上的懒惰</strong>。百场汇不停地在战略层面做一些调整，所以战术上大家不会那么辛苦。一年来，百场汇全公司只有一个人离职。这对初创公司来说是很不容易的。</p>\n<h2>关于功能的实用和噱头</h2><p>有没有想过如果微信把朋友圈的功能作为每一次打开的初始页面？而不是一直以来的群组或者单聊？首屏一定要放你最最核心的功能， 而社交是最为用户粘性的方式之一， 绝对不能喧宾夺主。或者说， 所有的工具式网站， 都应该考虑围绕那个工具所最最合适的社交场景。</p>\n<p>比如微信的工具属性是：即时通讯和群聊， 那么聊天的社交场景就应该是： 让更多的人发现聊天的内容， 也从纯文字转换到图片和视频和直播， 乃至可以让更多的人加入和感受到聊天的这个场景里面。</p>\n<p>比如网易云音乐的工具属性是： 发现和享受高品质音乐， 那么找音乐和听音乐的社交场景就应该是： 让更多的人去发现你喜欢和收藏的音乐， 并基于这些音乐进行进一步的交流。而我觉得一个非常非常棒的功能就是， 不仅仅允许用户分享他们自己创作的歌单， 而且允许把他们最常听的那25首歌显示出来。你不会欺骗你自己的耳朵。如果可以把这一栏更突出地显示会更好？！</p>\n<h2>关于工具和社区的交叠和矛盾</h2><p>每一个需求在被解决的时候， 产品是被工具化的， 而希望推广这种解决方案的时候， 产品是被社区化的。 现在大部分围绕工具性产品还是社区性产品的讨论， 如果被抽象出了产品本身要解决的问题的话， 基本都是废话和干扰。 拿两种使用场景和频率比较不同的方向做比较， 比如听音乐和旅游这两个商业方向。 </p>\n<p>人们听音乐的两个需求， 在自己疲惫不爽的时候听到自己最喜欢的音乐， 和发现那些不认识却好听的音乐； 当然， 人们还会从分享自己组好的歌单或者评论里面得到分享和反馈的满足，但我认为这种行为是因为社区化带来的，因为在人群中， 所以也想得到人群的温暖和共鸣 ，但这种社会心理的需求我暂不归于听音乐本身的需求。 就拿网易云音乐APP作例子， 其本身在很多细节上做得很棒了， 但是我认为还可以提高的地方：</p>\n<p>基于喜欢同一个专辑的乐众的社交兴趣小组。人们对自己喜欢的东西永远都有如数家珍般的热情。</p>\n<p>从你不会骗自己的耳朵， 你最最经常听的25首歌。</p>\n<p>同样发现别人最最经常听的25首歌。</p>\n<p>用户对收集到歌曲的分类的自我重组。 应当支持双向的标记， 一是tag， 二是collection。像管理笔记一样去管理音乐， 同时将任何collection都注重社交化的分享， 像pinterest的理念学习。</p>\n<p>评论分为两栏， 一栏是trending， 一栏是历史最热。 trending要像hackernews一样的不断让新事物涌现来代替旧评论， 而历史最热， 则是就硬碰硬的质量。原因？你不会去参加一个高低胜负已经分明的比赛。你之所倚评论， 你总会有被反馈的渴望， 而看见自己的文字被淹没是最最失落的， 哪怕你知道这的确不是最好的文字~</p>\n<h2>关于期权池</h2><p>以下内容， 来源自知乎。可参考：<a href=\"http://zhuanlan.zhihu.com/p/20726127\" target=\"_blank\" rel=\"external\">知乎专栏</a>, 作者：黄海, 著作权归作者所有。</p>\n<p>可能有创业者会问了：我给了员工股份，他3个月以后就跳槽了，我不就亏了。当然不会，首先记住这是股权池，不是股份池。给的是股权，不是直接送股份。所谓股权，就是一定时候，可以以行使价格买入股票，这个行使价格由董事会决定，一般特别低。</p>\n<h3>有股权的员工和创始人的区别</h3><p>你最早的员工可能和你一起度过了创业的全过程，而且还通过股权池获得股权，那你可能会问，那他们算创始人么？</p>\n<p>答案是，他们与创始人还是有很大不同的。首先，如果他们不行使权利，他们甚至都不算是股东，话语权当然不一样。另外创始人开始都是、没有工资，甚至自己就是投资人，承担了所有的风险。员工就很不一样，依然是雇佣关系，除了失业风险较大，同时劳资可能相对低，但这些都是个人风险，而不是企业风险。所以还是有很大区别的。</p>\n<p>越迟加入公司的员工需要冒的风险越低。</p>\n<p>创始人应该最终拿整个公司大约50%的股份。首层下面的5层员工的每一层最终都分别分到大约10%的公司股份，每一层的员工都将平分这10%的股份。</p>\n<p>现在，你搞定了一个公平的份股系统，但还有一个重要的原则：你必须执行“股份绑定”(vesting)。股份绑定期最好是 4 到 5 年。任何人都必须在公司做够起码 1 年才可持有股份（包括创始人）。好的股份绑定计划一般是头一年给 25%，然后接下来每个月落实 2%。否则，你的合作创始人将加入公司 3 个星期后跑掉，然后 7 年后又出现，并声称他拥有公司的 25% 的股份。</p>\n<p>没有“股份绑定”条款，你派股份给任何人都是不靠谱的！</p>\n<p>没有执行“股份绑定”是极其普遍的现象，后果可以十分严重。你看到有些公司的 3 个创始人没日没夜地工作了 5 年，然后你发现有些混蛋加入后 2 个星期就离开，这混蛋还以为他仍然拥有公司 25% 的股份，就因为他工作过的那 2 个星期。</p>\n<p>好了，让我们清理一下整个设计蓝图中没搞定的小问题。</p>\n<p>如果你的公司融资了，股份如何分割？</p>\n<p>投资可以来自任何方向，一个天使投资人，一个风险投资公司，或者是某人的老爸。基本上，回答很简单：</p>\n<p>新的投资将“稀释”所有人的股份。</p>\n<p>千万不要用分配股权来解决这些问题。</p>\n<p>其实，你只需要针对每位创始人拿的工资做好记帐：不拿工资创始人就给 她记着工资“欠条”。当公司有了足够现金，就根据这个工资欠条补发工资给她。接下来的几年中，当公司现金收入逐步增加，或者当完成第一轮风险投资后，你可 以给每一位创始人补发工资，以确保每一位创始人都可从公司得到完全一样的工资收入。</p>\n<h3>创业构想提出者应该多拿股份吗？</h3><p>不拿。构想基本上是不值钱的。仅仅因为提出创业构想就获得更多股 权，因此导致纷争是不值得的。如果你们当中有人首先提出的创业构想，但你们都同时辞工并同时开始创业，你们应该拿同等的股份。为公司工作才是创造价值的原 因，而你洗澡的时候突发奇想的“创业点子”根本不值什么钱。</p>\n<h3>创始人不全职投入工作？</h3><p>那么，他（们）就不能算是“创始人”。在我的概念中，如果 一个人不全职投入公司的工作就不能算是创始人。任何边干着他们其它的全职工作边帮公司干活的人只能拿工资或者工资“欠条”，但是不要给股份。如果这个“创 始人”一直干着某份全职工作直到公司拿到风投，然后辞工全职过来公司干活，他（们）和第一批员工相比好不了多少，毕竟他们并没有冒其他创始人一样的风险。</p>\n<h3>如果有人给公司提供有价值的东西？</h3><p>比如提供了设备， 专利或者是域名。</p>\n<p>很好啊。按这些东西的价值支付现金或开个“欠条”咯，别给股份。你准确算一下他给公司带来的那台电脑的价值，或者他们自带的某个聪明的字处理专利的价格，给他们写下欠条，公司有钱后再偿还即可。在创业初期就用股权来购买某些公司需要的东西将导致不平等，纷争和不公平。</p>\n<p><strong>再重复一遍!! 用欠条， 而不是股份解决问题!!!!解决大部分的资金纷争和各种帮助!!</strong></p>\n<p>今天买来的用户，明天还是不会成为你的品牌用户。</p>"
		},
		{
			"title": "Angular入门-module和service",
			"link": "http://chocoluffy.com/2016/05/12/Angular%E5%85%A5%E9%97%A8-module%E5%92%8Cservice/",
			"guid": "http://chocoluffy.com/2016/05/12/Angular入门-module和service/",
			"pubDate": "2016-05-13T02:43:51.000Z",
			"categories": [
				"angularjs",
				"javascript",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>自己学习angular时候记录的学习笔记，这一篇主要讨论module和service。</p>",
			"content": "<p>自己学习angular时候记录的学习笔记，这一篇主要讨论module和service。</p>\n<a></a>\n<h2>How to define a module?</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>// define a module</span></span><br><span>angular.module(<span>'notesApp'</span>,</span><br><span>    [<span>'notesApp.ui'</span>, <span>'thirdCompany.fusioncharts'</span>]);</span><br><span></span><br><span><span>// look up a module.</span></span><br><span>angular.module(<span>'notesApp'</span>);</span><br></pre></td></tr></table></figure><p>Also, make sure the file that defines the module is loaded first.</p>\n<p>After defining the module, we use Angular to use these modules to bootstrap the application. <code>ng-app</code> takes an optional argument, the name of the modulr to load.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></pre></td><td><pre><span><span>&lt;<span>html</span> <span>ng-app</span>=<span>\"notesApp\"</span>&gt;</span></span><br><span>   <span>&lt;<span>head</span>&gt;</span></span><br><span>     <span>&lt;<span>title</span>&gt;</span>Hello AngularJS<span>&lt;/<span>title</span>&gt;</span></span><br><span>    <span>&lt;/<span>head</span>&gt;</span></span><br><span><span>&lt;<span>body</span>&gt;</span></span><br><span>      Hello { { 1 + 1 } }nd time AngularJS</span><br><span><span>&lt;<span>script</span> <span>src</span>=<span>\"https://ajax.googleapis.com/ajax/libs/angularjs/1.2.19/angular.js\"</span>&gt;</span><span></span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;<span>script</span> <span>type</span>=<span>\"text/javascript\"</span>&gt;</span><span></span><br><span>angular.module(<span>'notesApp'</span>, []); </span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;/<span>body</span>&gt;</span></span><br><span><span>&lt;/<span>html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2>Controller in Angular</h2><ul><li>fetching data from server to UI.</li>\n<li>presentation logic.</li>\n<li>user interaction, what will happen when user clicks something. </li>\n</ul><p>An AngularJS controller is almost always directly linked to a view or HTML. We will <strong>never have a controller that is not used in the UI</strong> (that kind of business logic goes into services).</p>\n<h3>HTML code</h3><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>&lt;<span>script</span> <span>type</span>=<span>\"text/javascript\"</span>&gt;</span><span></span><br><span>angular.module(<span>'notesApp'</span>, []) .controller(<span>'MainCtrl'</span>, [<span><span>function</span>(<span></span>) </span>{</span><br><span>          <span>// Controller-specific code goes here</span></span><br><span>          <span>console</span>.log(<span>'MainCtrl has been created'</span>);</span><br><span>        }]);</span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The above code define a module that depends on nothing, and a controller and its dependencies in the second argument, an array(the last argument in that array is the actual function itself).</p>\n<p>We also introduce a new directive, ng-controller. This is used to tell AngularJS to go instantiate an instance of the controller with the given name, and attach it to the DOM element. In this case, it would load MainCtrl, which would end up printing the console.log() statement.</p>\n<h3>Angular code</h3><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></pre></td><td><pre><span><span>&lt;<span>html</span> <span>ng-app</span>=<span>\"notesApp\"</span>&gt;</span> </span><br><span><span>&lt;<span>head</span>&gt;</span></span><br><span>  <span>&lt;<span>title</span>&gt;</span>Notes App<span>&lt;/<span>title</span>&gt;</span></span><br><span><span>&lt;/<span>head</span>&gt;</span></span><br><span><span>&lt;<span>body</span> <span>ng-controller</span>=<span>\"MainCtrl as ctrl\"</span>&gt;</span></span><br><span>      { { ctrl.helloMsg } } AngularJS.</span><br><span>      <span>&lt;<span>br</span>/&gt;</span></span><br><span>      { { ctrl.goodbyeMsg } } AngularJS</span><br><span><span>&lt;<span>script</span> <span>src</span>=<span>\"https://ajax.googleapis.com/ajax/libs/angularjs/1.2.19/angular.js\"</span>&gt;</span><span></span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;<span>script</span> <span>type</span>=<span>\"text/javascript\"</span>&gt;</span><span></span><br><span>angular.module(<span>'notesApp'</span>, [])</span><br><span>  .controller(<span>'MainCtrl'</span>, [<span><span>function</span><span>()</span> </span>{</span><br><span>    <span>this</span>.helloMsg = <span>'Hello '</span>;</span><br><span>    <span>var</span> goodbyeMsg = <span>'Goodbye '</span>;</span><br><span>    }</span><br><span>  ]</span><br><span>);</span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;/<span>body</span>&gt;</span></span><br><span><span>&lt;/<span>html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The reason why it only shows the the hello message it that: We <strong>defined the variable helloMsg on the controller’s instance</strong> (using the “this” keyword, and it is how we expose the data from controller to front-end UI), and the variable goodbyeMsg as a local inner variable in the controller’s in‐ stance (using the var keyword).</p>\n<p>By using <code>ng-controller</code>, it allows us to associate an instance of controller with a UI element, in this case, the </p> tag.\n<p>“This” in javascipt, since it will be easily modified by whoever call the function, which causes the case that “this” inside and outside the function(the asychcronous function) may refer to two different objects. Thus, using a proxy variable will help!! Since with the help of the closure, that proxy varibale will always stay the same(pointing to “this”) inside the function.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span><span>&lt;<span>div</span> <span>ng-repeat</span>=<span>\"note in ctrl.notes\"</span>&gt;</span></span><br><span><span>&lt;<span>span</span> <span>class</span>=<span>\"label\"</span>&gt;</span> { { note.label } }<span>&lt;/<span>span</span>&gt;</span></span><br><span><span>&lt;<span>span</span> <span>class</span>=<span>\"status\"</span> <span>ng-bind</span>=<span>\"note.done\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span></span><br><span><span>&lt;/<span>div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The two methods appear above are the same effect, but we recommend the second way, since the second one will be replaced before the the first one. </p>\n<h2>Angular’s working flow</h2><p>After the entire HTML is loaded, angular.js starts to find the <code>ng-app</code> directive, then using that directive, it looks for the angular modules defined and attached to that DOM element. </p>\n<p>Then it starts to find other directive and binding elements inside the range. Every it meets <code>ng-controller</code> or <code>ng-repeat</code>, it creates a scope for that part of element. <strong>scopr is the context of that element</strong>, and it dictates what each DOM has access to in terms of functions, variables and so on.</p>\n<p>Angular also adds <strong>watcher and listeners</strong> on HTML’s DOM element.</p>\n<p>The way angular update the UI, only happens for a certain events including XHR, server calls, page loads and user interaction such clicks and type.</p>\n<h3>what is XHR?</h3><p>XMLHttpRequest (XHR) is an API available to web browser scripting languages such as JavaScript. It is used to send HTTP or HTTPS requests to a web server and load the server response data back into the script.</p>\n<p>Data from the response can be used to alter the current document in the browser window without loading a new web page, and despite the name of the API, this data can be in the form of not only XML, but also JSON, HTML or plain text.</p>\n<p>Ajax depends heavily on XHR.</p>\n<h2>More directive</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span><span>&lt;<span>div</span> <span>ng-repeat</span>=<span>\"note in ctrl.notes\"</span> <span>ng-class</span>=<span>\"ctrl.getNoteClass(note.done)\"</span>&gt;</span></span><br><span>  <span>&lt;<span>span</span> <span>class</span>=<span>\"label\"</span>&gt;</span> { { note.label } }<span>&lt;/<span>span</span>&gt;</span></span><br><span>  <span>&lt;<span>span</span> <span>class</span>=<span>\"assignee\"</span> <span>ng-show</span>=<span>\"note.assignee\"</span> <span>ng-bind</span>=<span>\"note.assignee\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span></span><br><span><span>&lt;/<span>div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span>self.getNoteClass = <span><span>function</span>(<span>status</span>) </span>{ </span><br><span>  <span>return</span> {</span><br><span>    done: status,</span><br><span>    pending: !status</span><br><span>  };</span><br><span>};</span><br></pre></td></tr></table></figure><p><code>ng-show</code> and <code>ng-hide</code> can help display or hide the DOM element. <code>ng-class</code> will add class to DOM element depending on the [1] if it is string [2] it is a json object, assign the key by the value of that key. <code>ng-switch on=\"&lt;some variable value in scopr&gt;\"</code> with <code>ng-switch-when=\"&lt;the conditional value of that variable&gt;\"</code> will create the if-else effect directly in html.</p>\n<h2>Testing in Angularjs</h2><h3>Test Runner Versus Testing Framework</h3><p>We have often noticed that developers can sometimes get confused between the test runner and the testing framework. This could be because the same library often handles both responsibilities.</p>\n<p>When working with JS (and AngularJS), we have two separate tools/ libraries for each purpose. Karma, which is the test runner, is solely responsible for finding all the unit tests in our codebase, opening browsers, running the tests in them, and capturing results. It does not care what language or framework we use for writing the tests; it sim‐ ply runs them.</p>\n<p>Jasmine is the testing framework we will use. Jasmine defines the syntax with which we write our tests, the APIs, and the way we write our assertions. It is possible to not use Jasmine, and instead use something like mocha or some other framework to write tests for AngularJS.</p>\n<h2>Model in angular</h2><p>The <code>ng-bind</code> and “{ {  } }” we see in the above example demonstrates the one-way data-binding in angular, to use two-way data-binding, we opt for <code>ng-model</code>. As expected, such functionality is heavily used in user form.</p>\n<h2>Angular’s service</h2><p>service refers to reuseable api that can be shared across the applications. One obvious difference between controllers and services is <strong>services are independent of views</strong>, while controllers drives UI.  </p>\n<h3>Dependency injection</h3><p><strong>Dependency injection is a concept that started more on the server side.</strong> Dependency injection states that instead of creating an instance of the dependent service when we need it, the class or function should ask for it instead and the “injector” will be responsible for figuring out how to create it.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></pre></td><td><pre><span><span>// Without Dependency Injection</span></span><br><span><span><span>function</span> <span>fetchDashboardData</span>(<span></span>) </span>{</span><br><span>  <span>var</span> $http = <span>new</span> HttpService();</span><br><span>  <span>return</span> $http.get(<span>'my/url'</span>);</span><br><span>}</span><br><span></span><br><span><span>// With Dependency Injection</span></span><br><span><span><span>function</span> <span>fetchDashboardData</span>(<span>$http</span>) </span>{</span><br><span>  <span>return</span> $http.get(<span>'my/url'</span>);</span><br><span>}</span><br></pre></td></tr></table></figure><p>The two probable ways to write service and why the latter is better? In the first example, we use “new” keyword, we have new instance everytime we use service while <strong>service in angular is singletons for the scope of our application, </strong> and two controllers ask for service A will get the vary same instance!</p>\n<p>To use built-in services, we should remember that the built-in services are prefixed with “<code>$</code>“ sign like “<code>$log</code>“, “<code>$http</code>“ and so on.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span>myModule.controller(<span>\"MainCtrl\"</span>, [<span>\"$log\"</span>, <span><span>function</span>(<span>$log</span>) </span>{}]);</span><br><span></span><br><span>myModule.controller(<span>\"MainCtrl\"</span>, <span><span>function</span>(<span>$log</span>) </span>{});</span><br></pre></td></tr></table></figure><p>And here are the two ways we usually inject services, but why we prefer the former one, the one with safe style of dependency injection. </p>\n<p>Because of the “uglify” procedure. During the uglifing process, the variable will be shortened to some random string, while at that time, we won’t be able to tell which service it is using! Also, since the “uglify” won’t change string constant, it will help to identify which service we are using. </p>\n<p>Why we call “injection”? because the way we use those services like <code>myModule.controller(\"MainCtrl\", [\"$log\", \"$window\", function($l, $w) {}]);</code> is similar to injecting those services for the function to use. </p>\n<h3>Some common services</h3><h4>$location</h4><p>The <code>$location</code> service in AngularJS allows us to interact with the URL in the browser bar, and get and manipulate its value. Any changes made to the <code>$location</code> service get reflected in the browser, and any changes in the browser are im‐ mediately captured in the <code>$location</code> service. The <code>$location</code> service has the fol‐ lowing functions, which allow us to work with the URL:</p>\n<ul><li>absUrl. A getter that gives us the absolute URL in the browser (called <code>$location</code>. absUrl()).</li>\n<li>url. A getter and setter that gets or sets the URL. If we give it an argument, it will set the URL; otherwise, it will return the URL as a string.</li>\n<li>path. Again, a getter and setter that sets the path of the URL. Automatically adds the forward slash at the beginning. So <code>$location.path()</code> would give us the current path of the application, and <code>$location.path(\"/new\")</code> would set the path to /new.</li>\n<li>search. Sets or gets the search or query string of the current URL. Calling <code>$location.search()</code> without any arguments returns the search parameter as an ob‐ ject. Calling <code>$location.search(\"test\")</code> removes the search parameter from the URL, and calling <code>$location.search(\"test\", \"abc\");</code> sets the search parameter test to abc.</li>\n</ul><h4>$http</h4><p>We will deal with <code>$http</code> extensively in Chapter 6, but it is the core AngularJS service used to make XHR requests to the server from the application. Using the <code>$http</code> service, we can make GET and POST requests, set the headers and caching, and deal with server responses and failures.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br></pre></td><td><pre><span>angular.module(<span>'notesApp'</span>, [])</span><br><span>  .controller(<span>'MainCtrl'</span>, [<span><span>function</span>(<span></span>) </span>{</span><br><span>    <span>var</span> self = <span>this</span>;</span><br><span>    self.tab = <span>'first'</span>;</span><br><span>    self.open = <span><span>function</span>(<span>tab</span>) </span>{</span><br><span>      self.tab = tab;</span><br><span>    };</span><br><span>    }])</span><br><span>  .controller(<span>'SubCtrl'</span>, [<span>'ItemService'</span>, <span><span>function</span>(<span>ItemService</span>) </span>{</span><br><span>    <span>var</span> self = <span>this</span>; self.list = <span><span>function</span>(<span></span>) </span>{</span><br><span>    <span>return</span> ItemService.list(); </span><br><span>    };</span><br><span>    </span><br><span>    self.add = <span><span>function</span>(<span></span>) </span>{</span><br><span>      ItemService.add({</span><br><span>        id: self.list().length + <span>1</span>,</span><br><span>        label: <span>'Item '</span> + self.list().length</span><br><span>      });</span><br><span>    };</span><br><span>    }])</span><br><span>  </span><br><span>  <span>// we created ItemService using angular's module function: factory. </span></span><br><span>  .factory(<span>'ItemService'</span>, [<span><span>function</span>(<span></span>) </span>{ </span><br><span>    <span>var</span> items = [</span><br><span>      {id: <span>1</span>, label: <span>'Item 0'</span>},</span><br><span>      {id: <span>2</span>, label: <span>'Item 1'</span>}</span><br><span>    ];</span><br><span>    <span>return</span> {</span><br><span>      list: <span><span>function</span>(<span></span>) </span>{</span><br><span>        <span>return</span> items; </span><br><span>      },</span><br><span>      add: <span><span>function</span>(<span>item</span>) </span>{</span><br><span>        items.push(item);</span><br><span>      } </span><br><span>    };</span><br><span>  }]</span><br><span>);</span><br></pre></td></tr></table></figure><p>The point in the above example is that if we add one more item in one of the tabs, we can also see that item in the other tab, because the itemService instance in both tabs are the same. To summerize:</p>\n<p>AngularJS guarantees the following:</p>\n<ul><li>The service will be lazily instantiated. The very first time a controller, service, or directive asks for the service, it will be created.</li>\n<li>The service definition function will be called once, and the instance stored. Every caller of this service will get this same, singleton instance handed to them.</li>\n</ul><h3>Factory, provider and service</h3><p><strong>There are several ways to defining a service: factory, provider and service.</strong></p>\n<p>we use “factory” if we define the service in a more functional way, like in the previous example, we return an object that contains functions; or we can use “service” if we define the service in a classic class\\OO way, which doesn’t return anything. </p>\n<p>An example of using “serive” is followed:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br></pre></td><td><pre><span><span><span>function</span> <span>ItemService</span>(<span></span>) </span>{</span><br><span>  <span>var</span> items = [</span><br><span>        {id: <span>1</span>, label: <span>'Item 0'</span>},</span><br><span>        {id: <span>2</span>, label: <span>'Item 1'</span>}</span><br><span>      ];</span><br><span>  <span>this</span>.list = <span><span>function</span>(<span></span>) </span>{</span><br><span>    <span>return</span> items;</span><br><span>  };</span><br><span></span><br><span>  <span>this</span>.add = <span><span>function</span>(<span>item</span>) </span>{</span><br><span>        items.push(item);</span><br><span>  };</span><br><span>}</span><br><span></span><br><span>angular.module(<span>'notesApp'</span>, [])</span><br><span>  .service(<span>'ItemService'</span>, [ItemService])</span><br><span>  .controller(<span>'MainCtrl'</span>, [<span><span>function</span>(<span></span>) </span>{</span><br><span>    <span>var</span> self = <span>this</span>;</span><br><span>    self.tab = <span>'first'</span>; self.open = <span><span>function</span>(<span>tab</span>) </span>{</span><br><span>          self.tab = tab;</span><br><span>    };</span><br><span>  }])</span><br><span>  .controller(<span>'SubCtrl'</span>, [<span>'ItemService'</span>, <span><span>function</span>(<span>ItemService</span>) </span>{</span><br><span>    <span>var</span> self = <span>this</span>; self.list = <span><span>function</span>(<span></span>) </span>{</span><br><span>      <span>return</span> ItemService.list(); </span><br><span>    };</span><br><span>    self.add = <span><span>function</span>(<span></span>) </span>{</span><br><span>      ItemService.add({</span><br><span>            id: self.list().length + <span>1</span>,</span><br><span>            label: <span>'Item '</span> + self.list().length</span><br><span>      });</span><br><span>    };</span><br><span>  }]</span><br><span>);</span><br></pre></td></tr></table></figure><h3>Communication with server</h3><p><code>$http</code> is a core AngularJS service that allows us to communicate with server endpoints using XHR. Like XHR such tedious task, we usually instantiate a XMLHttpRequest Object and read the response, check the error codes and so on, or using jquery’s <code>$.ajax</code> syntax. </p>\n<p>Also, it follows the Promise interface.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span>angular.module(<span>'resourceApp'</span>, [<span>'ngResource'</span>])</span><br><span>    .factory(<span>'ProjectService'</span>, [<span>'$resource'</span>, <span><span>function</span>(<span>$resource</span>) </span>{</span><br><span>      <span>return</span> $resource(<span>'/api/project/:id'</span>); </span><br><span>    }]);</span><br></pre></td></tr></table></figure><p><strong>use <code>ngResource</code> to handle RESTful API </strong> as it will make it extremely easy to send the “GET”\\”POST” request to the server. In the above example, we produce a service called “ProjectService”, which depends on the built-in module called “<code>$resource</code>“, which wraps the RESTful endpoint to make our life easier as we can then use:</p>\n<ul><li>ProjectService.query() to get a list of projects.</li>\n<li>ProjectService.save({id: 15}, projectObj) to update a project with ID 15.</li>\n<li>ProjectService.get({id: 19}) to get an individual project with ID 19.</li>\n</ul><p>The following is a full-fledged example, showing how to use <code>ngResource</code> in front end to cooperate with the back end.</p>\n<div markdown=\"1\"><br><br><p>Your browser does not support iframes.</p><br><br></div>\n\n<p>The source code is listed as followed:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br></pre></td><td><pre><span><span>// server.js (Express 4.0)</span></span><br><span><span>var</span> express        = <span>require</span>(<span>'express'</span>);</span><br><span><span>var</span> morgan         = <span>require</span>(<span>'morgan'</span>);</span><br><span><span>var</span> bodyParser     = <span>require</span>(<span>'body-parser'</span>);</span><br><span><span>var</span> methodOverride = <span>require</span>(<span>'method-override'</span>);</span><br><span><span>var</span> app            = express();</span><br><span></span><br><span>app.use(express.static(__dirname + <span>'/public'</span>)); <span>// this line is important as we will serve those html file directly in screen as option, in those html front-end example, we will use angular's ngResource to create http request for the backend of this server.js (the endpoint we just created using express's router).</span></span><br><span>app.use(morgan(<span>'dev'</span>)); \t\t\t\t\t<span>// log every request to the console</span></span><br><span>app.use(bodyParser()); \t\t\t\t\t\t<span>// pull information from html in POST</span></span><br><span>app.use(methodOverride()); \t\t\t\t\t<span>// simulate DELETE and PUT</span></span><br><span></span><br><span></span><br><span><span>var</span> router = express.Router();</span><br><span></span><br><span><span>var</span> notes = [</span><br><span>  {id: <span>1</span>, label: <span>'First Note'</span>, author: <span>'Shyam'</span>},</span><br><span>  {id: <span>2</span>, label: <span>'Second Note'</span>, author: <span>'Brad'</span>},</span><br><span>  {id: <span>3</span>, label: <span>'Middle Note'</span>, author: <span>'Someone'</span>},</span><br><span>  {id: <span>4</span>, label: <span>'Last Note'</span>, author: <span>'Shyam'</span>},</span><br><span>  {id: <span>5</span>, label: <span>'Really the last Note'</span>, author: <span>'Shyam'</span>}</span><br><span></span><br><span>];</span><br><span><span>var</span> lastId = <span>6</span>;</span><br><span></span><br><span>router.get(<span>'/note'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  res.send(notes);</span><br><span>});</span><br><span>router.post(<span>'/note'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  <span>var</span> note = req.body;</span><br><span>  note.id = lastId; <span>// An smart way to keep track of the last id.</span></span><br><span>  lastId++;</span><br><span>  notes.push(note);</span><br><span>  res.send(note);</span><br><span>});</span><br><span></span><br><span></span><br><span>router.post(<span>'/note/:id/done'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  <span>var</span> noteId = req.params.id;</span><br><span>  <span>var</span> note = <span>null</span>;</span><br><span>  <span>for</span> (<span>var</span> i = <span>0</span>; i &lt; notes.length; i++) {</span><br><span>    <span>if</span> (notes[i].id == req.params.id) {</span><br><span>      note = notes[i];</span><br><span>      <span>break</span>;</span><br><span>    }</span><br><span>  }</span><br><span>  note.label = <span>'Done - '</span> + note.label;</span><br><span>  res.send(notes);</span><br><span>});</span><br><span></span><br><span>router.get(<span>'/note/:id'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  <span>for</span> (<span>var</span> i = <span>0</span>; i &lt; notes.length; i++) {</span><br><span>    <span>if</span> (notes[i].id == req.params.id) {</span><br><span>      res.send(notes[i]);</span><br><span>      <span>break</span>;</span><br><span>    }</span><br><span>  }</span><br><span>  res.send({msg: <span>'Note not found'</span>}, <span>404</span>);</span><br><span>});</span><br><span></span><br><span>router.post(<span>'/note/:id'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  <span>for</span> (<span>var</span> i = <span>0</span>; i &lt; notes.length; i++) {</span><br><span>    <span>if</span> (notes[i].id == req.params.id) {</span><br><span>      notes[i] = req.body;</span><br><span>      notes[i].id = req.params.id;</span><br><span>      res.send(notes[i]);</span><br><span>      <span>break</span>;</span><br><span>    }</span><br><span>  }</span><br><span>  res.send({msg: <span>'Note not found'</span>}, <span>404</span>);</span><br><span>});</span><br><span></span><br><span>router.post(<span>'/login'</span>, <span><span>function</span>(<span>req, res</span>) </span>{</span><br><span>  <span>console</span>.log(<span>'API LOGIN FOR '</span>, req.body);</span><br><span>  res.send({msg: <span>'Login successful for '</span> + req.body.username});</span><br><span>});</span><br><span></span><br><span></span><br><span>app.use(<span>'/api'</span>, router);</span><br><span></span><br><span></span><br><span></span><br><span>app.listen(<span>8000</span>);</span><br><span><span>console</span>.log(<span>'Open http://localhost:8000 to access the files now'</span>); <span>// shoutout to the user</span></span><br></pre></td></tr></table></figure><p>And the front-end part code is:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br></pre></td><td><pre><span><span>&lt;!-- File: chapter6/public/http-post-example.html --&gt;</span></span><br><span><span>&lt;<span>html</span> <span>ng-app</span>=<span>\"notesApp\"</span>&gt;</span></span><br><span></span><br><span><span>&lt;<span>head</span>&gt;</span></span><br><span>  <span>&lt;<span>title</span>&gt;</span>HTTP Post Example<span>&lt;/<span>title</span>&gt;</span></span><br><span>  <span>&lt;<span>style</span>&gt;</span><span></span><br><span>    <span>.item</span> <span>{</span><br><span>      <span><span>padding</span>:<span> <span>10px</span></span></span>;</span><br><span>    }</span></span><br><span>  </span><span>&lt;/<span>style</span>&gt;</span></span><br><span><span>&lt;/<span>head</span>&gt;</span></span><br><span></span><br><span><span>&lt;<span>body</span> <span>ng-controller</span>=<span>\"MainCtrl as mainCtrl\"</span>&gt;</span></span><br><span>  <span>&lt;<span>h1</span>&gt;</span>Hello Servers!<span>&lt;/<span>h1</span>&gt;</span></span><br><span>  <span>&lt;<span>div</span> <span>ng-repeat</span>=<span>\"todo in mainCtrl.items\"</span></span><br><span>       <span>class</span>=<span>\"item\"</span>&gt;</span></span><br><span>    <span>&lt;<span>div</span>&gt;</span><span>&lt;<span>span</span> <span>ng-bind</span>=<span>\"todo.label\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>    <span>&lt;<span>div</span>&gt;</span>- by <span>&lt;<span>span</span> <span>ng-bind</span>=<span>\"todo.author\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>    <span>&lt;<span>div</span>&gt;</span><span>&lt;<span>span</span> <span>ng-bind</span>=<span>\"todo.messege\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>  <span>&lt;/<span>div</span>&gt;</span></span><br><span></span><br><span>  <span>&lt;<span>div</span>&gt;</span></span><br><span>    <span>&lt;<span>form</span> <span>name</span>=<span>\"addForm\"</span></span><br><span>          <span>ng-submit</span>=<span>\"mainCtrl.add()\"</span>&gt;</span></span><br><span>      <span>&lt;<span>input</span> <span>type</span>=<span>\"text\"</span></span><br><span>             <span>placeholder</span>=<span>\"Label\"</span></span><br><span>             <span>ng-model</span>=<span>\"mainCtrl.newTodo.label\"</span></span><br><span>             <span>required</span>&gt;</span></span><br><span>      <span>&lt;<span>input</span> <span>type</span>=<span>\"text\"</span></span><br><span>             <span>placeholder</span>=<span>\"Author\"</span></span><br><span>             <span>ng-model</span>=<span>\"mainCtrl.newTodo.author\"</span></span><br><span>             <span>required</span>&gt;</span></span><br><span>      <span>&lt;<span>input</span> <span>type</span>=<span>\"text\"</span> <span>placeholder</span>=<span>\"messege\"</span> <span>ng-model</span>=<span>\"mainCtrl.newTodo.messege\"</span> <span>required</span>&gt;</span></span><br><span>      <span>&lt;<span>input</span> <span>type</span>=<span>\"submit\"</span></span><br><span>             <span>value</span>=<span>\"Add\"</span></span><br><span>             <span>ng-disabled</span>=<span>\"addForm.$invalid\"</span>&gt;</span></span><br><span>    <span>&lt;/<span>form</span>&gt;</span></span><br><span>  <span>&lt;/<span>div</span>&gt;</span></span><br><span></span><br><span><span>&lt;<span>script</span></span><br><span>  <span>src</span>=<span>\"https://ajax.googleapis.com/ajax/libs/angularjs/1.3.11/angular.js\"</span>&gt;</span><span></span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;<span>script</span>&gt;</span><span></span><br><span>  angular.module(<span>'notesApp'</span>, [])</span><br><span>    .controller(<span>'MainCtrl'</span>, [<span>'$http'</span>, <span><span>function</span><span>($http)</span> </span>{</span><br><span>      <span>var</span> self = <span>this</span>;</span><br><span>      self.items = [];</span><br><span>      self.newTodo = {};</span><br><span>      <span>var</span> fetchTodos = <span><span>function</span><span>()</span> </span>{</span><br><span>        <span>return</span> $http.<span>get</span>(<span>'/api/note'</span>).then(</span><br><span>            <span><span>function</span><span>(response)</span> </span>{</span><br><span>              self.items = response.data; <span>// set the items to be the return data.</span></span><br><span>            }, <span><span>function</span><span>(errResponse)</span> </span>{</span><br><span>              console.error(<span>'Error while fetching notes'</span>);</span><br><span>            });</span><br><span>      };</span><br><span></span><br><span>      fetchTodos();</span><br><span></span><br><span>      self.add = <span><span>function</span><span>()</span> </span>{</span><br><span>        $http.post(<span>'/api/note'</span>, self.newTodo)</span><br><span>            .then(fetchTodos) <span>// update items.</span></span><br><span>            .then(<span><span>function</span><span>(response)</span> </span>{</span><br><span>              self.newTodo = {}; <span>// clear the form.</span></span><br><span>            });</span><br><span>      };</span><br><span></span><br><span>    }]);</span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;/<span>body</span>&gt;</span></span><br><span><span>&lt;/<span>html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>$http in detail</h3><p>Promise-style syntax.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></pre></td><td><pre><span>angular.module(<span>'notesApp'</span>, [])</span><br><span>  .controller(<span>'MainCtrl'</span>, [<span>'$http'</span>, <span><span>function</span>(<span>$http</span>) </span>{</span><br><span>    <span>var</span> self = <span>this</span>;</span><br><span>    self.items = [];</span><br><span>    $http.get(<span>'/api/note'</span>).then(<span><span>function</span>(<span>response</span>) </span>{</span><br><span>      self.items = response.data;</span><br><span>      }, <span><span>function</span>(<span>errResponse</span>) </span>{</span><br><span>          <span>console</span>.error(<span>'Error while fetching notes'</span>);</span><br><span>        });</span><br><span>  }]</span><br><span>);</span><br></pre></td></tr></table></figure><p>why Promise is better? try thinking about a case when we have to make 3 http request in a row, when the latter ones will depend on the information from the first ones. If using callbacks, we will need to nest them all together!</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></pre></td><td><pre><span>$http.get(<span>'/api/server-config'</span>)</span><br><span>  .then(<span><span>function</span>(<span>configResponse</span>) </span>{</span><br><span>    <span>return</span> $http.get(<span>'/api/'</span> + configResponse.data.USER_END_POINT);</span><br><span>  })</span><br><span>  .then(<span><span>function</span>(<span>userResponse</span>) </span>{</span><br><span>    <span>return</span> $http.get(<span>'/api/'</span> + userResponse.data.id + <span>'/items'</span>);</span><br><span>  })</span><br><span>  .then(<span><span>function</span>(<span>itemResponse</span>) </span>{ </span><br><span>    <span>// Display items here</span></span><br><span>  }, <span><span>function</span>(<span>error</span>) </span>{</span><br><span>    <span>// Common error handling</span></span><br><span>});</span><br></pre></td></tr></table></figure><h2>Additional information</h2><h3>difference between Promise and callback in js?</h3><p>As for their effect, they are pretty like the same in terms of being asynchronous while Promise’s syntax looks far more clear than nested callbacks.</p>\n<p>Promises provide a more succinct and clear way of representing sequential asynchronous operations in javascript. They are effectively a different syntax for achieving the same effect as callbacks. The advantage is increased readability. Something like this</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></pre></td><td><pre><span>aAsync()</span><br><span>  .then(bAsync)</span><br><span>  .then(cAsync)</span><br><span>  .done(finish);</span><br><span><span>// Promise is much more readable then the equivalent of passing each of those individual functions as callbacks, like:</span></span><br><span></span><br><span>Async(<span><span>function</span>(<span></span>)</span>{</span><br><span>    <span>return</span> bAsync(<span><span>function</span>(<span></span>)</span>{</span><br><span>        <span>return</span> cAsync(<span><span>function</span>(<span></span>)</span>{</span><br><span>            finish()</span><br><span>        })</span><br><span>    })</span><br><span>});</span><br></pre></td></tr></table></figure><p>简单来说， Promise就是syntactic sugar。Everything that can be written in Promise can be written in nested callbacks.</p>\n<h3>difference between websocket and RESTful API?</h3><p>It really depends on the context, whether it requires less interaction like reading a blog, or requires time browsing; or it requires rich interaction and messege sending. For the former, close the connection during reading or browsing may actually save resources, which is exactly what HTTP does, while the latter one calls for websocket!!</p>\n<p><strong>HTTP is a pull service, while websocket is bidirectional.</strong></p>\n<p>参考<a href=\"https://www.pubnub.com/blog/2015-01-05-websockets-vs-rest-api-understanding-the-difference/\" target=\"_blank\" rel=\"external\">这篇博客</a>介绍得非常详细!!</p>"
		},
		{
			"title": "一派胡言[第三期]-民主的不满",
			"link": "http://chocoluffy.com/2016/05/07/%E4%B8%80%E6%B4%BE%E8%83%A1%E8%A8%80-%E7%AC%AC%E4%B8%89%E6%9C%9F-%E6%B0%91%E4%B8%BB%E7%9A%84%E4%B8%8D%E6%BB%A1/",
			"guid": "http://chocoluffy.com/2016/05/07/一派胡言-第三期-民主的不满/",
			"pubDate": "2016-05-08T01:07:37.000Z",
			"categories": [
				"公众号文章",
				"社会人物",
				"读书笔记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>我不清楚我的选择会是什么， 但这并不是我拒绝去看这个问题的理由， 或许在相信他们针锋相对的背后， 就是我的立场。</p>",
			"content": "<p>我不清楚我的选择会是什么， 但这并不是我拒绝去看这个问题的理由， 或许在相信他们针锋相对的背后， 就是我的立场。</p>\n<a></a>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/772fc5772b052551.jpeg\" alt=\"flower\"></div>\n\n<p>自由， 就在于人们选择他们价值与目标的能力。</p>\n<p>我们在政治生活中公民的或者塑造性的一面在很大程度上， 已经让位于自由主义。 而这正是我们现在参与政治活动的困境， 政治， 或者说， 公共哲学， 是否应该具有塑造性。</p>\n<p>古代的政治理论， 比如亚里士多德， 认为政治的目标就是培养德行和达到某种的善。而这种达到某种善的观点， 在现在非常容易被反驳， 我们很容易说， 这是价值判断， 什么是善呢？什么是你认为的善的呢？先抛开价值判断的这种做法来说， 毕竟如果在情愿对一件事， 一种态度深入了解之前就放弃了解它的机会的话， 我们会错过很宝贵的东西。回到这种良善的想法， 其实这种观念自然地会发展出一种社会契约论， 而这个契约的目的正是保证人们往那种善的方向发展。它要求人们需要有对公共事务的知识， 归属感， 对集体的关系， 和共同道德的维系， 一种公民的参与感（相比于现在的自由主义）。</p>\n<p>对一个共同方向的认可， 意味着牺牲某些个人意愿。这是我们都能想到的， 而这种取舍， 或许就是其中一个定义了自由主义和上述共和主义的区别之一。自由主义的宣扬者会说， 政治理论不是某种特定的良善生活观念， 而是坚持宽容、公正的程序以及尊重个人权利， 从各种美国最高法院的判决案例我们也能看出一些倾向性， 自由言论的权利是被美国人民镌刻在心的一种inborn权利， 法官对任何有可能伤害到这种自由的嗅觉是异常灵敏， 或许也是缘因美国人心里对大政府天生的反感。</p>\n<p>我们能不能用之前所说的价值判断这种说法， 来指出共和主义的问题而支持自由主义呢？ 其实仔细想想， 这种价值判断的论断核心是相对主义。 相对主义的一个明显的标志就是， 不去主张什么， 而是变现为质问“谁来判断？谁来决定？”。 他们会问， 什么是良善？什么是高雅和污秽？ 然而我们也可由此问回他们“什么才是他们口中的宽容、自由和公平呢？”。以相对主义来为自由主义辩护根本就算不上是一种辩护。</p>\n<p>但仔细去追究自由主义和共和主义， 我们会发现一个经常提出的问题， 权利和善哪个更重要？这里的善， 我们可以想为是一种道德上的义务， 和认同。我们究竟是一副无负荷自我（the unencumbered self）的自由主义形象, 还是为我们家庭、民族、文化的身份所赋予的目标所束缚？在很多情况下， 也正是这些束缚带给我们困境和痛苦。</p>\n<p>举一个栗子， 内战前的罗伯特李大将军， 身为联邦军队的一名高级将领， 李将军反对分裂， 然后再战争迫近的时候， 他认为他对弗吉尼亚州的责任超过了他对联邦的责任， 于是他毅然会到家乡， 和他的家乡人民共患难。一个让人心酸的困境。如果我们认为，与自己人民站在一起的召唤是一种道德要求而不是情感表达的话， 这正是印证了前文关于良善， 关于道德义务上的困境。相反， 一个自由主义者， 他们没有这样子的束缚， 他们只为他们选择去承担的责任所约束， 也只去承担他们选择去承担的部分。仔细想想， 我们其实常常崇敬这些像李将军一样的人，不一定是因为他们做出的选择， 而是因为他们的考虑所反映的特质－－作为能够反思自身处境的存在者， 看清楚自己的生命处境并担当起来， 自己深深卷入其中的特定生活对自己有所要求， 而自己又意识到这种生活的特殊性， 也就是说意识到存在更加广阔的世界， 另外的生活方式。</p>\n<p>书摘 摘自《民主的不满》</p>\n<p>2015.7.26</p>"
		},
		{
			"title": "AWS elastic beanstalk使用体验",
			"link": "http://chocoluffy.com/2016/05/04/AWS-elastic-beanstalk%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/",
			"guid": "http://chocoluffy.com/2016/05/04/AWS-elastic-beanstalk使用体验/",
			"pubDate": "2016-05-05T01:03:58.000Z",
			"categories": [
				"AWS",
				"javascript",
				"nodejs",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>本文对目前市面上的主流Paas(platform as a service)提供商进行了比较， 比如heroku和amazon家的新星elastic beanstalk。并以一个nodejs爬虫的实例部署在了eb的服务器上。很多关于服务器端的概念也因此理清了， 比如reverse proxy server, dynamic IP addressing和后端的一些配置。也在文章中做个小结， 分享给感兴趣的大家。</p>",
			"content": "<p>本文对目前市面上的主流Paas(platform as a service)提供商进行了比较， 比如heroku和amazon家的新星elastic beanstalk。并以一个nodejs爬虫的实例部署在了eb的服务器上。很多关于服务器端的概念也因此理清了， 比如reverse proxy server, dynamic IP addressing和后端的一些配置。也在文章中做个小结， 分享给感兴趣的大家。</p>\n<a></a>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/de08e7610183200c.png\" alt=\"aws\"></div>\n\n<h2>概览</h2><p>将之前用nodejs写的对<a href=\"https://cnodejs.org/?tab=good\" target=\"_blank\" rel=\"external\">cnode社区精华帖</a>的爬虫放在AWS的EC2 instance下管理， 利用elastic beanstalk来对AWS资源进行分配和调控， 由于使用的还是free-tier的single instance， 则elastic beanstalk所特有的load-balancing的优势没有办法享受到。</p>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/69662ed94ae1f3ff.png\" alt=\"ebean\"></div>\n\n<p>一开始如果直接按照AWS给的方法, <code>eb init</code>初始化一个elastic beanstalk的项目， <code>eb create</code>创建一个environment和一个EC2实例, 然后<code>eb deploy</code>将.git里面committed的改动push到elastic beanstalk的生产环境里面， 然后用<code>eb open</code>来打开这个IP address， 如果之后需要终止这个app的话， 就<code>eb terminate</code>就好了。</p>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/143c21d61cd3cf33.png\" alt=\"heroku\"></div>\n\n<p>如果之前有使用heroku的经验的话， 其实你会发现其实amazon elastic beanstalk和heroku提供的服务非常相似， 实际上， 就这两家服务的定位而言， 都是platform as a service（Paas）， 也就是让developer可以将网站， 移动端部署在云端(cloud)不需要顾虑backend server和database的configuration。 而heroku本身相对于其他市面上的Paas在auto-scaling上做得更加出色， 它的computing resources(dyno)可以按照计算的需求而叠加从而满足在高流量下的网站后端流畅运行。而近几年amazon的elastic beanstalk的出现， 在这个Paas的市场给我们developer多一个很好的选择。就自己的使用而言， 感觉两者的command line interface其实设计得差不多， 都很简洁方便， 不过相比heroku， amazon的AWS还涉及租用到计算单元EC2, 就配置的操作来说， 你在配置AWS的服务上需要花更多的时间去设置环境变量和考虑密钥存储， 毕竟你可能有时候有ssh远程登陆amazon linux服务器的需求。相比之下， heroku的配置就是很简单的在<code>~/.bashrc</code>文件里面添加toolbelt文件夹的路径了。</p>\n<blockquote>\n<p> 其实heroku它本身就是deploy在了AWS上的呀😂， 所以理论上在performance上不会有太大的差别。</p>\n</blockquote>\n<p>而在pricing上， 我认为AWS的价格和服务会更加的实惠， 毕竟考虑到你有一张信用卡就可以申请到你一年的free-tier的single instance的使用权利， 而single instance对一些小型的side project来说完完全全是够用的呀。即便不够用， 换成large instance也是several clicks away， 反正也是按用量收费， 经济实惠!</p>\n<h2>遇到的问题</h2><p>第一个使用EB部署的应用是一个nodejs爬虫， 负责爬去cnode社区的精华帖， 然后返回一个json object收集精华帖的link, 标题和作者avatar， 为了显示的直观， 我并没有写前端的样式， 而是直接<code>JSON.stringify(json)</code>然后send会浏览器。之后如果仅仅作为REST API使用的话， 还需要在router上修饰一下URL。目前还是有点粗糙的。<a href=\"https://github.com/AirLoft/web-scraper\" target=\"_blank\" rel=\"external\">github链接</a></p>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/9fd7dd3d203d2d91.png\" alt=\"demo\"></div>\n\n<p>一开始我直接将在本地localhost运行的版本deploy到了elastic beanstalk上， 由于缺少了这一行配置<code>var port = process.env.PORT || 3000;</code>， 我直接把port定在了3000， 而elastic beanstalk是有应该占用的port的， 所以得到了“502 bad gateway error”。</p>\n<p>还有一点需要注意的是<code>npm start</code>这个npm script里面的配置， AWS elastic beanstalk会找到这条指令并去执行来执行相应的js文件， 比如我把写cnode网站的爬虫写在了cnode.js里面， 那么我需要</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span><span>\"scripts\"</span>: {</span><br><span>  <span>\"start\"</span>: <span>\"node cnode.js\"</span></span><br><span>},</span><br></pre></td></tr></table></figure><p>来保证服务器执行的是我对cnode这个网站的爬虫。</p>\n<h2>Q&amp;A</h2><p>以下内容是我在自己折腾Elastic Beanstalk的时候收集的一些比较简练而准确的总结， 在这里分享给大家。 其实amazon的AWS教程写得非常详细的， 大家自己如果有能力最好去尝试自己阅读和实践它给的例子!</p>\n<p><strong>How elastic beanstalk works?</strong><br>Now you have a web app running in AWS Elastic Beanstalk. As Elastic Beanstalk creates your environment, it <strong>interacts with several other AWS services</strong> to create the resources required to run your web app securely and resiliently.</p>\n<p><strong>How EC2 instance works?</strong><br>EC2 instance – A virtual machine that runs Amazon Linux or Microsoft Windows Server and that is configured to run web apps on the platform that you choose.<br>Each platform runs a different set of software, configuration files, and scripts to support a specific language version, framework, web container, or combination thereof. Most platforms <strong>use either Apache or nginx as a reverse proxy</strong> that sits in front of your web app, forwards requests to it, serves static assets, and generates access and error logs.</p>\n<p><strong>What is reverse proxy server?</strong><br>A proxy server is a go-between or intermediary server that forwards requests for content from multiple clients to different servers across the Internet. A reverse proxy server is a type of proxy server that typically <strong>sits behind the firewall in a private network</strong> and directs client requests to the appropriate backend server. A reverse proxy provides an additional level of abstraction and control to ensure the smooth flow of network traffic between clients and servers.</p>\n<p>Common uses for a reverse proxy server include:</p>\n<ul><li>Load balancing – A reverse proxy server can act as a “traffic cop,” sitting in front of your backend servers and distributing client requests across a group of servers in a manner that maximizes speed and capacity utilization while ensuring no one server is overloaded, which can degrade performance. If a server goes down, the load balancer redirects traffic to the remaining online servers.</li>\n<li>Web acceleration – Reverse proxies can compress inbound and outbound data, as well as cache commonly requested content, both of which speed up the flow of traffic between clients and servers. They can also perform additional tasks such as SSL encryption to take load off of your web servers, thereby boosting their performance.</li>\n<li>Security and anonymity – By intercepting requests headed for your backend servers, a reverse proxy server protects their identities and acts as an additional defense against security attacks. It also ensures that multiple servers can be accessed from a single record locator or URL regardless of the structure of your local area network.</li>\n</ul><p><strong>What is amazon s3 bucket?</strong><br>Amazon S3 bucket – A storage location for your source code, logs, and other artifacts that are created when you use Elastic Beanstalk.</p>\n<p><strong>How your domain will look like?</strong><br>Domain name – A domain name that routes to your web app in the form subdomain.region.elasticbeanstalk.com.</p>\n<p><strong>When should I use AWS Lambda versus Amazon EC2?</strong></p>\n<p>Amazon Web Services offers a set of compute services to meet a range of needs.</p>\n<p>Amazon EC2 offers flexibility, with a wide range of instance types and the option to customize the operating system, network and security settings, and the entire software stack, allowing you to easily move existing applications to the cloud. With Amazon EC2 you are responsible for provisioning capacity, monitoring fleet health and performance, and designing for fault tolerance and scalability. AWS Elastic Beanstalk offers an easy-to-use service for deploying and scaling web applications in which you retain ownership and full control over the underlying EC2 instances. Amazon EC2 Container Service is a scalable management service that supports Docker containers and allows you to easily run distributed applications on a managed cluster of Amazon EC2 instances.<br>AWS Lambda makes it easy to execute code in response to events, such as changes to Amazon S3 buckets, updates to an Amazon DynamoDB table, or custom events generated by your applications or devices. With Lambda you do not have to provision your own instances; Lambda performs all the operational and administrative activities on your behalf, including capacity provisioning, monitoring fleet health, applying security patches to the underlying compute resources, deploying your code, running a web service front end, and monitoring and logging your code. AWS Lambda provides easy scaling and high availability to your code without additional effort on your part.</p>\n<p><strong>To create a hosted zone in Amazon Route 53</strong></p>\n<ul><li>Open the Amazon Route 53 management console.</li>\n<li>Choose Hosted Zones.</li>\n<li>Choose Create Hosted Zone.</li>\n</ul><p>For Domain Name, type the domain name that you own. For example: example.com.</p>\n<p>Choose Create.</p>\n<p>Next, add a CNAME record to the hosted zone. A CNAME record registers a domain name that you own as an alias of your web app environment’s elasticbeanstalk.com subdomain.</p>\n<p>When an Amazon Route 53 DNS server receives a name request for your custom domain name, it resolves to the elasticbeanstalk.com subdomain, which resolves to the public DNS name of your Elastic Load Balancing load balancer, which resolves to your web app’s IP address.</p>\n<p>Note<br>In a single-instance environment, the elasticbeanstalk.com subdomain resolves to an Elastic IP address attached to the instance running your web app.</p>\n<p><strong>关于elastic beanstalk的价格</strong><br>有小伙伴在comment里面提问， 如果用完了一年的free-tier的话， 价格怎么计算呢? 可以参考下amazon的<a href=\"https://aws.amazon.com/elasticbeanstalk/pricing/\" target=\"_blank\" rel=\"external\">这篇介绍</a>里面详细记录了EC2, S3, DB等等AWS相关服务的价格。如果是个人的side project, 对CPU和图片等用户信息存储的需求不是特别大的话， 免费的plan或者是micro的instance是完全够用的， 如果是在某方面的需求特别大， 比如说unsplash这个高清摄影图片分享的社区。</p>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/bb0b5ef1d0298d11.png\" alt=\"unsplash\"></p>\n<p> unsplash将用户上传的照片存储在Amazon的S3服务上会比较安全和便捷，(搭配着Imgix这个service使用)， 具体的网站花销可以参考<a href=\"http://backstage.crew.co/what-does-unsplash-cost/\" target=\"_blank\" rel=\"external\">这篇博文</a>， 里面记录了unsplash一个月网站使用的各种服务的明细记录， 也可以给一些希望做图片分享社区的创业者们一个参考。一个值得注意的点是， unsplash的花销是比较适合借鉴的， 因为unsplash和目前许多的创业公司一样， 选择将自己的主服务host在heroku这个平台， 选择S3等等主流的服务， 不像一些更geeky的公司可能为了省钱就自己来搭建和管理自己的服务器和数据库。 当然， 管理成本和维护成本都要考虑进去， 所以综上我才认为unsplash的例子是非常值得借鉴的!</p>\n<h2>参考链接</h2><p>下面的链接是我在自己尝试搭建环境时参考的内容， 以及我选择free-tier的configuration的页面。其中就有以express为例子的服务端环境搭建。</p>\n<ul><li><a href=\"http://docs.aws.amazon.com/AWSEC2/latest/CommandLineReference/set-up-ec2-cli-linux.html#set_aes_home_linux\" target=\"_blank\" rel=\"external\">setting up EC2 cli on mac</a> we store EC2 api tool, aws-access-key and aws-secret-key in <code>~/.bashrc</code>, so that we can use the shortcut commands to do <code>init\\create\\deploy\\open</code>. The common commands are listed as followed.</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span>eb init</span><br><span>eb create</span><br><span>eb deploy</span><br><span>eb open</span><br></pre></td></tr></table></figure><ul><li><a href=\"https://docs.aws.amazon.com/quickstarts/latest/webapp/welcome.html\" target=\"_blank\" rel=\"external\">A high level explanation of what EB does and what can we config</a> trying to give a high-level description of what is the use and purpost of each AWS service, including EC2, the reverse proxy server sitting in front of servers, router 53 and so on so forth.</li>\n<li><a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_nodejs_express.html\" target=\"_blank\" rel=\"external\">A detailed explanation of how to host an express app on EB full-step tutorial</a> The tutorial uses an express app to explain how to use EB.</li>\n<li><a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_nodejs.html\" target=\"_blank\" rel=\"external\">How to deploy a nodejs project to EB</a> similar to the previous tutorial post.</li>\n<li><a href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html\" target=\"_blank\" rel=\"external\">how to connect to EC2 instance using ssh</a><br>by using <code>ec2-describe-instances</code>, we can get the id of my instance.</li>\n</ul><p>So after we have created an project, we go to the elastic beanstalk console, we will see the dashboard of all the application I host on EB such as the recent one(webscraper). The following is a screen capture of the configuration of that application on EB as in a free-tier plan:<br><img src=\"http://ac-tc2vc5tu.clouddn.com/7c3a33a6cfab0843.png\" alt=\"configuration\"> In this page, we can set the scaling option from single instance to load-balanced configuration, and when we add a load-balancer, it will automatically adjust the number of instances depending on the need.</p>\n<p>When you turn on load balancing, Elastic Beanstalk creates a load balancer, deletes the Elastic IP address from your environment, and provisions a new EC2 instance. Elastic Beanstalk also updates DNS records to point the web app’s domain name to the load balancer instead of to the IP address of a single instance.</p>"
		},
		{
			"title": "[第一期]AirLoft组织动员宣言",
			"link": "http://chocoluffy.com/2016/04/27/%E7%AC%AC%E4%B8%80%E6%9C%9F-AirLoft%E7%BB%84%E7%BB%87%E5%8A%A8%E5%91%98%E5%AE%A3%E8%A8%80/",
			"guid": "http://chocoluffy.com/2016/04/27/第一期-AirLoft组织动员宣言/",
			"pubDate": "2016-04-28T01:46:44.000Z",
			"categories": [
				"创业",
				"日记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>The best education comes from inside. </p>",
			"content": "<p>The best education comes from inside. </p>\n<a></a>\n<div markdown=\"1\"><img src=\"http://ac-tc2vc5tu.clouddn.com/b000a844b66d48d1.jpg\" alt=\"pink\"></div>\n\n<h2>Orientation</h2><p>这个ada内部组织airloft成立的目的， 是我希望大家能在一个更加紧密和熟悉的环境下分享和学习课外知识， 采用github托管的形式是因为它管理代码的高协作效率和peer review的便捷。</p>\n<p>为了保证大家自学步骤的一致性和自由发挥的空间， 我决定采取的是任务发布形式。 <strong>每周会由我或我指定的负责人发布1-2篇的教程或任务</strong>， 任务内容从刚入门的git的使用与协作， 到之后的网站样式布局， 移动端，动效设计，后端编程都会涉及， 而教程则主要来源于<strong>所有有心人对某些创意点子的实现过程无论成败的记录(任何人都可以发布)</strong>。 我不会在任务完成度上给大家太多压力， 但是所有的任务都会指向最终AirLoft移动端APP及一系列配套web app的诞生， 能够深入互动参与每个方向讨论和实践并自己动手coding的人， 也会收获远比完成一个作品， 一个产品更多也更重要的东西， being insightful and clear of what you really want to do。</p>\n<p>组织内部大致的方向：<br>我主导的 - AirLoft reactive native的开发， 并将Airloft网站端从angular1.4全部由react重写。<br>朱子宁主导的 - 爬虫scripts， 对于校园内部热门活动消息，教务信息和周边消息的收集和呈现。<br>Joyce主导的 - 走进多大的web app及html5微信移动页面。<br>Jerry主导的 - 基于GPS的餐饮外卖信息呈现和成交平台。</p>\n<p>每个方向都由不同的coding侧重点， 每个人可自由参与任意方向， <strong>不强制任务进度， 但强制定期分享。</strong>就最终成果而言， 作品与作品之间可以相互配合和改善， 举个例子， 我会使用服务器端的爬虫来收集兴趣小组的讯息， 会在之后的宣传阶段用html5写移动端的宣传页面， 而基于GPS本身就是AirLoft的功能基础。</p>\n<p>而需要再强调一遍的是， <strong>任何人， 在任何时候， 都可以提出新的开发方向和想法， 无论关乎技术还是设计还是美工还是用户体验。</strong>我会欢迎脑洞， 折腾些好玩却可能“无用”的东西， 比如哪一周主题或许就是自学Sketch来给AirLoft换个图标？或者就开个repo去参加HackerRank？能带你自己一直走下去的， 不是压力， 是兴趣。</p>\n<p>很多人会好奇我自己的成长轨迹， 而如果真的往回看， 我是在2015年3月29号那天， 在交换时期参加的一次hacker meeting上， 第一次见识到html\\css\\js， 那天的主题是用meteor.js和mongo在5min内搭建一个todo应用， 嘉宾是伯克利大二的一个学生。到现在学CS大概有1年了吧， 从一开始写javascript各种运动框架开始， 到用ruby on rails自己前后端折腾了5， 6个中型blogging, social或者API网站， 到上学期用react重写各种网站及耗时一个月的SPA应用Airloft， 和现在react native。 我并不觉得自己已经有能力开始回顾自己过去的作品和荣誉， 只是最近挺多人问我“如果想做课外的项目应该学些什么的问题”， 我把我自己的轨迹拿出来给大家参考。永远没有一步登天的成就， 去凭着兴趣摸索， 因为好奇而坚持， 是我能给的最好的建议。</p>\n<p>Orientation动员会的最后， 和大家分享两句话， 第一句来自自己的体会， 第二句来自ECE516 prof: Steve Mann：</p>\n<ul><li>the best education comes from inside.</li>\n<li>the best way to learn is to teach.</li>\n</ul><h2>第一期任务</h2><p>学会git的简单使用, 直接在org内创建一个新的repo， 添加一个readme.md文件， 在里面写上你对两件事的想法， <strong>1、关于社区建造。 你认为应该怎样打造一个经久不衰的社区？举个现实生活中的例子？为什么？ 怎么设计回馈和奖励机制能够造就一个好的社区？哪些设计体现或者暗示了这些机制？2、你对哪个具体开发方向感兴趣？如果在这方面有充足的能力， 你可以怎样贡献到哪个任务里？做出怎样的作品？</strong>， 或者直接在github网页端操作创建新的repo和添加新文件， 或者更佳推荐的方式是本地代码备份然后关联到github的相关repo再push你的本地修改。</p>\n<p>创建好之后， 做第三件事， <strong>3、至少在其他一个别人的repo里面的issue panel提出你对他这个想法的看法和补充</strong>。</p>\n<blockquote>\n<p>任务解释， 比如我喜欢看hackernews， 我对它的投票机制特别感兴趣， 我就拿这个社区的各种机制来举例， 又或者我喜欢B站， 去尝试分析B站哪些设计是特别有用户吸引力的， 记录下来， 新创repo分享。所有可能遇到的问题， 尝试记录下来自己解决， 找不到办法， open一个新的issue然后在微信群里讨论讨论。</p>\n</blockquote>\n<p>参考的链接， 我在第二期任务发布的时候公布。开始折腾起来吧。</p>\n<h2>题外话</h2><ul><li>暑假就是要好好浪的。周末去骑trail， 打球， 聚餐什么的都要约起来啊。</li>\n<li>我喜欢爱折腾的小伙伴。 有什么想说的话都可以私戳我。</li>\n<li>认真对待梦想。 可能这个时代最一文不值和被轻易低估的， 就是梦想了。</li>\n</ul>"
		},
		{
			"title": "关于创业, 那些不能说的秘密",
			"link": "http://chocoluffy.com/2016/04/25/%E5%85%B3%E4%BA%8E%E5%88%9B%E4%B8%9A%EF%BC%8C-%E9%82%A3%E4%BA%9B%E4%B8%8D%E8%83%BD%E8%AF%B4%E7%9A%84%E7%A7%98%E5%AF%86/",
			"guid": "http://chocoluffy.com/2016/04/25/关于创业，-那些不能说的秘密/",
			"pubDate": "2016-04-26T03:39:01.000Z",
			"categories": [
				"创业",
				"读书笔记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>每个人， 在每个阶段， 都会有个不容分说的理由。</p>",
			"content": "<p>每个人， 在每个阶段， 都会有个不容分说的理由。</p>\n<a></a>\n<p><img src=\"http://ac-tc2vc5tu.clouddn.com/88dd510b8366b952.jpg\" alt=\"preface image\"></p>\n<p>趁着考完期末考的一段自由时间， 把之前一直积压着的两本书给读完了。</p>\n<div markdown=\"1\"><br><img src=\"http://ac-tc2vc5tu.clouddn.com/e98f89a56b7989aa.jpeg\" alt=\"the hard thing about hard things\"><br></div>\n\n<p>第一本是来自Ben Horowitz的创业维艰， 前半段描述了他管理Loudcloud到Opsware将一个濒临破产的公司带到最后以16亿美元的价格被惠普收购的传奇经历， 后半段则记录下了他对公司管理的各个细节的心得思考。巧合的时， 就在我阅读这本书的期间， 曾任多家上市公司董事， Ben的精神导师Bill Campbell逝世了。 他对Ben说的那句， “要和员工一起宣布这个消息”的告诫仿佛还历历在目， 通过Ben的描述， 看得出Campbell极其富有同理心(empathy)的领袖气质。 向Campbell致敬。</p>\n<div markdown=\"1\"><br><img src=\"http://ac-tc2vc5tu.clouddn.com/6ceefbf6929babac.png\" alt=\"toureet\"><br></div>\n\n<p> 第二本书是硅谷创业者陈天的随笔。 在一个充斥着来自CEO乃至风险投资人视角的创业回顾的环境下， 一个来自技术合伙人(CTO)的视角显得尤为可贵。 从最早的技术选型(为什么用Django)， 到带领其它技术人员的开发和维护(4台EC2)， 到技术过渡和商业选择， 陈天给了一份很详细和真挚的参考选项， 也让一个非商圈的学生， 慢慢了解到国内白手起家创业的一条非常有代表性的道路。感激陈天老师的分享。</p>\n<p>曾经一直以为， 创业是一件离自己很远的事情。直到一个月前， 一个多伦多大学毕业的直系师兄找到我来聊聊创业的可能。 他希望我能够以技术合伙人的身份帮他做出一个类似airbnb的网站和移动端， 已经有另外两个商科毕业已经工作的学姐愿意参与市场营销和推广， 万事具备， 就差个程序员了。</p>\n<p>也是第一次， 我感觉到创业， 其实也只是一种选择罢了， 突然想到一句微博上看到的话， “对有能力的人来说， 很多事情不是机会， 而是选择。”， 我当然不觉得我自己有能力和把握在这个阶段就合适技术合伙人的身份， 只是当我在一个旁观者的角度去看我身边的故事时， 好像创业， 也并没有倾家荡产， 孤注一掷般的惊天动地， 好像创业， 更像是创始人在生命某个时期赴的一场约， 选择了一条人迹罕至的路， 也由此义无反顾。</p>\n<p>下面是我在阅读时记录下的文字， 从我的角度出发， 或摘录， 或直接是自己的感受， 像《金蔷薇》里那个收集着金色尘土的老人， 我把它们留在这里：</p>\n<h2>The hard thing about hard things</h2><ul><li>在团队有十几个人的时候， 我招了一个人力管理人员， 专门帮我们招聘最聪明的人从硅谷。</li>\n<li>Ben从一个同事分享的mosaic浏览器， 发现这就是未来， 于是第二天就去面试mosaic公司。</li>\n<li><strong>究竟为什么要上市？</strong> 在文中， 作者是在2000年互联网泡沫的时候， 发现私人资金已经没有出路的时候， 想到公开上市， 认为公开市场， 会有更多的人来给自己投资， 而不是一直以来私人投资者的钱。</li>\n<li><strong>如何做资产重组？</strong> 在Ben即将破产的时候， 他问他自己， 如果要退出， 他会怎么做， 他说他会把opsware带出来卖给别人用， 因为这是他自己开发的， 他知道这个特别好用， 但是基于当时的情况， 这个软件被限制住， 没法和loudcloud分离开用， 于是他回去分配了一个精英小组去尝试从现有软件分离出来。</li>\n<li>在紧急情况的时候， 有很有多人议论你， 他们有些人是因为同情， 因为关心， 也可能是想摧毁你。 也会有很多人想帮你， 想帮你摆脱困境， 给出各种各样的建议。 永远从数据和具体情况出发， 没有任何一个旁观者有这个耐心帮你理顺所有的商业策略， 如果你任凭那些根本不了解具体情况的人对公司指手画脚， 那公司就无药可救了。</li>\n</ul><p><img src=\"http://ac-tc2vc5tu.clouddn.com/93c8d666c10be4ba.png\" alt=\"pied piper\"></p>\n<p><strong>很多时候， 我们都会评论那些伟大的CEO， 很自恋自大， narcisist， 专制。 然而他们只是没有听进去那些愚蠢的建议吧了， 又有谁比他们更清楚公司发展的每一个细节呢？</strong></p>\n<ul><li><p>EPS真正想要的是tangram这家公司的软件， 而opsware在tangram比较低股价的时候收购了tangram， 让主要负责融洽opsware的EPS负责任frank特别高兴。也就是Ben他的要求， 弄清楚买方到底想要什么， 去提供他最想要的东西， 而不是一个劲地夸自己好。</p>\n</li>\n<li><p>同时非常重要的也是团队会议， Ben在两次会议中表现都超出了我的意料。第一次在计划从loudcloud中分离出opsware的时候， Ben将新公司的股票送给所有人， 同时允许有人决定退出。 “我不会送你出门， 但我汇帮你找份新的工作。要明确自己此刻所站的位置， 哪些人可以依靠。告诉大家你的决定。”<br>第二次， 在遇到bladelogic这个强劲的对手的时候， Ben再次开了一个全体的会议， 和大家说明白， 他需要大家， 在未来的6个月里面卯足了劲， “我要你们和你们最关心的人认真地谈一次话， 我们需要一次达成目标。”</p>\n</li>\n<li><p>研发出好产品是创新者的职责， 而不是客户。 <strong>客户只知道根据现在的产品体验来判断自己想要什么。</strong></p>\n</li>\n<li><p>在会议中添加一项， “我现在没有做什么” 的议程。而大家觉得的还没有做到的事， 都是一致的。那就是自动化。在公司慢慢做大的时候， 会有很多收购的声音， 其中， 你也会<strong>仅仅因为别人打算收购的意愿而得到股票的溢价</strong>， 要看清楚自己的价值。 同时， 也充分了解自己的直系下属他们的意愿。</p>\n</li>\n<li><p>而对于一个CEO能力的最好的考量， 是逆境不是顺境， 是专心致志的能力， 和在走投无路的时候选择最佳路线的能力。不是去如何不犯错误， 而是在犯错误之后如何去深刻理解那些你必须要做的事。</p>\n</li>\n<li><p>当你意识到一个CEO的职责就是为公司解决问题的时候， 你就知道， 有些没有用的空话可以省去了。</p>\n</li>\n<li><p><strong>在人类的所有交往中， 沟通量和信任程度成反比。</strong>现在很多的公司文化会阻碍坏消息的传播， 真相如果永远只能被戏谑地说出来， 那么等到采取行动的时候就晚了。建立一个奖励文化， 对找到问题症结和解决方案的人给予奖励。于此同时， 公司的任何决策必须当机立断， 比如像裁员这一类的重大决定， 如果不小心走漏风声， 当员工过来质问管理层的时候， 管理者就只有两种选择了， 要么表现出不知情， 要么就是撒谎， 而这其中任何的一个行为都会破坏公司文化。</p>\n</li>\n<li><p>对待裁员。 裁员对公司的最大伤害就是士气。而士气低下的主要表现症状就是怀疑， 所以越是困难的时候， 就越要坦诚相待你的员工。同时， 这是一个非常严重和严肃的时刻， 需要一名直接亲属上司去温和地解决这个事情， 你只要记住， 你的员工可能并无法记得他在这里工作的每一天， 但是他一定会记住他被辞掉的那一天。 <strong>永远记得， 聪明是一种天赋， 而善良是一种选择。</strong> 但是有一点也很重要， <strong>话是说给留下来的人听的</strong>， 你怎么对待那些被辞去的员工， 在困难时候， 就会是留下来的员工的一次自我映照。</p>\n</li>\n<li><p>一定要明晰什么时候笨办法最有用， 不是欺骗自己说， “产品是完美的， 是没有问题的， 问题出在销售人员， 问题出在用户的三分钟热度。”， 不， 问题是， 产品不够好。</p>\n</li>\n<li><p>不让这个公司最精英的人才去参与最棘手的问题， 完全就是浪费。<strong>一个人， 无论多出色， 都解决不了他不了解的问题。也就像开源社区所倡导的一样， 只有有足够多的眼镜， 就可以让所有问题浮出水面。</strong></p>\n</li>\n<li><p>很多时候， 你会吩咐很多指令给你的下属， 但他们并不一定会严格执行， 甚至不会执行这些要求。 而这种现象的背后原因是， <strong>你只告诉了他们应该怎么做， 他们却不知道为什么要这么做。</strong>一个好的工作环境就是， 每个人早上一睁开眼睛就知道自己所做的工作高效有用。管理层需要和每个员工有一对一的会面。当然就有人问了， 好的工作环境和坏的工作环境有什么区别， 是的， 在一切顺利的时候， 没有区别， 你的亮眼成绩会遮住所有可能质疑声的嘴， 问题不是没有， 而是让解决问题的人自我怀疑了。 但是一旦在事情不顺利的时候， 好与坏就是生与死的差别。</p>\n</li>\n<li><p><strong>如何对生产力进行直观的测量？</strong></p>\n</li>\n<li><p>好的产品经理会将一些重要问题以书面形式纪录下来， 竞争中的良策， 艰难的架构选择， 艰难的产品选择。而差的产品经理， 只会以口头的方式表达自己的意见。</p>\n</li>\n<li><p>大公司的主管都是应答式的, 当有事情要实例， 接受到命令之后， 才会去执行。而小公司的主管， 创业公司的管理者， 你不自己主动承担起很多的责任这个公司就倒了啊。一种很危险的情况就是， 在创业公司艰难的时期， 你雇用了一个认股数还不小的高薪高管， 他好像并没有干什么事， 却能够占到一定比例的利润。这就是并不适应节奏的管理层， 对创业公司的奋斗员工有很大的打击。</p>\n</li>\n<li><p><strong>关于招聘</strong>。 永远要提醒自己， 我们是找谁拥有解决问题的能力， 而不是谁看上去最适合。每个人都会有或多或少的缺点， 他可能不善于表达， 他可能有点自大， 有点脾气躁， 这些特质都不应该迷惑你真正找寻的目标。 尤其是在国内这个鱼龙混杂的招聘市场， 明明优秀的人就已经是凤毛麟角了， 如果你还只关注缺点， 只希望站在高处评论一番自我麻醉的话， 这对公司就太可惜了。<strong>写下你认为检验人才最好的几个问题， 形成面试的规范。</strong></p>\n</li>\n<li><p>一个好的管理者思考问题从是会有两个角度， 一个是我想怎么做， 另一个是员工会怎么想。</p>\n</li>\n<li><p>办公室政治</p>\n<ul><li>如果你的员工给你提加薪的要求？ 拒绝， 如果你接受了这个要求， 其他员工会认为你加薪是因为你提出了这个要求而不是因为你出色的业绩。 这个会让其他人更加跃跃欲试。坏处二， 那些办公室里老实沉默， 或者对这种政治手段不敏感的人， 是不是就错过了加薪的机会呢？其中一个避免的方法就是<strong>保证员工收入和公司收入之间的一致性</strong>。</li>\n<li>如果你的员工给你提希望扩大权力范围的要求？一个绝对不能触碰的底线是， 你给他一个口头承诺， 给了小道消息一次机会。 记住， 在公司的决策方案是， <strong>决策即出， 立即执行， 不要在交谈的时候流露出任何口头承诺的倾向</strong>。</li>\n</ul></li>\n</ul><ul><li><p>不要因为你在业务上缺乏经验就降低对他们工作的要求。很多年经轻轻的CEO， 会因为在公司创立之初媒体发布的几篇正面报道而喜出望外。这个标准太低了。</p>\n</li>\n<li><p>管理一家创业公司就像驾驶着一辆高速行驶的汽车， 当你以一个高速过弯的时候， 千万别看墙， 如果你看着墙， 你就直接撞上去， 盯着路， 你就安然无恙。</p>\n</li>\n<li><p>Ben他们建立一个风投公司的初衷， 就是发现了技术性创始人CEO和职业CEO的区别， 那些伟大的技术型驱动的公司都是由创始人经营的， 然而技术型创始人在管理上， 人脉上和营销宣传上有很大的不足。</p>\n</li>\n</ul><blockquote>\n<p>后记:对于《途客圈》一书的总结回顾将会分开在另外一篇博文中， 主要探讨工具性和社交性产品的比较和更多创始人必须注意的具体股权结构， 敬请期待。</p>\n<p>Edit:《途客圈》一书的阅读手记已完成，👉<a href=\"http://chocoluffy.com/2016/05/13/%E5%8F%A6%E4%B8%80%E7%A7%8D%E9%BC%93%E5%A3%B0-%E8%AF%BB%E3%80%8A%E9%80%94%E5%AE%A2%E5%9C%88%E3%80%8B%E6%9C%89%E6%84%9F/\">另一种鼓声-读《途客圈》有感</a></p>\n</blockquote>"
		},
		{
			"title": "创意视频分屏 - HTML5 &amp; JS",
			"link": "http://chocoluffy.com/2016/04/23/%E5%88%9B%E6%84%8F%E8%A7%86%E9%A2%91%E5%88%86%E5%B1%8F-HTML5-JS/",
			"guid": "http://chocoluffy.com/2016/04/23/创意视频分屏-HTML5-JS/",
			"pubDate": "2016-04-24T01:53:56.000Z",
			"categories": [
				"HTML5",
				"javascript",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>和朋友聊天时无意间发现的一个创意视频分屏的想法， 来自<a href=\"http://www.beoplay.com/products/beoplayh7?_ga=1.127614725.969767543.1461077943#at-a-glance\">beoplay</a>这个高端耳机的宣传页面， 在自己实现的过程中， 也发现了视频自适应居中的这个设计细节， 自己也捣鼓了出来， 话说在之后产品的宣传主页视频可以一试的， 从两个视角去诠释同一个故事， 就是对这样有心思的设计细节没有任何抵抗力呢。</p>",
			"content": "<p>和朋友聊天时无意间发现的一个创意视频分屏的想法， 来自<a href=\"http://www.beoplay.com/products/beoplayh7?_ga=1.127614725.969767543.1461077943#at-a-glance\" target=\"_blank\" rel=\"external\">beoplay</a>这个高端耳机的宣传页面， 在自己实现的过程中， 也发现了视频自适应居中的这个设计细节， 自己也捣鼓了出来， 话说在之后产品的宣传主页视频可以一试的， 从两个视角去诠释同一个故事， 就是对这样有心思的设计细节没有任何抵抗力呢。</p>\n<a></a>\n<p><img src=\"https://dl.dropboxusercontent.com/s/09k1efohvmdkphu/beoplay%20demo.gif?dl=0\" alt=\"\"></p>\n<h2>目标</h2><p>仿造beoplay这款耳机<a href=\"http://www.beoplay.com/products/beoplayh7?_ga=1.127614725.969767543.1461077943#video\" target=\"_blank\" rel=\"external\">主页的宣传视频</a>来实现一个类似的视频分屏的效果。</p>\n<h2>版本1.0（不加视频自适应居中）</h2><p><img src=\"https://dl.dropboxusercontent.com/s/zppojylzfsyk6in/screensplit1.0.gif?dl=0\" alt=\"\"></p>\n<p>right video是静止的不动的， 同时位于最底层。 目前所有的伸缩都是在控制left video， 同时由于我们设置了left video的<code>z-index</code>为3， 那么左边的视频会覆盖在右边的视频上。接下来的目标就很明确了， 我们需要追踪鼠标在整个container里面的位置(我们会用占宽度的百分比来表示)， 然后， 通过改变左边视频的宽度， 同时也就把位于下面的右边视频暴露出来了， 来达到切换的效果。</p>\n<p>理解到这一步之后，目标就是<strong>如何改变视频宽度</strong>了。</p>\n<h3>如何改变视频宽度</h3><p>这里其实隐藏着一个陷阱， 就是因为我们不可以直接改变<strong>视频本身的宽度</strong>，因为视频的高宽比在拍摄的时候就决定了， 我们如果只拉长视频而不同时提高高度的话， 就会使得在纵轴上部分内容被遮盖到， 大致意思如图：</p>\n<p><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1f37ixae23nj219e0oe77a.jpg\" alt=\"\"></p>\n<p>而这并不是我们想要的效果， 我们希望， 视频可以维持在同一个大小，而改变的只是<strong>视窗的横向移动</strong>，<br>这一步我用到了一个trick， 就是<code>overflow: hidden;</code>， 我们在左边的视频外面包住了一层<code>div</code>， 因为我们控制的就是左边的视频， 然后我们来改变这个“wrapper”的宽度（同时保证保证里面的left video的宽度占比仍然占最外面container的100%）， 来改变我们的视窗， 所以这个wrapper在网页上所包住的部分， 加上了<code>overflow: hidden;</code>遮去了超出部分后， 显示的就是左边的视频了。</p>\n<p>比如一开始， 我们希望两个视频都各占一半， 那么左边的视窗一开始就会是占比原container的宽度的50%， 而原视频本身的宽度应该不变， 即container的宽度的100%， 所以我们需要给left video赋上200%的宽度， 理由是这个属性是对其直接父级的div起作用的。</p>\n<h3>引入视窗</h3><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></pre></td><td><pre><span><span>/* clipper 即左侧视频的视窗 */</span></span><br><span><span>#clipper</span> <span>{</span><br><span>\t<span><span>width</span>:<span> <span>50%</span></span></span>;</span><br><span>\t<span><span>position</span>:<span> absolute</span></span>;</span><br><span>\t<span><span>top</span>:<span> <span>0</span></span></span>;</span><br><span>\t<span><span>bottom</span>:<span> <span>0</span></span></span>;</span><br><span>\t<span><span>overflow</span>:<span> hidden</span></span>;</span><br><span>}</span></span><br><span></span><br><span><span>/* 该属性作用于左侧视频  */</span></span><br><span><span>#clipper</span> <span>video</span> <span>{</span><br><span>\t<span><span>width</span>:<span> <span>200%</span></span></span>;</span><br><span>\t<span><span>position</span>:<span> absolute</span></span>;</span><br><span>\t<span><span>z-index</span>:<span> <span>10</span></span></span>;</span><br><span>}</span></span><br></pre></td></tr></table></figure><p>效果如下：</p>\n<p><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1f37j53tshej21a20o643j.jpg\" alt=\"init\"></p>\n<p>之后的事情就清楚了， 我们只需要改变<strong>左边视窗的宽度， 并同时保证视频本身相对原容器的宽度不变</strong>。写的js代码如下：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></pre></td><td><pre><span><span>var</span> rect = videoContainer.getBoundingClientRect(),</span><br><span>offset = e.pageX - videoContainer.offsetLeft,</span><br><span>position = ((e.pageX - videoContainer.offsetLeft) / videoContainer.offsetWidth) * <span>100</span>;</span><br><span></span><br><span><span>if</span> (position &lt;= <span>100</span>) {</span><br><span>\tvideoClipper.style.width = position+<span>\"%\"</span>;</span><br><span>\tleftVideo.style.width = ((<span>100</span>/position)*<span>100</span>)+<span>\"%\"</span>;</span><br><span>\tleftVideo.style.zIndex = <span>3</span>;</span><br><span>｝</span><br></pre></td></tr></table></figure><blockquote>\n<p>简单地说， 只需保证<code>videoClipper.style.width * leftVideo.style.width = 100%</code>即可。</p>\n</blockquote>\n<p>那最后一个改变<code>z-index</code>的目的， 就是确保左边的视频一直叠加在右边的视频之上。</p>\n<h2>版本2.0（增加了自适应居中）</h2><p><img src=\"https://dl.dropboxusercontent.com/s/8y6fr3ib87yz9h7/screensplit2.0.gif?dl=0\" alt=\"\"></p>\n<p>初衷： 因为从拍摄的角度， 大部分的时间， 我们都会把拍摄的主体放在视频的中间位置， 而如果我们只是简单地移动视窗而不改变视窗的主角位置的话， 我们在鼠标移动的时候， 就只能看到边边角的视频内容了， 这违反设计直觉。</p>\n<p>因此我们希望在移动视窗的同时， <strong>同时移动视频本身的位置来弥补视窗的偏差</strong>。相应的js代码是：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span>offset = e.pageX - videoContainer.offsetLeft,</span><br><span>offsetRight = videoContainer.offsetWidth - offset,</span><br><span></span><br><span><span>// for adaptive resizing:</span></span><br><span>rightVideo.style.webkitTransform = <span>\"translate(\"</span> + offset / <span>2</span> + <span>\"px, 0)\"</span>;</span><br><span>leftVideo.style.webkitTransform = <span>\"translate(-\"</span> + offsetRight / <span>2</span> + <span>\"px, 0)\"</span>;</span><br></pre></td></tr></table></figure><blockquote>\n<p>画外音： 使用<code>transform</code>来改变DOM元素的位置相比直接改写他们的”定位属性“有很多好处， 其中最突出的就是， transform使用的是GPU， 而那些<code>top\\left</code>等的定位元素使用的是CPU， 我们希望充分利用GPU和它提供的硬件加速， 同时<code>transform</code>也不会触发网页的repaint， 从而在渲染上更加的smooth和fast。</p>\n</blockquote>\n<p>那这个地方，<code>offset</code>就是鼠标在container里面距离左边边框的距离， 那么我们同时根据这个距离， 让左边的视频在视窗移动时， <strong>往相反的方向以一半的速度移动来弥补视窗偏差</strong>。使得可以在视窗移动的时候， 始终保持视频本身拍摄的主体视角也处于该视窗的主体视角! 原理可以参考这个图：</p>\n<p><img src=\"https://dl.dropboxusercontent.com/s/t99wbc4n3s8c4r7/screensplit3.0.gif?dl=0\" alt=\"\"></p>\n<p>那么也就大功告成啦!</p>\n<h2>总结</h2><p>HTML5对media文件更多功能上的支持使得我们可以更好的操作media文件， 包括视频的开始暂停， 以及各种音量的调节， 而这个程序实例， 是一个很好的对相关API的使用的一个示范和一个小小的创意细节。这个项目， 也是饭后和朋友聊天聊出来的实现方案，也希望看到更多的创意脑洞和美的设计!</p>\n<p>这个是这个项目的<a href=\"https://github.com/chocoluffy/screen-split-video\" target=\"_blank\" rel=\"external\">github repo</a>, 这个是项目的展示<a href=\"http://chocoluffy.com/screen-split-video/\">demo</a> 欢迎评论和pull request~</p>\n<h2>Q&amp;A</h2><p>后续的一些疑问和解答：(基于V2ex和微博的评论)</p>\n<p><strong>跟<a href=\"http://www.mi.com/hezi3s/\" target=\"_blank\" rel=\"external\">这个链接</a>中间的 2K－4K 对比差不多一个意思？</strong><br>A: 哈哈在分屏效果上是类似的， 不过那个对图片的处理就会简单很多啦， 感觉就是在某个位置以左叠加一个高斯模糊的滤镜就可以了~ 相比之下， 对视频的处理还要考虑到视窗和视频本身的移动呢! 不过谢谢分享啦!</p>\n<p><strong>多个声音怎么办？两个声音会重叠嘛？</strong><br>A: 我做了音轨的渐变处理， 也就是根据视频的相对大小来相对改变音量， 也就是说， 当某个视频占主体位置的时候， 另一个视频的声音是会渐弱的， 这样可能使用体验更好吧! 在博文最后有 demo 的网址， 你可以试试， 我 host 在了 github pages 上， 对了， 这个 demo 只在桌面端 work ， 在手机端还是实现不了这个效果呢， 有点可惜啦， 如果有改进的建议的话， 希望能提出来啦~</p>\n<p><strong>快速拉扯的时候边缘缝隙比较大?</strong><br>A: 啊对的！我调试的时候也发现是有， 原因也很明显， 我只对整个 container 绑定了 mousemove 事件， 而 html 页面其他元素是不会监听 mousemove 的， 因此当鼠标快速移出 container 的时候， 就会发现边缘缝隙较大了， 我现在就改改 code ， 加个 condition ， 如果鼠标在 container 之外， 就把视频宽度订死为全屏~谢谢啦!</p>"
		},
		{
			"title": "MEAN全栈开发[第三期-Mongo数据库搭建REST API]",
			"link": "http://chocoluffy.com/2016/03/22/MEAN%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91-%E7%AC%AC%E4%B8%89%E6%9C%9F-Mongo%E6%95%B0%E6%8D%AE%E5%BA%93%E6%90%AD%E5%BB%BAREST-API/",
			"guid": "http://chocoluffy.com/2016/03/22/MEAN全栈开发-第三期-Mongo数据库搭建REST-API/",
			"pubDate": "2016-03-23T02:50:55.000Z",
			"categories": [
				"javascript",
				"nodejs",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>AirLoft的原型。 第三期， 基于mongodb的mongoose来搭建RESTful API， 主要包括了关于各类涉及到对象的GET, POST, PUT DELETE方法的实现。 在postman上不断的模拟， 也最终搭好一个稳定且flexible的后端API处理， 剩下的就是将数据库和这个Express App的controller结合， 并在前端上灵活的应用啦！如果说前端就像一个人的妆容， 那么数据库以及API处理就是他的谈吐和内涵， 这个应用也有了scaling的能力， 加油!</p>",
			"content": "<p>AirLoft的原型。 第三期， 基于mongodb的mongoose来搭建RESTful API， 主要包括了关于各类涉及到对象的GET, POST, PUT DELETE方法的实现。 在postman上不断的模拟， 也最终搭好一个稳定且flexible的后端API处理， 剩下的就是将数据库和这个Express App的controller结合， 并在前端上灵活的应用啦！如果说前端就像一个人的妆容， 那么数据库以及API处理就是他的谈吐和内涵， 这个应用也有了scaling的能力， 加油!</p>\n<a></a>\n<p><img src=\"http://ww1.sinaimg.cn/large/c5ee78b5jw1f26lk141v7j21kw0tjn61.jpg\" alt=\"screenshot\"></p>\n<h2>前言</h2><p>In MVC architecture, we need to have views without content or data. An common way to implement MVC architecture is to <strong>first build up a frontend clickable prototype, then extract the content from the view back to controller(concerned with data structure), then back to model.</strong> And now we are in the second step, we try to put variable in jade file in place of content, and put the content as variable into the controller.</p>\n<h2>Mongoose</h2><p>First set up a connection URI like: <code>var dbURI = 'mongodb://localhost/airloft';</code>, username, password and port number is optional for localhost.</p>\n<p>A stupid mistake!! Need to open the <code>mongod</code> before you tried to connect to it. One thing to notice is that Mongoose connection doesn’t automatically close when the application restarts or stops. In order to do that whenever we restart the <code>nodemon</code>, we will need to listen for nodejs event. Nodemon uses <code>SIGUSR2</code>, application termination uses <code>SIGINT</code>, Heroku uses <code>SIGTERM</code>, like:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></pre></td><td><pre><span><span>var</span> graceShutDown = <span><span>function</span>(<span>msg, callback</span>)</span>{</span><br><span>\tmongoose.connection.close(<span><span>function</span>(<span></span>)</span>{</span><br><span>\t\t<span>console</span>.log(<span>'Mongoose is closed through '</span> + msg);</span><br><span>\t\tcallback();</span><br><span>\t});</span><br><span>};</span><br><span></span><br><span>process.once(<span>'SIGUSR2'</span>, <span><span>function</span>(<span></span>)</span>{</span><br><span>\tgraceShutDown(<span>'nodemon restart'</span>, <span><span>function</span>(<span></span>)</span>{</span><br><span>\t\tprocess.kill(process.pid, <span>'SIGUSR2'</span>);</span><br><span>\t});</span><br><span>});</span><br></pre></td></tr></table></figure><p>use <code>process.once</code> to overwrite the default <code>SIGUSR2</code> function, but then use <code>kill</code> to resend the <code>SIGUSR2</code> signal again, but this time we hook up a msg display functionality. Especially the place, we use <code>process.once()</code> instead of <code>process.on()</code> in the <code>SIGUSR2</code> case, since nodejs will listen for the same event, and if we use <code>on</code>, then it will forms a infinite loop. Note that <code>process.kill()</code> serves the functionality of sending the signal.</p>\n<blockquote>\n<p>Recap: Basically four step as discussed here, first define a connection URI string, then second setup the db connection; third monitor the mongoose connection events like <code>connected</code> and <code>disconnected</code>, and fourth monitor the node process event in order to close the db connection when we restart.</p>\n</blockquote>\n<p>From view to controller, finally to store in db is what we have gone through so far. It works pretty well, since the moment we move the data to the controller, we gradually solidy the data structure we want to use!!</p>\n<p>Some technical names: “path” is like attribute names in relational database while “property object” is like the values but like other JS object, can be nested. Also, we can add data validation inside the schema, two advantages: </p>\n<ul><li>save the roundtrip time to datebase</li>\n<li>save the code inside the application for validation.</li>\n</ul><p>Adding indexes can make database search more efficiently, jist like adding index to the files you want to search in your drawer. In order to add a GeoJSON path into your application, you only need to do this: <code>coords: {type: [Number], index: '2dsphere'}</code>; using <code>2dsphere</code> allows mongodb to be able to calculate the geolocation fast, thus <strong>it is helpful to build a location-based application.</strong></p>\n<p>Subdocument is helpful when handling nested data structure, one thing to note, when creating attributes like <code>timestamp</code>, we use data type called <code>Date</code>, like:   </p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>var</span> reviewSchema = <span>new</span> mongoose.Schema({</span><br><span>\trating: {type: <span>Number</span>, <span>\"default\"</span>: <span>0</span>, min: <span>0</span>, max: <span>5</span>},</span><br><span>\tauthor: <span>String</span>,</span><br><span>\tcreatedOn: {type: <span>Date</span>, <span>\"default\"</span>: <span>Date</span>.now},</span><br><span>\ttext: <span>String</span>;</span><br><span>});</span><br></pre></td></tr></table></figure><p><img src=\"http://ww3.sinaimg.cn/large/c5ee78b5gw1f1wrkszhcej218w0u6wib.jpg\" alt=\"mongo\"> 这张图讲得很清楚， schema是application-side的东西， 每一个model是的实例instance通过schema可以map到database里面的每一个document, 1:1的对应关系。</p>\n<p>While typing in <code>mongod</code> will let you start the mongodatabase, using <code>mongo</code> will start tht shell and let you connect to the test database. And some useful commands in mongo go here:</p>\n<ul><li><code>show dbs</code> to show all existing database so far.</li>\n<li><code>use local</code> to switch to another database. And if that db doesn’t exist yet, mongo will create it for us.</li>\n<li><code>show collections</code></li>\n<li><code>db.startup_log.find()</code> returns all the content from collection, uesful when we check whether the data has been saved.</li>\n<li><code>db.missions.save({...})</code> will savev a new document into collection.</li>\n<li><code>db.inventory.remove({})</code> will remove all documents in collection <code>inventory</code>.</li>\n<li><code>db.missions.update()</code> will query a document and update its content. The first argument is query string, and second argument use <code>$push</code> to insert subdocuments.</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></pre></td><td><pre><span> &gt; db.locations.update({ </span><br><span>   name: <span>'Starcups'</span></span><br><span>  }, { </span><br><span>    $push: {</span><br><span>      reviews: {</span><br><span>        author: <span>'Simon Holmes'</span>,</span><br><span>        id: ObjectId(),</span><br><span>        rating: <span>5</span>,</span><br><span>        timestamp: <span>new</span> <span>Date</span>(<span>\"Jul 16, 2013\"</span>),</span><br><span>        reviewText: <span>\"What a great place. I can't say enough good things about it.\"</span></span><br><span>      } </span><br><span>      </span><br><span>    }</span><br><span>})</span><br></pre></td></tr></table></figure><p>So far, we have insert a fake data document in our local computer, but in real life, <strong>we want database to be externally accessible.</strong> use <code>heroku addons:add mongolab</code> to register a db URI at mongolab as a heroku addons.<strong> And use <code>heroku addons:open mongolab</code> to go the website interface to check database details. </strong>In order to get the uri of the database, type <code>heroku config:get MONGOLAB_URI</code>. </p>\n<blockquote>\n<p>Note that in real practice, I have to fixed a typo bug from my previous data stored in mongolab, I have to first go to the mongo shell to <code>remove({})</code> and <code>insert({...})</code> again, then do the <code>mongodump</code> and <code>mongorestore</code> again to dump the data into the temp folder at <code>~/tmp</code> and push the data to live database. And make sure to press the “Delete all collection” button before we did <code>mongorestore</code> to avoid same key collision.</p>\n</blockquote>\n<p>After receive URI, we will first dump our localhost data into a folder in local computer, then restore the data to the live database. use <code>mkdir -p ~/tmp/mongodump</code> will create a folder to hold up the dumped data. Note that use <code>-p</code> option will create the non-existed folders on the path like “tmp”.</p>\n<ul><li>use <code>mongodump -h localhost:27017 -d airloft -o ~/tmp/mongodump</code> to export airloft.missions data into BSON.</li>\n<li>use <code>mongorestore -h &lt;host and port number&gt; -d &lt;live database name&gt; -u &lt;username(same as database name)&gt; -p &lt;password&gt; &lt;path to dump data folder&gt;</code> to push the data up to the mongolab live database.</li>\n<li>Last step(testing), we can use <code>mongo hostname:port/database_name -u username -p password</code> to change the <code>mongo</code> to interact with an external database. Note that in the last two steps, database name is the same as username. Then, we can use commands introduced before to interact with live database. In summery, we have one source code and can be used to manipulate databases at two locations, one in local computer, a test database, and one in Heroku, a live database.</li>\n</ul><p>Let application use right database. use <code>heroku config:set NODE_ENV=production</code> to set the environment variable <code>NODE_ENV</code> to be production for Heroku. <strong>Environment variable will affect the way the core process runs.</strong> When we tried to use <code>nodemon</code> to start application, one way to make sure what environemnt we are running in is to prepend a ENV variable before nodemon like <code>NODE_ENV=production nodemon</code>, and corresponds to this change, we also change the code in db.js(with a if-else block) to set the dbURI aligned with environment. In application, we can access to such variable by <code>process.env.NODE_ENV</code>, but since we post it in public repo, we don’t want our credentials to be public. Instead, we use environment variables from Heroku configuration.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></pre></td><td><pre><span><span>var</span> dbURI = <span>'mongodb://localhost/airloft'</span>;</span><br><span></span><br><span><span>if</span>(process.env.NODE_ENV === <span>'production'</span>){</span><br><span>\tdbURI = process.env.MONGOLAB_URI;</span><br><span>}</span><br><span></span><br><span>mongoose.connect(dbURI);</span><br></pre></td></tr></table></figure><h2>REST APIs</h2><p>REST is an architecture style, it’s stateless, meaning it will not recognize users or history. Having such program interface will allow us to talk to our database through HTTP and perform CRUD operations then send back a HTTP response. An way to construct URLs is to think about the collections in our database. In ‘airloft.missions’ collection, we may want to allow operations like:</p>\n<ul><li><code>/missions</code> to create an new mission.</li>\n<li><code>/missions</code> to read all missions.</li>\n<li><code>/missions/&lt;index&gt;</code> to read a specific mission.</li>\n<li><code>/missions/&lt;index&gt;</code> to update a specific mission. And so on so forth.</li>\n</ul><p>As we can see the urls are same for several operations, and we will use different request methods to tell the server what action to take.</p>\n<ul><li><code>POST</code> to create new data in database(from submitting form).</li>\n<li><code>GET</code> to read data.</li>\n<li><code>PUT</code> to update a document.</li>\n<li><code>DELETE</code> to delete a document.</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>// missions</span></span><br><span>router.get(<span>'/missions'</span>, ctrlMissions.missionsListByDistance);</span><br><span>router.post(<span>'/missions'</span>, ctrlMissions.missionsCreate);</span><br><span>router.get(<span>'/missions/:missionid'</span>, ctrlMissions.missionsReadOne);</span><br><span>router.put(<span>'/missions/:missionid'</span>, ctrlMissions.missionsUpdateOne);</span><br><span>router.delete(<span>'/missions/:missionid'</span>, ctrlMissions.missionsDeleteOne);</span><br></pre></td></tr></table></figure><p>Then in the corresponding controller files, we define these functions and fill them with the simplest response to display when received such request.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></pre></td><td><pre><span><span>var</span> sendJsonRes = <span><span>function</span>(<span>res, status, content</span>)</span>{</span><br><span>\tres.status(status);</span><br><span>\tres.json(content);</span><br><span>}</span><br><span></span><br><span><span>module</span>.exports.missionsListByDistance = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\tsendJsonRes(res, <span>200</span>, {<span>\"status\"</span>: <span>\"success\"</span>});</span><br><span>}</span><br></pre></td></tr></table></figure><h2>“GET” method implementation</h2><p>Some useful queries in Mongoose:</p>\n<ul><li><code>find</code> general search based on query object.</li>\n<li><code>findById</code> look for specific ID.</li>\n<li><code>findOne</code> get the first match document.</li>\n<li><code>geoNear</code> find geo-closef query.</li>\n<li><code>geoSearch</code> add query functionality to geoNear operation.</li>\n</ul><p>After using queries, we use <code>exec</code> method execute the query and passes a callback function that will run when the operation is complete. The callback function should accept two parameters, an error object and the instance of found document.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></pre></td><td><pre><span><span>var</span> sendJsonRes = <span><span>function</span>(<span>res, status, content</span>)</span>{</span><br><span>\tres.status(status);</span><br><span>\tres.json(content);</span><br><span>}</span><br><span></span><br><span><span>module</span>.exports.missionsReadOne = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\tMissions</span><br><span>\t\t.findById(req.params.missionid)</span><br><span>\t\t.exec(<span><span>function</span>(<span>err, mission</span>)</span>{</span><br><span>\t\t\tsendJsonRes(res, <span>200</span>, mission);</span><br><span>\t\t})</span><br><span>}</span><br></pre></td></tr></table></figure><p>Then, we want to add error checking like this: note that we can also utilize <code>console.log</code> to print out some useful information about the data in terminal since we use <code>nodemon</code>. </p>\n<p>In real practice, we may not always want to retrive a whole document from mongodb, we may only just need some specific data. Thus, we can limit the data being passed around to improve speed, using <code>select</code> to retriece only “name” and “reviews” entry from a document in collection. Like this:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br></pre></td><td><pre><span><span>module</span>.exports.reviewsReadOne = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\t<span>if</span>(req.params &amp;&amp; req.params.missionid &amp;&amp; req.params.reviewid){</span><br><span>\t\tMissions</span><br><span>\t\t\t.findById(req.params.missionid)</span><br><span>\t\t\t.select(<span>'name reviews'</span>)</span><br><span>\t\t\t.exec(<span><span>function</span>(<span>err, mission</span>)</span>{</span><br><span>\t\t\t\t<span>if</span>(!mission){</span><br><span>\t\t\t\t\tsendJsonRes(res, <span>404</span>, {</span><br><span>\t\t\t\t\t\t<span>\"message\"</span>: <span>\"missionid not found\"</span></span><br><span>\t\t\t\t\t})</span><br><span>\t\t\t\t\t<span>return</span>;</span><br><span>\t\t\t\t}<span>else</span> <span>if</span>(err){</span><br><span>\t\t\t\t\tsendJsonRes(res, <span>404</span>, err);</span><br><span>\t\t\t\t\t<span>return</span>;</span><br><span>\t\t\t\t}</span><br><span>\t\t\t\t<span>var</span> response, review;</span><br><span>\t\t\t\treview = mission.reviews.id(req.params.reviewid);</span><br><span>\t\t\t\t<span>if</span>(!review){</span><br><span>\t\t\t\t\tsendJsonRes(res, <span>404</span>, {</span><br><span>\t\t\t\t\t\t<span>\"message\"</span>: <span>\"reviewid not found!\"</span></span><br><span>\t\t\t\t\t})</span><br><span>\t\t\t\t\t<span>return</span>;</span><br><span>\t\t\t\t}</span><br><span>\t\t\t\tresponse = {</span><br><span>\t\t\t\t\tmission: {</span><br><span>\t\t\t\t\t\tname: mission.name,</span><br><span>\t\t\t\t\t\tid: req.params.missionid</span><br><span>\t\t\t\t\t},</span><br><span>\t\t\t\t\treviews: review</span><br><span>\t\t\t\t};</span><br><span>\t\t\t\tsendJsonRes(res, <span>200</span>, response);</span><br><span>\t\t\t});</span><br><span>\t}<span>else</span>{</span><br><span>\t\tsendJsonRes(res, <span>404</span>, {</span><br><span>\t\t\t<span>\"message\"</span>: <span>\"No missionid or reviewid in request\"</span></span><br><span>\t\t})</span><br><span>\t}</span><br><span>}</span><br></pre></td></tr></table></figure><p>Apart from the error checking in the above code, we can use <code>id</code> to query subdocument the <code>_id</code> entry. <strong>note that in the raw data, I mistakenly put the entry name to be <code>id</code> instead of <code>_id</code>, which causes me to re-insert the data again to let the <code>id()</code> work for subdocument.</strong></p>\n<p>These above example codes shows us how to simulate “GET” request for mission and reviews in “missions” collection in live mongolab database. When it comes to geo-query, we need to query the longtitude and latitude in <code>req.query</code> with some urls like this: <code>api/missions?lng=-12.34343434&amp;lat=51.22424224</code>.</p>\n<p>Besides, the way writing the js code is quite important using closure!! I use an example that will be reused in later geo-distance calculation to illustrate how to <strong>only expost functions for later use with closure to wrap the inner variables from outer collisions.</strong></p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></pre></td><td><pre><span><span>var</span> theEarth = (<span><span>function</span>(<span></span>)</span>{</span><br><span>  <span>var</span> earthRadius = <span>6371</span>;</span><br><span>  <span>var</span> getDistanceFromRads = <span><span>function</span>(<span>rads</span>)</span>{</span><br><span>    <span>return</span> <span>parseFloat</span>(earthRadius * rads);</span><br><span>  }</span><br><span>  <span>var</span> getRadsFromDistance = <span><span>function</span>(<span>distance</span>)</span>{</span><br><span>    <span>return</span> <span>parseFloat</span>(distance/getRadsFromDistance);</span><br><span>  }</span><br><span>  <span>return</span> {</span><br><span>    getDistanceFromRads: getDistanceFromRads,</span><br><span>    getRadsFromDistance: getRadsFromDistance</span><br><span>  }</span><br><span>})()</span><br></pre></td></tr></table></figure><p>Then the complete geo searching functions are:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br></pre></td><td><pre><span><span>// for main page listing by distance.</span></span><br><span><span>var</span> resToList = <span><span>function</span>(<span>results</span>)</span>{</span><br><span>\t<span>var</span> lst = [];</span><br><span>\tresults.forEach(<span><span>function</span>(<span>doc</span>)</span>{</span><br><span>\t\tlst.push({</span><br><span>\t\t\t\tdistance: theEarth.getDistanceFromRads(doc.dis),</span><br><span>\t\t\t\tname: doc.obj.name,</span><br><span>\t\t\t\tauthor: doc.obj.author,</span><br><span>\t\t\t\trating: doc.obj.rating,</span><br><span>\t\t\t\ttags: doc.obj.tag,</span><br><span>\t\t\t\t_id: doc.obj._id</span><br><span>\t\t})</span><br><span>\t})</span><br><span>\t<span>return</span> lst;</span><br><span>};</span><br><span></span><br><span><span>module</span>.exports.missionsListByDistance = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\t<span>if</span>(req.query.lng &amp;&amp; req.query.lat){</span><br><span>\t\t<span>var</span> lng = <span>parseFloat</span>(req.query.lng);</span><br><span>\t\t<span>var</span> lat = <span>parseFloat</span>(req.query.lat);</span><br><span>\t\t<span>var</span> point = {</span><br><span>\t\t\ttype: <span>\"Point\"</span>,</span><br><span>\t\t\tcoordinates: [lng, lat]</span><br><span>\t\t};</span><br><span>\t\t<span>var</span> geoOptions = {</span><br><span>\t\t\tspherical: <span>true</span>,</span><br><span>\t\t\tmaxDistance: theEarth.getRadsFromDistance(<span>parseInt</span>(req.query.maxdistance||<span>2000</span>)),</span><br><span>\t\t\tnum: <span>10</span>,</span><br><span>\t\t};</span><br><span>\t\t<span>// console.log(geoOptions.maxDistance);</span></span><br><span>\t\tMissions.geoNear(point, geoOptions, <span><span>function</span>(<span>err, results, stats</span>)</span>{</span><br><span>\t\t\t<span>if</span>(err){</span><br><span>\t\t\t\tsendJsonRes(res, <span>404</span>, err);</span><br><span>\t\t\t\t<span>return</span> ;</span><br><span>\t\t\t}</span><br><span>\t\t\tsendJsonRes(res, <span>200</span>, resToList(results));</span><br><span>\t\t});</span><br><span>\t}</span><br><span>\t<span>else</span> {</span><br><span>\t\tsendJsonRes(res, <span>404</span>, {</span><br><span>\t\t\t<span>\"message\"</span>: <span>\"Found no longtitue or lattitude in query string.\"</span></span><br><span>\t\t});</span><br><span>\t\t<span>return</span>;</span><br><span>\t}</span><br><span>}</span><br></pre></td></tr></table></figure><blockquote>\n<p>So far, we complete all three “GET” methods for this website, namely, [1]ListByDistance for the main page “/api/missions”; [2]get a single mission information for each mission document in db “/api/missions/<_id>“; [3]get a single review information for reviews from each mission document as subdocument “/api/missions/<_id>/reviews/<_id>“. And next, we will look at other methods like “POST”, “PUT” and “DELETE”.</_id></_id></_id></p>\n</blockquote>\n<h2>“POST” method implementation</h2><p>In this project, since we only involve missions and reviews, we need to implement new mission post and new review post from form data, which is stored at <code>req.body.&lt;attr&gt;</code>.<br>The way we create an document is using <code>create()</code> directly :</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></pre></td><td><pre><span><span>module</span>.exports.missionsCreate = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\tMissions.create({</span><br><span>\t\tname: req.body.name,</span><br><span>\t\trating: req.body.rating,</span><br><span>\t\ttag: req.body.tags.split(<span>\",\"</span>),</span><br><span>\t\tauthor: req.body.author,</span><br><span>\t\tcoords: [<span>parseFloat</span>(req.body.lng), <span>parseFloat</span>(req.body.lat)],</span><br><span>\t\ttimepanel: {</span><br><span>\t\t\ttitle: req.body.timetitle,</span><br><span>\t\t\ttimeslots: req.body.timeslots.split(<span>\",\"</span>)</span><br><span>\t\t}</span><br><span>\t}, <span><span>function</span>(<span>err, mission</span>)</span>{</span><br><span>\t\t<span>if</span>(err){</span><br><span>\t\t\tsendJsonRes(res, <span>404</span>, err);</span><br><span>\t\t}<span>else</span>{</span><br><span>\t\t\tsendJsonRes(res, <span>201</span>, mission);</span><br><span>\t\t}</span><br><span>\t})</span><br><span>}</span><br></pre></td></tr></table></figure><p>For subdocuments or facing with a list instead of an array, we probably just retrieve that list and <code>push</code> a new item into the list. Then we just need to <code>&lt;instance&gt;.save()</code> to save the item like this:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br></pre></td><td><pre><span><span>var</span> addReiview = <span><span>function</span>(<span>req, res, mission</span>)</span>{</span><br><span>\tmission.reviews.push({</span><br><span>\t\trating: req.body.rating,</span><br><span>\t\tauthor: req.body.author,</span><br><span>\t\ttext: req.body.text</span><br><span>\t})</span><br><span>\tmission.save(<span><span>function</span>(<span>err, mission</span>)</span>{</span><br><span>\t\t<span>var</span> thisReview;</span><br><span>\t\t<span>if</span>(err){</span><br><span>\t\t\tsendJsonRes(res, <span>404</span>, err);</span><br><span>\t\t}<span>else</span>{</span><br><span>\t\t\tupdateAveRating(mission._id);</span><br><span>\t\t\tthisReview = mission.reviews[mission.reviews.length - <span>1</span>];</span><br><span>\t\t\tsendJsonRes(res, <span>201</span>, thisReview);</span><br><span>\t\t}</span><br><span>\t})</span><br><span>}</span><br></pre></td></tr></table></figure><h2>“PUT” method implementation</h2><p>“PUT” method is similar to “POST” in a way that they both use form data stored in <code>req.body</code>, while one is create from nothing and add to the database, the other is to find an existing one and update part of the information. </p>\n<ul><li>One hack I thought about is to use <code>Object.keys(obj)</code> to obtain the keys from a js object, then using <code>$set</code> in <code>mongo.update()</code> to only update the value in body? <strong>Ideas:</strong> this idea only works when all field are requiring same manipulation from body data. To be more specifically, some data are needed to be processed to feed for later use, such as we add <code>.split(\",\");</code> for tags data, and some fields like “coords” is an array. Thus, if we want to apply more operations on some data, we cannot just treat them in the same way in a for loop</li>\n<li>Or, utilize the the way mongoose model treat model parameters, we can do <code>var newReview = new Review(req.body)</code> to create an instance of “Review” model, then use this to replace the old one?</li>\n</ul><blockquote>\n<p>One important thing to notice is that when we save, we save <strong>parent document!</strong> In our case, we did <code>mission.save(function(err, mission))</code> instead of <code>review.save(...)</code>!</p>\n</blockquote>\n<h2>“DELETE” method implementation</h2><p>“DELETE” method is easier, we only need to find that document by “missionid”, then do <code>Missions.remove(function(err, mission))</code>. For the subdocument, we simply find that subdocument and call remove at the end. The prototype is like:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br></pre></td><td><pre><span><span>// A working prototype without error checking.</span></span><br><span><span>module</span>.exports.reviewsDeleteOne = <span><span>function</span>(<span>req, res</span>)</span>{</span><br><span>\tMissions</span><br><span>\t\t.findById(req.params.missionid)</span><br><span>\t\t.select(<span>\"reviews\"</span>)</span><br><span>\t\t.exec(<span><span>function</span>(<span>err, mission</span>)</span>{</span><br><span>\t\t\t<span>if</span>(err){</span><br><span>\t\t\t\tsendJsonRes(res, <span>404</span>, {</span><br><span>\t\t\t\t\t<span>\"message\"</span>: <span>\"Found no match\"</span></span><br><span>\t\t\t\t})</span><br><span>\t\t\t}</span><br><span>\t\t\tmission.reviews.id(req.params.reviewid).remove();</span><br><span>\t\t\tmission.save(<span><span>function</span>(<span>err, mission</span>)</span>{ <span>// save parent document.</span></span><br><span>\t\t\t\tupdateAveRating(mission._id);</span><br><span>\t\t\t\tsendJsonRes(res, <span>204</span>, <span>null</span>);</span><br><span>\t\t\t})</span><br><span>\t\t})</span><br><span>}</span><br></pre></td></tr></table></figure><h2>Summery</h2><ul><li><p>How to insert an common model instance into mongodb? I mean, since we can’t generate the “_id” by ourselves, then how comes we insert such object into <code>mongo</code>? <strong>Answer:</strong> we need to know the difference between <code>db.missions.save</code> and <code>db.missions.insert</code>, using <code>save</code>, we can simple provide an model instance according to the model schma, while using using <code>insert</code>, we have to write the object exacty the same as the final document! </p>\n</li>\n<li><p>“GET” method implementation? <strong>Answer:</strong> using mongodb query like <code>findById</code> and others to get the document from db, and sometimes we need <code>id</code> to retrieve info from subdocument. Besides, <code>geoNear</code> is handy in mongodb to get displaying documents by distance.</p>\n</li>\n<li><p>Some important places for error checking: </p>\n<ul><li>If argument is in the <code>req.body</code> or <code>req.query</code> or <code>req.params</code>. <strong>if not, return a message in <code>res</code> saying founding no argument in coming request.</strong></li>\n<li>Then given an ID(probably), we may want to search that document in database using <code>getById()</code>, and the callback function contains an <code>error</code> object and a instance object, where the returning instance object indicates whether or not searching database is succeeded or not. <strong>If not, return a message saying object not found in database.</strong></li>\n<li>When we tried to update of create a new document, we may usually use <code>save</code> and <code>create</code>, the callback function contains an error object either, <strong>it indicates whether or not such instance can be created or updated correctly, if the error message appears, it usually dues to the fact that some fields violates the validation rules specified in database schema.</strong></li>\n</ul></li>\n</ul><h2>Tools</h2><ul><li>Unless you fancy adding hundreds of script tags to your pages, you need a build tool to bundle your dependencies. You also need something to <strong>allow NPM packages to work in browsers</strong>. This is where Webpack comes in.</li>\n<li>Add a .gitattributes file and push it to github to overwrite the project type calculated by github, adding <code>*.css linguist-language=Javascript</code> into the file to let a specific file being overwritten.</li>\n</ul>"
		},
		{
			"title": "MEAN全栈开发[第二期-前端实战手记]",
			"link": "http://chocoluffy.com/2016/03/11/MEAN%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91-%E7%AC%AC%E4%BA%8C%E6%9C%9F-%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98%E6%89%8B%E8%AE%B0/",
			"guid": "http://chocoluffy.com/2016/03/11/MEAN全栈开发-第二期-前端实战手记/",
			"pubDate": "2016-03-11T20:10:55.000Z",
			"categories": [
				"javascript",
				"nodejs",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>AirLoft的原型。 第二期， 基于Bootstrap的扁平化设计， 把所有涉及的页面的clickable prototype做出来， 再迁移到express application或者Angular SPA上， 虽然只是前端的prototype， 但是做好一些npm scripts的配置会让前端开发特别的高效和舒服， 也算是在入门了各种炫技的前端展示后， 逐步到一个full-fledged website的过渡。</p>",
			"content": "<p>AirLoft的原型。 第二期， 基于Bootstrap的扁平化设计， 把所有涉及的页面的clickable prototype做出来， 再迁移到express application或者Angular SPA上， 虽然只是前端的prototype， 但是做好一些npm scripts的配置会让前端开发特别的高效和舒服， 也算是在入门了各种炫技的前端展示后， 逐步到一个full-fledged website的过渡。</p>\n<a></a>\n<p><img src=\"http://ww4.sinaimg.cn/large/c5ee78b5gw1f1tkjoatboj21kw0r7aic.jpg\" alt=\"project screenshot\"></p>\n<h2>Difference about MEAN stack</h2><p>Traditional web server like Apache is multi-thread, <strong><em>the key idea about multi-thread is visitors use seperate resources.</em></strong>Like a bank system, it works perfectly fine when the population size is small, while when the size grows more than the resources, you have to queue for resources. (然而当你访问一个网站的时候， 你是不会等的， 你看那个网站响应很慢， 你就退出了). In nodejs, it is single-threaded. 所以你知道现在很多大型的企业架构， 尤其是国内的， 在前几年还特别严重， 一到过年过节流量特别大的时候， 你的网站就会宕机， 因为太多人访问了， 你必须等。所以解决办法是什么， 通常企业就回去买更多的服务器， 或者更新过大的内存， 来扛过流量最大的时候， 可是有一个问题就是， 在流量没有那么大的绝大多数时候， 你的资源被浪费了! </p>\n<p>在单线程的nodejs里面， 有一个非常重要的特性就是必须是非阻塞， 因为默认的情况就是大家都会去同一个center office， 同一个线程， 然而我们不希望前一个的request, 比如request static files or database, 影响到下一个用户， 所以nodejs里面的函数都是异步的。</p>\n<p>Some useful helper libraries like Underscorejs, Mochajs, and Colors(which can add color to the nodejs console log).</p>\n<p>Check out the articles in Evernore, saying that why we don’t want to use the default way of using directory to organize our view static files in Expressjs, but instead use a function-focused way to group the files.</p>\n<p>Mongodbd stores documents as BSON(binary format of JSON). Mongoose like the shell for mongodb, enable us to add data validation on database(schema)</p>\n<p>Traditional way of doing web, is let the server do all the data processing and application logic, then passes HTML out to the browser. While angularjs allows us to pull some data and logic to the browser.(so server only pass the data from database). Since we have V8 in Chrome.</p>\n<p>The difference of Jquery and AngularJS is that Jquery added to the page to provide interactivity, it assume that you have a complete DOM, While angularjs comes earilier to help you form the HTML.</p>\n<p>关于SPA(single page application)的缺点， 尤其在SEO上， search engine only fetches the page layout and it won’t run any javascript, thus those data and contents generated by javascript will be ignored by search engine. <strong><em>the key feature of SPA is that it takes a longer load for first time login, and it can reduce the pressure on server side, since it handle the logic mostly on browser. </em></strong> For example, for a blog website, the blog post entry is for people to read and is expected to show up quitely quickly, is not suitable for SPA, while the admin page can be done in SPA. <strong><em>Thus, for the blog entry, we want the original and traditional method(passing the HTML pages), utilizing Express!</em></strong></p>\n<p>Remeber, Angularjs is not only for SPA, it can also provide rich data interactivity to an static pages.</p>\n<p><strong><em>API-rich means decouple the reliance!!! You don’t contact directly to the database, but instead use API and if API is satisfied, components can be substituted by any other components.</em></strong></p>\n<p>基础的架构是： database\\rest API\\application在同一个server上， 但之后我们通常会把database分开到另外一个server上（avoid fighting for the same resources）.</p>\n<h2>Express</h2><p>When using express, we can configure it to have some options, like which html engine to use, which css preprocessor, and whether to add the support for session;</p>\n<p>We can see in <code>app.js</code> that there are a lot of <code>app.use()</code>, they are middlewares, and the request coming from the application will go through each of them. For example, use <code>app.use(cookieParser());</code> will parse out the cookie information from the request and prepare to be more friendly in controller code. Server side js(app.js) if modified, should let the server stop and restart, but the client-side js or html or css, can just use browser refresh to update on-the-fly. <strong><em>To fix that, we use <code>nodemon</code>, a module that allows auto-reloading when server-side javascript is changed. I have install it globally, so we just need to type <code>nodemon</code> inside the project folder.</em></strong></p>\n<p><code>block content</code> in jade, is the inheritance machanism of HTML layout, we can define some block + <variable name=\"\"> in the parent template, then in each child layout that extends it, the child template will redefine such block, just like in c++\\java, an abstract class.</variable></p>\n<p>We decided to implement MVC inside the Express, like what we did in rails, we route the corresponding URL to controllers(which we created in a new folder).</p>\n<p>Bootstrap is not being processed by node engine, thus we put it under <code>public</code> folder. Inside the <code>layout.jade</code> file, we will include the bootstrap theme and js files we want to use in our project:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></pre></td><td><pre><span>doctype html</span><br><span>html</span><br><span>  head</span><br><span>    # <span><span>set</span> viewport metadata <span>for</span> better display <span>in</span> mobile device.</span><br><span>  \tmeta(<span>name</span>=<span>'viewport'</span>, <span>content</span>=<span>'width=device-width, initial-scale=1.0'</span>)</span><br><span>    title= title</span><br><span>    # <span>before</span> the <span>style</span>.css <span>file</span>, so that we can write <span>style</span> <span>to</span> override <span>or</span> polish the <span>style</span> <span>in</span> bootstrap theme.</span><br><span>    <span>link</span>(rel=<span>'stylesheet'</span>, href=<span>'/bootstrap/css/cerulean.bootstrap.css'</span>)</span><br><span>    <span>link</span>(rel=<span>'stylesheet'</span>, href=<span>'/stylesheets/style.css'</span>)</span><br><span>  <span>body</span></span><br><span>    <span>block</span> <span>content</span></span></span><br></pre></td></tr></table></figure><p>After deciding on the urls we want to use, we will add corresponding controller into the index.js inside the routes folder. since we mainly have two function groups, we use <code>ctrlLocations</code> and <code>ctrlOthers</code> to represent these two main controller files.</p>\n<h2>Jade in Express</h2><p>Let’s start to move the content in view into controller. When we look at the clickable prototype, especially its Jade view pages, we define Javascript object in hash in controller to store the data. <strong><em>We design data structure to hold data for views.</em></strong> Then in view folder, we can do: [1] use <code>=</code> to use that object’s value, or use <code>#{}</code> to <strong><em>insert</em></strong> the value into a string.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span>h1= <span>title</span> </span><br><span>p &amp;nbsp; #{<span>title</span>}</span><br></pre></td></tr></table></figure><blockquote>\n<p>Pay attention to the format when using the programming syntax or inline coding. </p>\n</blockquote>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></pre></td><td><pre><span>&lt;!--注意在用synax的时候要多空<span>4</span>个space--&gt;</span><br><span>.row</span><br><span>    .<span>col</span>-xs-<span>12</span>.<span>col</span>-<span>sm</span>-<span>8</span></span><br><span>        .row.<span>list</span>-group</span><br><span>            each mission in missions</span><br><span>                .<span>col</span>-xs-<span>12</span>.<span>list</span>-group-item</span><br><span>                    h4</span><br><span>                        <span>a</span>(href=<span>'/mission'</span>)= mission.name</span><br><span>                        small &amp;nbsp;</span><br><span>                            - <span>for</span> (var <span>i</span>=<span>0</span>; <span>i</span>&lt;mission.rating; <span>i</span>++)</span><br><span>                                span.glyphicon.glyphicon-<span>star</span></span><br><span>                            - <span>for</span> (var <span>i</span>=mission.rating; <span>i</span>&lt;<span>5</span>; <span>i</span>++)</span><br><span>                                span.glyphicon.glyphicon-<span>star</span>-<span>empty</span></span><br><span>                        span.badge.pull-<span>right</span>.badge-default <span>100</span><span>m</span></span><br><span>                    <span>p</span>.author= mission.author</span><br><span>                    <span>p</span></span><br><span>                        each <span>tag</span> in mission.<span>tags</span></span><br><span>                            span.label.label-warning= <span>tag</span></span><br><span>                            | &amp;nbsp;</span><br></pre></td></tr></table></figure><p>In Jade, we want to use <strong>mixin</strong> as functions inside a jada file and use <code>include</code> to make it reuseable for other file. Like this, we usually put mixin at between <code>extends layout</code> and <code>block content</code>. </p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></pre></td><td><pre><span>mixin outputRating(rating)</span><br><span>  - <span>for</span> (var <span>i</span>=<span>0</span>; <span>i</span>&lt;mission.rating; <span>i</span>++)</span><br><span>    span.glyphicon.glyphicon-star</span><br><span>  - <span>for</span> (var <span>i</span>=mission.rating; <span>i</span>&lt;<span>5</span>; <span>i</span>++)</span><br><span>    span.glyphicon.glyphicon-star-empty</span><br></pre></td></tr></table></figure><figure><table><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span><span>&lt;!--same place, but using `include`--&gt;</span></span><br><span>include _includes/sharedHTMLfunctions</span><br></pre></td></tr></table></figure><p>Here is an example of showing how to render sting to HTML when the textarea has newline character:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></pre></td><td><pre><span>extends layout</span><br><span></span><br><span>block content</span><br><span>\t<span>#banner.page-header</span></span><br><span>\t\t.row</span><br><span>\t\t\t.col-sm-<span>12</span></span><br><span>\t\t\t\th1= title</span><br><span>\t.row</span><br><span>\t\t.col-sm-<span>12</span></span><br><span>\t\t\tp !{(<span>text</span>).<span>replace</span>(/\\n/g, <span>'&lt;br/&gt;'</span>)}</span><br></pre></td></tr></table></figure><p>For now, the data is stored in controller, while in practice, we need database and data model to store the data. But here we are in the right track of fast development, namely, from developing a clickable prototype, to move hard-cored data into controller as variables, and finally put them into database.</p>\n<h2>Heroku</h2><p>Add the <code>engines</code> part at project’s package.json, add the node and npm version on it.</p>\n<p>Add a Procfile, used to declare the process type used by application. we put <code>web: npm start</code> inside the Procfile so that it tells Heroku to tun such web process.</p>\n<p>Use forego to test before push it into production environment. <code>brew install forego</code> to install forego, then do <code>forego start</code> and go to <code>localhost:5000</code> to see the result.</p>\n<p>Then if everything goes fine, from <strong><em>a) engines part b) Profile c) tested under <code>forego</code></em></strong>, then we do <code>heroku create</code> and <code>git push heroku master</code> to push the local git repo to the remote heroku container. Then <code>heroku open</code> to open that url.</p>\n<p>Terminology: <strong>Dynos</strong> are isolated, virtualized Unix containers, that provide the environment required to run an application. Generally, if you deploy an application for the first time, Heroku will run 1 web dyno automatically. In other words, it will boot a dyno, load it with your slug, and execute the command you’ve associated with the web process type in your Procfile. <strong>So, it mainly is about scaling, if we have more dynos, we will have more resources. And we got that 1 dyno for free.</strong> we can type in <code>heroku ps</code> to check which dyno is running which process and for this command, <code>heroku ps:scale web=3 queue=2</code>, it means that we can start 5 dynos, 3 for the web and 2 for the queue process types.</p>\n<h2>Bootstrap</h2><p>in Bootstrap, there is always 12 columns, and you can define how many columns you want to use in device, <code>col-sm-6</code> means that element will take up 6 columns on device of size sm <strong>and larger.</strong> </p>\n<ul><li>xs: phone</li>\n<li>sm: tablets</li>\n<li>md: laptop</li>\n<li>lg: external monitors</li>\n</ul><p><code>&lt;div class=\"col-xs-12 col-sm-6\"&gt;&lt;/div&gt;</code> means it will take the full width in phone screen while take only half in tablets or larger.</p>\n<p>In Jade, in order to put plain text, we need to use pipe at front.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></pre></td><td><pre><span>ul.nav.navbar-nav.navbar-<span>right</span></span><br><span>    li</span><br><span>        <span>a</span>(href=<span>'#'</span>)</span><br><span>            span.glyphicon.glyphicon-user</span><br><span>            |  Sign Up</span><br><span>    li</span><br><span>        <span>a</span>(href=<span>'#'</span>)</span><br><span>            span.glyphicon.glyphicon-<span>log</span>-<span>in</span></span><br><span>            |  Login</span><br></pre></td></tr></table></figure><p>When dealing with <code>block content</code>, we should note that if some elements are not contrained by css, then they will be strethed to have full width of screen. what we did now is do wrap the content with a <code>div.container</code> so that we can apply css on the container easily.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span><span>div</span><span>.container</span></span><br><span>  block <span>content</span></span><br></pre></td></tr></table></figure><p>现在的一个主要问题是， 我知道布局是什么样子的， 但是我不知道应该怎么写？when to use <code>.row</code> or <code>.page-header</code>. </p>\n<ul><li><strong>row. Rows must be placed within a .container (fixed-width) or .container-fluid (full-width) for proper alignment and padding. </strong></li>\n<li>Use rows to create horizontal groups of columns.</li>\n<li>Content should be placed within columns, and only columns may be immediate children of rows.<strong><em><code>col-</code> is the direct child element for <code>row</code></em></strong></li>\n<li>Actually <code>.page-header</code> just applies some of its default styling options to the element with that class. In practice, we find that the element with that class will be margined from normal element. </li>\n</ul><p>We can download the cutomized bootstrap theme from <a href=\"http://getbootstrap.com/customize/\" target=\"_blank\" rel=\"external\">the website</a>, say it I only want to use the <code>glyphicon</code> icon from Bootstrap, then I can just check that box and download it, then after unzipping the file, we include the file under the css part and <strong>inlcude the css tag inside the html</strong>, then it works fine! Hooray! In this project, I mainly use <code>glyphicon-user</code>, <code>glyphicon-fire</code> and <code>glyphicon-chevron-left</code> for navigation.</p>\n<p>Using <a href=\"https://github.com/nicinabox/superslides\" target=\"_blank\" rel=\"external\">superslides</a> to achieve a full-screen images scrolling animation. pretty amazing effects.</p>\n<p>Use <code>.panel</code> for inner component positioning.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span>   <span>.panel</span><span>.panel-primary</span></span><br><span><span>.panel-heading</span></span><br><span>\t<span>h2</span><span>.panel-title</span> Training Time</span><br><span><span>.panel-body</span></span><br><span>\t<span>p</span> March <span>15</span> - March <span>17</span>: <span>7</span>:<span>00</span> am - <span>7</span>:<span>00</span> pm</span><br><span>\t<span>p</span> March <span>21</span> - March <span>23</span>: <span>7</span>:<span>00</span> am - <span>7</span>:<span>00</span> pm</span><br></pre></td></tr></table></figure><h2>Additional reference</h2><p>How to undo the <code>git add &lt;filename&gt;</code> before <code>git commit</code>. Use <code>git reset &lt;filename&gt;</code>. Include <code>node_modules</code> into <code>.gitignore</code> so that it won’t be commited to github. Use</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span><span>#You</span> can create your own <span>.gitignore</span> which ignores itself. Create <span>a</span> <span>.gitignore</span> with this two records:</span><br><span><span>.gitignore</span></span><br><span>node_modules</span><br></pre></td></tr></table></figure><p>在<a href=\"http://bootswatch.com/\" target=\"_blank\" rel=\"external\">free bootstrap themes</a>下载bootstrap theme到public folder.</p>\n<p><a href=\"http://stackoverflow.com/questions/33549178/best-practices-for-loading-videos-on-a-web-page\" target=\"_blank\" rel=\"external\">Like Airbnb, how to load video at the background of a website</a>, using progressive loading or ?</p>\n<p>使用nodemon来监听server-side js文件的改动来自动更新server， 使用browser-sync来监听各种css file的改动。有两种模式， 一种是通过直接创建一个server来host本地的static file, 另一种模式是通过代理另一个服务器， 比如php server, rails webbrick server, python simplehttpserver, nodejs server都可以的!!!!</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span>browser-<span>sync</span> start --proxy=<span>'localhost:3000'</span> --<span>files</span> <span>'app_server/views/*.jade, app_server/controllers/*.js, public/stylesheets/*.css'</span></span><br><span></span><br><span>browser-<span>sync</span> start --server --<span>files</span> <span>'app_server/views/*.jade, app_server/controllers/*.js, public/stylesheets/*.css'</span></span><br></pre></td></tr></table></figure><p>由于我在nodejs里面设置了服务器的端口是3000， 那么通过让browser-sync监听这个端口并创建在3001的代理， 我可以在<code>localhost:3001</code>上面得到自动更新的网页!!</p>"
		},
		{
			"title": "MEAN全栈开发[第一期-前端布局]",
			"link": "http://chocoluffy.com/2016/03/06/MEAN%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91-%E7%AC%AC%E4%B8%80%E6%9C%9F-%E5%89%8D%E7%AB%AF%E5%B8%83%E5%B1%80/",
			"guid": "http://chocoluffy.com/2016/03/06/MEAN全栈开发-第一期-前端布局/",
			"pubDate": "2016-03-06T14:38:41.000Z",
			"categories": [
				"javascript",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>AirLoft的原型。一个sharing economy的网站。 Loft是阁楼的意思， 每个心中那个静静守候一些秘密和癖好的地方。 有些情感， 只能在尘封的铁门后诉说， 就像有些话， 只讲给某个人听。厌倦了某些网站没有审美的UI， 也趁着青春轻狂， 去改变吧。第一期， 记录我前端页面开发的一些手记， 后面慢慢过渡到数据库和后台API设计。</p>",
			"content": "<p>AirLoft的原型。一个sharing economy的网站。 Loft是阁楼的意思， 每个心中那个静静守候一些秘密和癖好的地方。 有些情感， 只能在尘封的铁门后诉说， 就像有些话， 只讲给某个人听。厌倦了某些网站没有审美的UI， 也趁着青春轻狂， 去改变吧。第一期， 记录我前端页面开发的一些手记， 后面慢慢过渡到数据库和后台API设计。</p>\n<a></a>\n<h2>前言</h2><p>最近在做一个sharing economy的网站，在参考了大部分现有网站的UI的样式后， 我们感觉非常的不满😂(当然像quora这种属于知识信息密度特别高的网站使用文本密集的形势还说的过去)， 但是像airbnb还有携程这种大型的peer sharing的网站， 如何可以从第一屏就吸引到用户是一个很重要的问题。直接上图看看：<br>首先是<a href=\"https://www.airbnb.ca/\" target=\"_blank\" rel=\"external\">airbnb</a>的网站：<br><img src=\"http://ww1.sinaimg.cn/large/c5ee78b5gw1f1mrezw5z0j21kw0t9dqn.jpg\" alt=\"airbnb website\"><br>airbnb在网站的第一屏是用一段视频来当做背景的， 非常惊艳， 但是第一屏没有满屏是什么意思？是想吸引我们可以往下滚嘛？但是这种样式让我非常不舒服， 明明有非常好的创意， 为什么不像这个<a href=\"http://thenewcode.com/samples/polina.html\" target=\"_blank\" rel=\"external\">thenewcode.com</a>一样使用高清全屏的视频来当做网页背景呢， 很惊艳对不对!!</p>\n<p>再看一下<a href=\"http://www.ctrip.com/#ctm_ref=nb_cn_top\" target=\"_blank\" rel=\"external\">携程</a>的网站， 感觉还是滞留在上个世纪的UI。<br><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1f1mrhyoxpvj21kw0t7qiu.jpg\" alt=\"携程website\"><br>于是， 也是出于对颜值的追求，我决定尝试使用轮播在第二屏的网站展示页面来展示各个兴趣小组（比如一起做早餐吃早餐啦， 一起go hiking啦， 一起复习期末考写作业的兴趣小组啦）</p>\n<p>考虑到完整项目的时间紧迫， 就不准备在前端的js的代码上花太多时间， 毕竟后面还有转移到express的jade模版， 然后最后还要用angularjs来重写。 于是我就在找各类比较好的carousel的js插件， 在比较了几个的表现之后， 还是<a href=\"https://github.com/nicinabox/superslides\" target=\"_blank\" rel=\"external\">superslides</a>最得我心。废话不多说， 直接上实例代码：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br></pre></td><td><pre><span><span>&lt;!DOCTYPE html&gt;</span></span><br><span><span>&lt;<span>html</span>&gt;</span></span><br><span><span>&lt;<span>head</span>&gt;</span></span><br><span>  <span>&lt;<span>meta</span> <span>charset</span>=<span>\"utf-8\"</span>&gt;</span></span><br><span>  <span>&lt;<span>title</span>&gt;</span>Superslides - A fullscreen slider for jQuery<span>&lt;/<span>title</span>&gt;</span></span><br><span>  <span>&lt;<span>link</span> <span>rel</span>=<span>\"stylesheet\"</span> <span>href</span>=<span>\"../dist/stylesheets/superslides.css\"</span>&gt;</span></span><br><span><span>&lt;/<span>head</span>&gt;</span></span><br><span><span>&lt;<span>body</span>&gt;</span></span><br><span>  <span>&lt;<span>div</span> <span>id</span>=<span>\"slides\"</span>&gt;</span></span><br><span>    <span>&lt;<span>div</span> <span>class</span>=<span>\"slides-container\"</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"images/people.jpeg\"</span> <span>alt</span>=<span>\"Cinelli\"</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"images/surly.jpeg\"</span> <span>width</span>=<span>\"1024\"</span> <span>height</span>=<span>\"682\"</span> <span>alt</span>=<span>\"Surly\"</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"images/cinelli-front.jpeg\"</span> <span>width</span>=<span>\"1024\"</span> <span>height</span>=<span>\"683\"</span> <span>alt</span>=<span>\"Cinelli\"</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"images/affinity.jpeg\"</span> <span>width</span>=<span>\"1024\"</span> <span>height</span>=<span>\"685\"</span> <span>alt</span>=<span>\"Affinity\"</span>&gt;</span></span><br><span>    <span>&lt;/<span>div</span>&gt;</span></span><br><span></span><br><span>    <span>&lt;<span>nav</span> <span>class</span>=<span>\"slides-navigation\"</span>&gt;</span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"next\"</span>&gt;</span>Next<span>&lt;/<span>a</span>&gt;</span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"prev\"</span>&gt;</span>Previous<span>&lt;/<span>a</span>&gt;</span></span><br><span>    <span>&lt;/<span>nav</span>&gt;</span></span><br><span>  <span>&lt;/<span>div</span>&gt;</span></span><br><span></span><br><span>  <span>&lt;<span>script</span> <span>src</span>=<span>\"http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span>  <span>&lt;<span>script</span> <span>src</span>=<span>\"javascripts/jquery.easing.1.3.js\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span>  <span>&lt;<span>script</span> <span>src</span>=<span>\"javascripts/jquery.animate-enhanced.min.js\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span>  <span>&lt;<span>script</span> <span>src</span>=<span>\"../dist/jquery.superslides.js\"</span> <span>type</span>=<span>\"text/javascript\"</span> <span>charset</span>=<span>\"utf-8\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span>  <span>&lt;<span>script</span>&gt;</span><span></span><br><span>    $(<span>'#slides'</span>).superslides({</span><br><span>      animation: <span>'fade'</span></span><br><span>    });</span><br><span>  </span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;/<span>body</span>&gt;</span></span><br><span><span>&lt;/<span>html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>忽略其他的不管， 如果我们希望引入superslides的功效， 我们只需要添加这几个tag:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>&lt;!--css--&gt;</span></span><br><span><span>&lt;<span>link</span> <span>rel</span>=<span>\"stylesheet\"</span> <span>href</span>=<span>\"../dist/stylesheets/superslides.css\"</span>&gt;</span></span><br><span></span><br><span><span>&lt;!--js--&gt;</span></span><br><span><span>&lt;<span>script</span> <span>src</span>=<span>\"http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br><span><span>&lt;<span>script</span> <span>src</span>=<span>\"../dist/jquery.superslides.js\"</span> <span>type</span>=<span>\"text/javascript\"</span> <span>charset</span>=<span>\"utf-8\"</span>&gt;</span><span></span><span>&lt;/<span>script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意jquery的引入要在superslides的前面， 来保证superslides在引用的时候可以用到jquery里面的定义的函数。</p>\n<p>在添加了css和js之后， 我们就可以来创建全屏图片轮播的html结构了， 官方推荐的是在<code>&lt;div id=\"slides\"&gt;</code>里面放一个div里面放各种img， 或者也可以使用一个<code>&lt;li&gt;</code>来分开img和div来在后期分别写样式和定位， 我在我的项目中使用的就是后者， 比如：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br></pre></td><td><pre><span><span>&lt;<span>div</span> <span>id</span>=<span>\"slides\"</span>&gt;</span></span><br><span>  <span>&lt;<span>ul</span> <span>class</span>=<span>\"slides-container\"</span>&gt;</span></span><br><span>    <span>&lt;<span>li</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"http://flickholdr.com/1000/800\"</span> <span>alt</span>=<span>\"\"</span>&gt;</span></span><br><span>      <span>&lt;<span>div</span> <span>class</span>=<span>\"container\"</span>&gt;</span></span><br><span>        Slide one</span><br><span>      <span>&lt;/<span>div</span>&gt;</span></span><br><span>    <span>&lt;/<span>li</span>&gt;</span></span><br><span>    <span>&lt;<span>li</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"http://flickholdr.com/1000/800/space\"</span> <span>alt</span>=<span>\"\"</span>&gt;</span></span><br><span>      <span>&lt;<span>div</span> <span>class</span>=<span>\"container\"</span>&gt;</span></span><br><span>        Slide two</span><br><span>      <span>&lt;/<span>div</span>&gt;</span></span><br><span>    <span>&lt;/<span>li</span>&gt;</span></span><br><span>    <span>&lt;<span>li</span>&gt;</span></span><br><span>      <span>&lt;<span>img</span> <span>src</span>=<span>\"http://flickholdr.com/1000/800/tech\"</span> <span>alt</span>=<span>\"\"</span>&gt;</span></span><br><span>      <span>&lt;<span>div</span> <span>class</span>=<span>\"container\"</span>&gt;</span></span><br><span>        Slide three</span><br><span>      <span>&lt;/<span>div</span>&gt;</span></span><br><span>    <span>&lt;/<span>li</span>&gt;</span></span><br><span>  <span>&lt;/<span>ul</span>&gt;</span></span><br><span>  <span>&lt;<span>nav</span> <span>class</span>=<span>\"slides-navigation\"</span>&gt;</span></span><br><span>    <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"next\"</span>&gt;</span>Next<span>&lt;/<span>a</span>&gt;</span></span><br><span>    <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"prev\"</span>&gt;</span>Previous<span>&lt;/<span>a</span>&gt;</span></span><br><span>  <span>&lt;/<span>nav</span>&gt;</span></span><br><span><span>&lt;/<span>div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>由于我的网站背景颜色是暗色系的， 我添加了<code>reveselay</code>和<code>overlay</code>来创建两个mask来写出渐变渐出的效果， 这样可以很好的和背景颜色混为一体。</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br></pre></td><td><pre><span><span>&lt;<span>div</span> <span>class</span>=<span>\"section\"</span> <span>id</span>=<span>\"android\"</span>&gt;</span></span><br><span>  <span>&lt;<span>div</span> <span>class</span>=<span>\"containerrow\"</span>&gt;</span></span><br><span>    <span>&lt;<span>div</span> <span>id</span>=<span>\"slides\"</span>&gt;</span></span><br><span>      <span>&lt;<span>ul</span> <span>class</span>=<span>\"slides-container\"</span>&gt;</span></span><br><span>        <span>&lt;<span>li</span>&gt;</span></span><br><span>          <span>&lt;<span>img</span> <span>src</span>=<span>\"./image/desk.jpg\"</span> <span>alt</span>=<span>\"\"</span>&gt;</span></span><br><span>          <span>&lt;<span>div</span> <span>class</span>=<span>\"reverselay\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>          <span>&lt;<span>div</span> <span>class</span>=<span>\"overlay\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>          <span>&lt;<span>div</span> <span>class</span>=<span>\"mainbadget\"</span>&gt;</span></span><br><span>              <span>&lt;<span>h5</span>&gt;</span></span><br><span>                <span>&lt;<span>span</span> <span>class</span>=<span>\"glyphicon glyphicon-user\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span>&amp;nbsp;134 &amp;nbsp;&amp;nbsp;</span><br><span>                <span>&lt;<span>span</span> <span>class</span>=<span>\"glyphicon glyphicon-fire\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span>&amp;nbsp;3440</span><br><span>              <span>&lt;/<span>h5</span>&gt;</span></span><br><span>          <span>&lt;/<span>div</span>&gt;</span></span><br><span>          <span>&lt;<span>div</span> <span>class</span>=<span>\"text-container\"</span>&gt;</span></span><br><span>            <span>&lt;<span>div</span> <span>class</span>=<span>\"maintitle\"</span>&gt;</span></span><br><span>               <span>&lt;<span>a</span> <span>href</span>=<span>\"\"</span>&gt;</span>Morning Call<span>&lt;/<span>a</span>&gt;</span></span><br><span>            <span>&lt;/<span>div</span>&gt;</span></span><br><span>            <span>&lt;<span>div</span> <span>class</span>=<span>\"maintext\"</span>&gt;</span></span><br><span>              <span>&lt;<span>p</span>&gt;</span>Join our breakfast cooking club for fresh pancakes and sunshine!</span><br><span>              Meet your friends here and enjoy every piece of buttered toast. <span>&lt;<span>a</span> <span>href</span>=<span>\"\"</span>&gt;</span>See more.<span>&lt;/<span>a</span>&gt;</span><span>&lt;/<span>p</span>&gt;</span></span><br><span>            <span>&lt;/<span>div</span>&gt;</span></span><br><span>          <span>&lt;/<span>div</span>&gt;</span>    </span><br><span>        <span>&lt;/<span>li</span>&gt;</span></span><br><span>      <span>&lt;/<span>ul</span>&gt;</span></span><br><span></span><br><span>      <span>&lt;<span>nav</span> <span>class</span>=<span>\"slides-navigation\"</span>&gt;</span></span><br><span>        <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"prev\"</span>&gt;</span><span>&lt;<span>span</span> <span>class</span>=<span>\"glyphicon glyphicon-chevron-left\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span><span>&lt;/<span>a</span>&gt;</span></span><br><span>        <span>&lt;<span>a</span> <span>href</span>=<span>\"#\"</span> <span>class</span>=<span>\"next\"</span>&gt;</span><span>&lt;<span>span</span> <span>class</span>=<span>\"glyphicon glyphicon-chevron-right\"</span>&gt;</span><span>&lt;/<span>span</span>&gt;</span><span>&lt;/<span>a</span>&gt;</span></span><br><span>      <span>&lt;/<span>nav</span>&gt;</span></span><br><span>    <span>&lt;/<span>div</span>&gt;</span></span><br><span>    </span><br><span>    <span>&lt;<span>div</span> <span>id</span>=<span>\"slider-control\"</span>&gt;</span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#react\"</span> <span>class</span>=<span>\"active\"</span>&gt;</span></span><br><span>        <span>&lt;<span>div</span> <span>class</span>=<span>\"dot\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>      <span>&lt;/<span>a</span>&gt;</span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#intro\"</span>&gt;</span></span><br><span>        <span>&lt;<span>div</span> <span>class</span>=<span>\"dot\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>      <span>&lt;/<span>a</span>&gt;</span></span><br><span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#native\"</span>&gt;</span></span><br><span>        <span>&lt;<span>div</span> <span>class</span>=<span>\"dot\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>      <span>&lt;/<span>a</span>&gt;</span></span><br><span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#touch\"</span>&gt;</span></span><br><span>        <span>&lt;<span>div</span> <span>class</span>=<span>\"dot\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>      <span>&lt;/<span>a</span>&gt;</span></span><br><span></span><br><span>      <span>&lt;<span>a</span> <span>href</span>=<span>\"#android\"</span>&gt;</span></span><br><span>        <span>&lt;<span>div</span> <span>class</span>=<span>\"dot\"</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span></span><br><span>      <span>&lt;/<span>a</span>&gt;</span></span><br><span>    <span>&lt;/<span>div</span>&gt;</span></span><br><span>  <span>&lt;/<span>div</span>&gt;</span></span><br><span><span>&lt;/<span>div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意我这里的<code>text-container</code>, <code>maintitle</code>, <code>maintext</code>都是用来创建overlay在图片上面的文字， 分离出来比较方便定位。最后记得要初始化js：</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></pre></td><td><pre><span><span>&lt;<span>script</span>&gt;</span><span></span><br><span>  $(<span>'#slides'</span>).superslides({</span><br><span>    animation: <span>'fade'</span>,</span><br><span>    play: <span>'8000'</span></span><br><span>  });</span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>还有很多的功能选项， 在<a href=\"https://github.com/nicinabox/superslides\" target=\"_blank\" rel=\"external\">主页</a>可以查看到最全的功能配置，也可以参考他的<a href=\"http://archive.nicinabox.com/superslides/#1\" target=\"_blank\" rel=\"external\">实例页面</a> 那就搞定了! 最后附上成品的gif:<br><img src=\"https://giant.gfycat.com/WetLongHapuka.gif\" alt=\"project gif\"></p>"
		},
		{
			"title": "Ajax(with Jquery) on Nodejs server",
			"link": "http://chocoluffy.com/2016/02/20/Ajax-with-Jquery-on-Nodejs-server/",
			"guid": "http://chocoluffy.com/2016/02/20/Ajax-with-Jquery-on-Nodejs-server/",
			"pubDate": "2016-02-20T19:37:25.000Z",
			"categories": [
				"javascript",
				"nodejs",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>Nodejs的第一个上手小项目， 就是尝试自己在本地的页面来发送Ajax请求， 并且通过nodejs的json文件返回后以比较优雅的前端样式呈现出来。 算是再一次复习了Bootstrap， fontawesome库的调用， 以及一些jquery的语法。 仔细回想， 其实nodejs的后端开发和rails\\django的router的本质都是一样的， 以前在还没有理解实质的时候就上手实战， 现在慢慢理解了才能够融会贯通， 现在的开发速度大大进步了。 同时也学会了如何允许CORS的请求， 和正则匹配的部分细节。<br>",
			"content": "<p>Nodejs的第一个上手小项目， 就是尝试自己在本地的页面来发送Ajax请求， 并且通过nodejs的json文件返回后以比较优雅的前端样式呈现出来。 算是再一次复习了Bootstrap， fontawesome库的调用， 以及一些jquery的语法。 仔细回想， 其实nodejs的后端开发和rails\\django的router的本质都是一样的， 以前在还没有理解实质的时候就上手实战， 现在慢慢理解了才能够融会贯通， 现在的开发速度大大进步了。 同时也学会了如何允许CORS的请求， 和正则匹配的部分细节。<br><a></a></p>\n<p><img src=\"https://zippy.gfycat.com/FancyWeeBrontosaurus.gif\" alt=\"project gif\"></p>\n<h2>Requirements</h2><p>Requesting 127.0.0.1:3000 should give your index page (with CSS and JS). For the subsequent requests, you should use AJAX to send requests to the Node server and update only some parts of the page with the response data. Ideally, you should return JSON data as a response and then format that using Javascript.</p>\n<h2>Ongoing notes</h2><ul><li><p>how to use Ajax to request the data instead of using url request to node server? <strong><em>Main idea is that to use <code>$.getJSON(\"http://127.0.0.1:3000/favs.json\", function(...){...}</code> to send out the Ajax request, and set the nodejs script to be able to respond such json file request and properly handle CORS problem. The things left will be just styling and formatted retrieved information and display.</em></strong></p>\n</li>\n<li><p>nodejs. You might use Node.js to connect to a database (returning a result set from a query, say, or updating a record); deliver HTML, XML, or JSON content; connect to local files; or serve up static web pages like Apache or another web server.</p>\n</li>\n<li><p>ajax. The mechanism for sending data to and retrieving data from the server with Ajax is the XMLHttpRequest object. So, now that we have an XMLHttpRequest object created, what do we do with it? We use it to make HTTP requests. To do so, we initialize the object with the open() method, which takes three arguments. Like <code>xmlhttp.open(\"GET\",\"Demo.xml\",true);</code>.</p>\n<ul><li>HEAD. <code>xmlhttp.open(\"HEAD\",\"Demo\",true);</code> and <code>xmlhttp.send(null)</code>.</li>\n<li>GET. <code>xmlhttp.open(\"GET\",\"Demo?FirstName=Nat&amp;LastName=Dunn\",true);</code>, the last argument is choose for true(asynchronous) or false(synchronous). The difference is that for synchronous version, browser has to wait for a response. The code below shows how to use Ajax solely to listen to the content change.</li>\n</ul></li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></pre></td><td><pre><span></span><br><span><span>&lt;<span>script</span> <span>type</span>=<span>\"text/javascript\"</span>&gt;</span><span></span><br><span>    <span><span>function</span> <span>start</span>(<span></span>) </span>{</span><br><span>        <span>var</span> xmlhttp = <span>new</span> XMLHttpRequest();</span><br><span>        <span>var</span> contentDiv = <span>document</span>.getElementById(<span>\"Content\"</span>);</span><br><span> </span><br><span>        xmlhttp.open(<span>\"GET\"</span>, <span>\"Demo?FirstName=Nat&amp;LastName=Dunn\"</span>, <span>true</span>);</span><br><span>        xmlhttp.onreadystatechange = <span><span>function</span>(<span></span>) </span>{ <span>// handle Ajax response.</span></span><br><span>            <span>if</span> (xmlhttp.readyState == <span>4</span> &amp;&amp; xmlhttp.status == <span>200</span>) {</span><br><span>                contentDiv.innerHTML = xmlhttp.responseText;</span><br><span>            }</span><br><span>        }</span><br><span>        xmlhttp.send(<span>null</span>);</span><br><span>    }</span><br><span> </span><br><span>    observeEvent(<span>window</span>, <span>\"load\"</span>, <span><span>function</span>(<span></span>) </span>{</span><br><span>        <span>var</span> btn = <span>document</span>.getElementById(<span>\"btnStart\"</span>);</span><br><span>        observeEvent(btn, <span>\"click\"</span>, start);</span><br><span>    });</span><br><span></span><span>&lt;/<span>script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>Ajax in jquery. In general, Ajax does not work across domains. Exceptions are services that provide JSONP (JSON with Padding) support, which allow limited cross-domain functionality. JQuery provides Ajax support that abstracts away painful browser differences. It offers both a full-featured $.ajax() method, and simple convenience methods such as $.get(), $.getScript(), $.getJSON(), $.post(), and $.fn.load(). A working example of using Ajax of pulling image data from Flick referring <a href=\"http://www.w3school.com.cn/jquery/ajax_getjson.asp\" target=\"_blank\" rel=\"external\">this post</a></p>\n</li>\n<li><p>How to avoid CORS(cross-origin resources sharing) error, refer to <a href=\"http://www.bennadel.com/blog/2327-cross-origin-resource-sharing-cors-ajax-requests-between-jquery-and-node-js.htm\" target=\"_blank\" rel=\"external\">this post</a>. <strong><em>Main idea is that at the nodejs server part, we allow some origin and some type of content being CORS, thus we can request such resources at client part, which in this case in my own browser.</em></strong></p>\n</li>\n<li><p>How to regex all the href links inside a tweet? Especially how to do that in javascript? </p>\n</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></pre></td><td><pre><span><span>// tweet here is a JSON object</span></span><br><span><span>var</span> tweetString = <span>JSON</span>.stringify(tweet);</span><br><span><span>var</span> regex = <span>/(https?:\\/\\/.*?)(\"|\\s)/g</span>;</span><br><span><span>var</span> matchlst = [];</span><br><span>tweetString.replace(regex, <span><span>function</span>(<span>a, b, c, d</span>)</span>{</span><br><span>\t<span>if</span>(a.slice(-<span>1</span>)==<span>'\"'</span>){</span><br><span>\t\ta = a.slice(<span>0</span>, -<span>1</span>);</span><br><span>\t}</span><br><span>\tmatchlst.push(a);</span><br><span>})</span><br></pre></td></tr></table></figure><p><strong><em>Main idea is that we first make a JSON object into a string, then we can do regex match on a string. we use //g to indicate that it is search globally. And then for those valid match, we trim out the trailing quote then store it into a list for later formatting use. </em></strong>. Note that we should make full use of the flag option provided with regex matching, refer to <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\" target=\"_blank\" rel=\"external\">this post</a>. For example, <code>/.../g</code> is for global match, <code>/.../i</code> is for case-insensitive match.</p>\n<ul><li>How to use Jquery to construct <code>div</code> or <code>a</code> elements? refer to <a href=\"http://stackoverflow.com/questions/867916/creating-a-div-element-in-jquery\" target=\"_blank\" rel=\"external\">this post</a>, simply do the following: <strong><em>Here I make use of the Bootstrap alert styling!</em></strong></li>\n</ul><figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span>$<span>(<span>\"&lt;div&gt;\"</span>)</span>.addClass<span>('alert alert-warning')</span>.html<span>(<span>\"&lt;strong&gt;Warning!&lt;/strong&gt; Such user or tweet does not exist. Please enter a valid query.\"</span>)</span>.prependTo<span>(query_list)</span>;</span><br></pre></td></tr></table></figure><ul><li>Avoid the <code>submit</code> event cause a page redirection or refresh? simply add a <code>return false</code> at the end of the submit function. Here is the submit function I wrote to process the info after AJAX from nodejs server. Note that my nodejs server host at <code>http://127.0.0.1:3000/</code>.</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br></pre></td><td><pre><span>$(<span>\"#queryform\"</span>).submit(<span><span>function</span>(<span></span>)</span>{</span><br><span>    \t\temptyAll();</span><br><span>    \t\t<span>var</span> searchval = $(<span>\"#search\"</span>).val();</span><br><span>    \t\t<span>console</span>.log(searchval);</span><br><span>    \t\t$(<span>\"#list ul\"</span>).addClass(<span>\"unseen\"</span>);</span><br><span>    \t\t<span>var</span> query_list = $(<span>\"#query\"</span>);</span><br><span>    \t\t<span>var</span> nameHash = {};</span><br><span>    \t\t<span>var</span> tweetidHash = {}; </span><br><span>\t    \t$.getJSON(<span>\"http://127.0.0.1:3000/favs.json\"</span>, <span><span>function</span>(<span>tweets</span>)</span>{</span><br><span>\t\t\t\t$.each(tweets, <span><span>function</span>(<span>i,tweet</span>)</span>{</span><br><span>\t\t\t\t\tnameHash[tweet.user.screen_name] = tweet;</span><br><span>\t\t\t\t\ttweetidHash[tweet.id_str] = tweet;</span><br><span>\t\t\t\t});</span><br><span>\t\t\t\t<span>if</span>(<span>Object</span>.keys(nameHash).indexOf(searchval)&gt;=<span>0</span>){</span><br><span>\t\t\t\t\t<span>var</span> formattedText = <span>\"&lt;strong&gt;User screen name: &lt;/strong&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += searchval + <span>\"&lt;br&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += <span>\"&lt;strong&gt;Tweet: &lt;/strong&gt;&lt;br&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += <span>\"&lt;pre&gt;&lt;code&gt;\"</span> + <span>JSON</span>.stringify(nameHash[searchval], <span>null</span>, <span>4</span>) + <span>\"&lt;/code&gt;&lt;/pre&gt;\"</span>;</span><br><span>\t\t\t\t\t$(<span>\"&lt;p&gt;\"</span>).html(formattedText).prependTo(query_list);</span><br><span>\t\t\t\t}</span><br><span>\t\t\t\t<span>else</span> <span>if</span>(<span>Object</span>.keys(tweetidHash).indexOf(searchval)&gt;=<span>0</span>){</span><br><span>\t\t\t\t\t<span>var</span> formattedText = <span>\"&lt;strong&gt;Tweet ID: &lt;/strong&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += searchval + <span>\"&lt;br&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += <span>\"&lt;strong&gt;Tweet: &lt;/strong&gt;&lt;br&gt;\"</span>;</span><br><span>\t\t\t\t\tformattedText += <span>\"&lt;pre&gt;&lt;code&gt;\"</span> + <span>JSON</span>.stringify(tweetidHash[searchval], <span>null</span>, <span>4</span>) + <span>\"&lt;/code&gt;&lt;/pre&gt;\"</span>;</span><br><span>\t\t\t\t\t$(<span>\"&lt;p&gt;\"</span>).html(formattedText).prependTo(query_list);</span><br><span>\t\t\t\t}</span><br><span>\t\t\t\t<span>else</span>{\t\t</span><br><span>\t\t\t\t\t$(<span>\"&lt;div&gt;\"</span>).addClass(<span>'alert alert-warning'</span>).html(<span>\"&lt;strong&gt;Warning!&lt;/strong&gt; Such user or tweet does not exist. Please enter a valid query.\"</span>).prependTo(query_list);</span><br><span></span><br><span>\t\t\t\t}</span><br><span>\t\t\t});</span><br><span>\t</span><br><span>\t\t\t$(<span>\"#query\"</span>).removeClass(<span>\"unseen\"</span>);</span><br><span>\t\t\t$(<span>\"#query\"</span>).addClass(<span>\"seen\"</span>); </span><br><span>\t\t\t<span>return</span> <span>false</span>; </span><br><span>    \t});</span><br></pre></td></tr></table></figure><ul><li>Some JS tricks:<ul><li><code>if...in...</code> equivalent type in JS as in python. use <code>Array.indexOf(element)&gt;=0</code> to know that if such element exist in this array.</li>\n<li>Get the keys array of a Hash. <code>Object.keys(hash)</code>.</li>\n<li>Get the last character from a string. <code>string.slice(-1)</code>.</li>\n<li>Trim out the last character from a string. <code>string = string.slice(0, -1)</code>.</li>\n<li>Use Jquery to get the value from submitted form. </li>\n</ul></li>\n</ul>"
		},
		{
			"title": "Online messege sending后端C实现版",
			"link": "http://chocoluffy.com/2016/02/18/Online-messege-sending%E5%90%8E%E7%AB%AFC%E5%AE%9E%E7%8E%B0%E7%89%88/",
			"guid": "http://chocoluffy.com/2016/02/18/Online-messege-sending后端C实现版/",
			"pubDate": "2016-02-18T22:51:30.000Z",
			"categories": [
				"C",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>原型是最近一门课的作业， 这是我在过程中记下的一些手记心得， 都是我认为是值得关注的地方。 未来会把这些后端函数加入TCP协议， 更贴近实战使用吧。基础的数据结构主要是链表， 算是用C自己再复习一遍链表实现。算法嘛？没有算法😂不需要考虑性能也就没有考虑算法优化咯。</p>",
			"content": "<p>原型是最近一门课的作业， 这是我在过程中记下的一些手记心得， 都是我认为是值得关注的地方。 未来会把这些后端函数加入TCP协议， 更贴近实战使用吧。基础的数据结构主要是链表， 算是用C自己再复习一遍链表实现。算法嘛？没有算法😂不需要考虑性能也就没有考虑算法优化咯。</p>\n<a></a>\n<p><img src=\"http://ww3.sinaimg.cn/large/c5ee78b5gw1f149fxx25oj21360w6n5z.jpg\" alt=\"screenshot\"><br><img src=\"http://ww4.sinaimg.cn/large/c5ee78b5gw1f149r4zqkaj213e0zgajd.jpg\" alt=\"profileshot\"></p>\n<h2>Ongoing notes</h2><ul><li>how to enter the interactive mode? the main function for interactive mode is process_args. Like the code snippet below, it keep reading inputs from stdin(then using <code>fgets</code> to feed it into a input buffer), then using tokenize function(making use of <code>strtok</code> to tokenize the input commands), then the input command is stored in <code>char ** cmdargv</code>, which just like <code>argv</code> we often use. <code>cmdargv[0]</code> stores the first command, like <code>profile</code> and so on. What is left is just to depend on the return value from each core functions to display a proper information back to the screen.  </li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br></pre></td><td><pre><span><span>printf</span>(<span>\"Welcome to FriendMe! (Local version)\\nPlease type a command:\\n&gt; \"</span>);</span><br><span></span><br><span><span>while</span> (fgets(input, INPUT_BUFFER_SIZE, input_stream) != <span>NULL</span>) {</span><br><span>    <span>// only echo the line in batch mode since in interactive mode the user</span></span><br><span>    <span>// just typed the line</span></span><br><span>    <span>if</span> (batch_mode) {</span><br><span>        <span>printf</span>(<span>\"%s\"</span>, input);</span><br><span>    }</span><br><span></span><br><span>    <span>char</span> *cmd_argv[INPUT_ARG_MAX_NUM];</span><br><span>    <span>int</span> cmd_argc = tokenize(input, cmd_argv);</span><br><span></span><br><span>    <span>if</span> (cmd_argc &gt; <span>0</span> &amp;&amp; process_args(cmd_argc, cmd_argv, &amp;user_list) == -<span>1</span>) {</span><br><span>        <span>break</span>; <span>// can only reach if quit command was entered</span></span><br><span>    }</span><br><span></span><br><span>    <span>printf</span>(<span>\"&gt; \"</span>);</span><br><span>}</span><br></pre></td></tr></table></figure><ul><li>cast type when allocating memory for <strong><em>Fixed length character array</em></strong></li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></pre></td><td><pre><span><span>typedef</span> <span>struct</span> user {</span><br><span>    <span>char</span> name[MAX_NAME];</span><br><span>    <span>char</span> profile_pic[MAX_NAME];  <span>// This is a *filename*, not the file contents.</span></span><br><span>    <span>struct</span> post *first_post;</span><br><span>    <span>struct</span> user *friends[MAX_FRIENDS];</span><br><span>    <span>struct</span> user *next;</span><br><span>} User;</span><br></pre></td></tr></table></figure><p>we need to do this:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br></pre></td><td><pre><span>char* username = malloc<span>(<span>MAX_NAME*sizeof</span><span>(<span>char</span>)</span>)</span><span>;</span></span><br><span>strcpy<span>(<span>newuser-&gt;name</span>, username)</span><span>;</span></span><br></pre></td></tr></table></figure><p>to be able to allocate the memory for that character array. </p>\n<ul><li>how to handle structs of linked list when only the head of the list is given like <code>int create_user(const char *name, User **user_ptr_add)</code>. Note that since we will modify the linked list itself, we will have to pass in a pointer of pointer. Now if we only want to iterate through this linked list, we don’t need the ptr of ptr. Resolved by referring to <a href=\"http://geeksquiz.com/linked-list-set-2-inserting-a-node/\" target=\"_blank\" rel=\"external\">this post </a>, and refer to <a href=\"https://www.cs.bu.edu/teaching/c/linked-list/delete/\" target=\"_blank\" rel=\"external\">this post</a> and <a href=\"http://geeksquiz.com/linked-list-set-3-deleting-node/\" target=\"_blank\" rel=\"external\">this post from Geeksquiz</a> for deleting a node from a post. <blockquote>\n<p>one key thing of dealing with ptr of ptr in linked list is that we need make clear the use of <code>curr</code> pointer and <code>*user_ptr</code> since we are suppore to change it in function <code>int create_user(const char *name, User **user_ptr_add)</code>. </p>\n</blockquote>\n</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></pre></td><td><pre><span><span>// add the newuser to the end of linked list.</span></span><br><span><span>// int create_user(const char *name, User **user_ptr_add) </span></span><br><span></span><br><span>\t<span>// now append this node to the end of linked list.</span></span><br><span>\tUser* last = *user_ptr_add;</span><br><span>\t<span>if</span>(*user_ptr_add == <span>NULL</span>){ <span>// if linked list is empty</span></span><br><span>\t\t*user_ptr_add = newuser;</span><br><span>\t}</span><br><span>\t<span>else</span>{ <span>// otherwise</span></span><br><span>\t\t<span>if</span>(<span>strcmp</span>(last-&gt;name, name) == <span>0</span>){ <span>// if the first node is the same user.</span></span><br><span>\t\t\t<span>return</span> <span>1</span>;</span><br><span>\t\t}</span><br><span>\t\t<span>while</span>(last-&gt;next!=<span>NULL</span>){</span><br><span>\t\t\t<span>if</span>(<span>strcmp</span>(last-&gt;name, name) == <span>0</span>){ <span>// if same user exists</span></span><br><span>\t\t\t\t<span>return</span> <span>1</span>;</span><br><span>\t\t\t}</span><br><span>\t\t\tlast = last-&gt;next;</span><br><span>\t\t}</span><br><span>\t\tlast-&gt;next = newuser;</span><br><span>\t}</span><br></pre></td></tr></table></figure><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></pre></td><td><pre><span><span>// delete the user with name from the linked list.</span></span><br><span><span>// int delete_user(const char *name, User **user_ptr_del)</span></span><br><span></span><br><span>\t\tUser* curr = *user_ptr_del;</span><br><span>\t\tUser* prev; <span>// store previous node.</span></span><br><span></span><br><span>\t\t<span>// if head node itself holds the user to be deleted.</span></span><br><span>\t\t<span>if</span>(curr != <span><span>NULL</span> &amp;&amp; <span>strcmp</span><span>(curr-&gt;name, name)</span></span>== <span>0</span>){</span><br><span>\t\t\t*user_ptr_del = curr-&gt;next;</span><br><span>\t\t\t<span>free</span>(curr);</span><br><span>\t\t\t<span>return</span> <span>0</span>;</span><br><span>\t\t}</span><br><span></span><br><span>\t\t<span>while</span>(curr != <span><span>NULL</span> &amp;&amp; <span>strcmp</span><span>(curr-&gt;name, name)</span> !</span>= <span>0</span>){</span><br><span>\t\t\tprev = curr;</span><br><span>\t\t\tcurr = curr-&gt;next;</span><br><span>\t\t}</span><br><span></span><br><span>\t\tdelete_user_from_friends(name, *user_ptr_del);</span><br><span>\t\tprev-&gt;next = curr-&gt;next;</span><br><span>\t\t<span>free</span>(curr);</span><br></pre></td></tr></table></figure><ul><li><p>type is not assignable during <code>malloc</code>: <code>struct user *friends[MAX_FRIENDS];</code></p>\n</li>\n<li><p>segmentation fault!!! <strong><em>Usually in practice, if we want to access the memory location where we don’t have access to, meaning that when we want to set some attributes, we need to first make sure that that part of memory has been malloc!!</em></strong></p>\n<blockquote>\n<p>One trick on this is to make sure that whenever we see a struct like this: first is to malloc memory for the all struct, then for each array, like here <code>name</code>, <code>profile_pic</code> and <code>friends</code> array. Especially the <code>friends</code> array, the haunting time when debugging for the final function <code>delete_user</code>, I always get a segmentation fault, which results from that I did not malloc the memory for the friend array at the very first beginning inside <code>create_user</code> function, thus when I try to change one element’s value, I will access to unallocated memory, a segmentation fault.</p>\n</blockquote>\n</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></pre></td><td><pre><span><span>typedef</span> <span>struct</span> user {</span><br><span>    <span>char</span> name[MAX_NAME];</span><br><span>    <span>char</span> profile_pic[MAX_NAME];  <span>// This is a *filename*, not the file contents.</span></span><br><span>    <span>struct</span> post *first_post;</span><br><span>    <span>struct</span> user *friends[MAX_FRIENDS];</span><br><span>    <span>struct</span> user *next;</span><br><span>} User;</span><br></pre></td></tr></table></figure><ul><li>Difference between <code>memcpy</code> and <code>strcpy</code>. <code>strcpy</code> will stop when meeting a ‘\\0’ line terminator, while <code>memcpy</code> will not do that, it can do the content copy without looking to the value of the contents.</li>\n</ul><h2>Bugs remaining to fix</h2><ul><li>time.h. I finally do a trick to cover up the failure of using time.h. we are supposed to record the time when a post is created, and store the address of that <code>time_t</code>, which is actually a long int, to the struct attribute <code>post-&gt;date</code>, while it fails to display the right time when doing <code>ctime</code> in <code>print_user</code> function. I finally insert a time update right into the <code>print_user</code> function to let them next to each other and it display right result?!.</li>\n</ul>"
		},
		{
			"title": "Responsive web design[第三期]-js动画",
			"link": "http://chocoluffy.com/2016/02/04/Responsive-web-design-%E7%AC%AC%E4%B8%89%E6%9C%9F-js%E5%8A%A8%E7%94%BB/",
			"guid": "http://chocoluffy.com/2016/02/04/Responsive-web-design-第三期-js动画/",
			"pubDate": "2016-02-05T01:48:22.000Z",
			"categories": [
				"javascript",
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>Introduce greensock library to javascript, along with GPU acceleration to create high-quality and smooth animations. </p>",
			"content": "<p>Introduce greensock library to javascript, along with GPU acceleration to create high-quality and smooth animations. </p>\n<a></a>\n<h2>Introduction</h2><p>很多前端开发者会告诉你，你应该避免使用 JavaScript 动画。使用 CSS 动画会有更好的性能（更少的 CPU 时间）和更平滑的效果（更高的帧率）。</p>\n<p>然而，JavaScript 动画慢的原因经常是因为你用的库并没有为动画进行优化。优化过的 JavaScript 动画引擎（比如 GreenSock 或 Velocity.js）有堪比 CSS 动画的性能。某些情况下 JS 动画甚至比 CSS 动画更快！可参考下面这个性能的比较， 最后发现在某些情况下greensock的性能会比jquery好上5-6倍</p>\n<ul><li><a href=\"https://www.greensock.com/js/speed.html\" target=\"_blank\" rel=\"external\">greensock</a> </li>\n</ul><h2>引入greensock js库</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></pre></td><td><pre><span>TweenMax.fromTo(<span>\"#box\"</span>,<span>1</span>, {</span><br><span>    <span>// from</span></span><br><span>    css: {</span><br><span>      left: <span>\"-200px\"</span>,</span><br><span>    }</span><br><span>  },{</span><br><span>    <span>// to</span></span><br><span>    css: {</span><br><span>      left: <span>\"200px\"</span>,</span><br><span>    },</span><br><span></span><br><span>    <span>// 永久重复动画的选项</span></span><br><span>    repeat: -<span>1</span>,</span><br><span></span><br><span>    <span>// 反转、重新运行动画的选项</span></span><br><span>    yoyo: <span>true</span>,</span><br><span></span><br><span>    <span>// 改变 easing 类型</span></span><br><span>    ease: Power2.easeInOut,</span><br><span>  }</span><br><span>);</span><br></pre></td></tr></table></figure><blockquote>\n<p>什么是fps? 帧率或画面更新率是用于测量显示帧数的量度[1]。测量单位为“每秒显示帧数”（Frame per Second，FPS，帧率）或“赫兹”，一般来说FPS用于描述影片、电子绘图或游戏每秒播放多少帧，而赫兹则描述显示屏的画面每秒更新多少次。<br>由于人类眼睛的特殊生理结构，如果所看画面之帧率高于每秒约10-12帧的时候，就会认为是连贯的[2]， 此现象称之为视觉暂留。这也就是为什么电影胶片是一格一格拍摄出来，然后快速播放的。但30帧仅仅是流畅，而非平滑连续，因此有更多帧率的产品推出也就不足为奇了。<br>有声电影的拍摄及播放帧率均为每秒24帧，对一般人而言已算可接受，但对早期的高动态电子游戏，尤其是射击游戏或竞速游戏来说，帧率少于每秒30帧的话，游戏就会显得不连贯，这是因为电脑会准确地显示瞬时的画面（像是一台快门速度无限大的相机），没有动态模糊使流畅度降低。而使用相同帧率的摄影机拍摄物体移动时，该场景的视频必定会表现所有移动物体在曝光时间内所有位置的完整组合。因此很多新世代电玩游戏以动态模糊为特色。在实际体验中，60帧相对于30帧有着更好的体验。</p>\n</blockquote>\n<p>在app.js里面我们用y来表现出垂直状态的变化</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></pre></td><td><pre><span><span>function</span> animateLogo(){</span><br><span>\tTweenMax.fromTo(<span>\"#logo\"</span>, <span>2.5</span>, {</span><br><span>\t\tcss: {</span><br><span>\t\t\ty: <span>\"-30px\"</span>,</span><br><span>\t\t}</span><br><span>\t}, {</span><br><span>\t\tcss: {</span><br><span>\t\t\ty: <span>\"20px\"</span>,</span><br><span>\t\t},</span><br><span></span><br><span>\t\trepeat: -<span>1</span>,</span><br><span>\t\tyoyo: true,</span><br><span>\t\tease: Sine.easeInOut,</span><br><span>\t});</span><br><span>}</span><br></pre></td></tr></table></figure><h2>GPU加速</h2><p>你可以把一个网页想象为一堆矩形。布局和绘图都是由 CPU 完成的：</p>\n<p>CPU 计算这些矩形的布局。矩形在哪里？它们有多大？<br>CPU 把矩形渲染成点阵位图（bitmap）。<br>之后如果可能的话，矩形被送到 GPU 以获得更好的性能：</p>\n<p>CPU 以点阵位图的形式上传到 GPU 中。<br>CPU 给 GPU 发送指令去处理这些位图。可能有平移/缩放/旋转，修改透明度，等等。<br>GPU 为什么比 CPU 快呢？假设我们把一个红色点阵和一个绿色点阵结合，CPU 不得不一个一个像素地做.</p>\n<p>总的来说，当修改 CSS 属性时，有三种可能的开销：</p>\n<p>重排（CPU。代价最高）。<br>重绘（CPU）。<br>变换, 旋转, 缩放, 透明度（GPU，代价最低）。</p>\n<p>因此在使用transform的时候， 我们常常用y在表示垂直方向的移动，这么做是不会重新排列布局的， 而是在局部位置偏移。</p>\n<blockquote>\n<p>注意： left 只对 position: absolute 生效 </p>\n</blockquote>\n<p>transform 的原理是由元素的定位位置（absolute or relative) 偏移。<br>用 GreenSocks 去修改 left 的话是改变定位位置。<br>也就是说 left 的动画改变布局，但 transform 动画不会改变布局。</p>\n<h2>多步骤动画</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></pre></td><td><pre><span><span>var</span> t = <span>new</span> TimelineMax();</span><br><span>t.<span>to</span>(<span>\"<span>#box</span>\"</span>,<span>1</span>,{<span>x</span>: <span>200</span>})</span><br><span>  .<span>to</span>(<span>\"<span>#box</span>\"</span>,<span>0.5</span>,{<span>rotation</span>: <span>\"360deg\"</span>})</span><br><span>  .<span>to</span>(<span>\"<span>#box</span>\"</span>,<span>1</span>,{<span>y</span>: <span>100</span>})</span><br><span>  .<span>to</span>(<span>\"<span>#box</span>\"</span>,<span>0.5</span>,{<span>rotation</span>: <span>\"-=360deg\"</span>});</span><br></pre></td></tr></table></figure><h2>指示器(滚动指示条)</h2><p>当窗口滚动时, 你可以用 window.scrollY 来算出窗口正在展示的是哪一部分。那么现在的重点就在于， 怎样可以获得关于元素所在位置， 高度的各种属性， 比如<code>scrollY</code>, <code>offsetHeight</code>, <code>offsetTop</code></p>\n<ul><li><a href=\"http://stackoverflow.com/questions/6777506/offsettop-vs-jquery-offset-top/21880020#21880020\" target=\"_blank\" rel=\"external\">offset的各种用法实例</a></li>\n</ul><h2>取消link默认行为</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></pre></td><td><pre><span><span><span>function</span> <span>addSmoothScrolling</span>(<span></span>)</span>{</span><br><span>\t<span>var</span> links = <span>document</span>.querySelectorAll(<span>\"#slider-control a\"</span>);</span><br><span>\t<span>for</span>(<span>var</span> i=<span>0</span>; i&lt;links.length; i++){</span><br><span>\t\t<span>var</span> link = links[i];</span><br><span>\t\t<span>var</span> section = <span>document</span>.querySelectorAll(<span>\"div.section\"</span>)[i];</span><br><span>\t\t(<span><span>function</span>(<span>sec</span>)</span>{</span><br><span>\t\t\t<span>// console.log(sec);</span></span><br><span>\t\t\tlink.addEventListener(<span>\"click\"</span>, <span><span>function</span>(<span>e</span>)</span>{</span><br><span>\t\t\t\t<span>// console.log(sec.offsetTop+\"px\");</span></span><br><span>\t\t\t\tscrollToElement(sec);</span><br><span>\t\t\t\te.preventDefault();</span><br><span>\t\t\t})</span><br><span>\t\t})(section)</span><br><span>\t}</span><br><span>}</span><br></pre></td></tr></table></figure><p>首先用一个闭包来保证， 里面的函数在click的时候才之行， 而在那个时候， i 已经到了最后一个link的位置， 所以必须提前找到对应的section， 然后在闭包中传入。 同时需要在click事件的最后加上一个e.preventDefault， 来阻止link的默认行为， link的默认行为是直接跳转， 然后我们需要动画来辅助。</p>"
		},
		{
			"title": "Memory allocation in C",
			"link": "http://chocoluffy.com/2016/01/26/Memory-allocation-in-C/",
			"guid": "http://chocoluffy.com/2016/01/26/Memory-allocation-in-C/",
			"pubDate": "2016-01-26T22:36:34.000Z",
			"categories": [
				"C",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>Learning memory allocation in C for beginners will be totally a pain. This post, distilled from course materials, will provide you a practice guide and example coding snippets to help you learning more and fast in C programming language. It is cherishable, at least to me :)</p>",
			"content": "<p>Learning memory allocation in C for beginners will be totally a pain. This post, distilled from course materials, will provide you a practice guide and example coding snippets to help you learning more and fast in C programming language. It is cherishable, at least to me :)</p>\n<a></a>\n<h2>Introduction to malloc</h2><ul><li>Variable defined in function will be stored in stack, so how to use that part of memory after function returns? we use <code>void * malloc(size_t size)</code> will allocate memory in heap. This function will remain the memory for the variables until the function explicitly deallocate them. The argument for this function indicates how many bytes of memory should it allocate.</li>\n<li>In general, <code>size_t</code> is unsigned_int. Notice the <code>void *</code> type of the pointer, we know that in C, add 1 to a pointer will go to the next legal address, for <code>int*</code>, it is the next integer, for <code>char*</code>, it is next character.</li>\n<li>A void pointer is a pointer that represent a generic type. It just points to the memory specified, so it do not need to specify right now what type of that memory is, instead, we will declare the type when use pointer:</li>\n</ul><figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span><span>int</span> * pt = <span>malloc</span>(<span>sizeof</span>(<span>int</span>));</span><br></pre></td></tr></table></figure><p>the above code indicates that we will the allocated memory for integer. </p>\n<h2>Example code</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br></pre></td><td><pre><span><span>#include &lt;stdio.h&gt;</span></span><br><span><span>#include &lt;stdlib.h&gt;</span></span><br><span></span><br><span>/* </span><br><span> * <span>Return</span> an <span>array</span> <span>of</span> the squares <span>from</span> <span>1</span> to max_val.</span><br><span> */</span><br><span><span>int</span> *squares(<span>int</span> max_val) {</span><br><span>    <span>int</span> *<span>result</span> = malloc(sizeof(<span>int</span>) * max_val);</span><br><span>    <span>int</span> i;</span><br><span>    <span>for</span> (i = <span>1</span>; i &lt;= max_val; i++) {</span><br><span>        <span>result</span>[i - <span>1</span>] = i * i ;</span><br><span>    }</span><br><span>    <span>return</span> <span>result</span>;</span><br><span>}</span><br><span></span><br><span></span><br><span><span>int</span> main() {</span><br><span></span><br><span>    <span>int</span> *squares_to_10 = squares(<span>10</span>);</span><br><span>    </span><br><span>    // <span>let</span>'s print them <span>out</span> </span><br><span>    <span>int</span> i;</span><br><span>    <span>for</span> (i = <span>0</span>; i &lt; <span>10</span>; i++) {</span><br><span>        printf(<span>\"%d\\t\"</span>, squares_to_10[i]);</span><br><span>    }</span><br><span>    printf(<span>\"\\n\"</span>);</span><br><span></span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><p>Note that in the above code, there are several variables that are located in heap. They are, the address store inside the variable result, since it points to a integer that lies in heap, while <strong>the addresss of the variable result is not in the heap, it is in the stack</strong>. One quick trick is that those value in heap, their address is valid. </p>\n<h2>Explicitly deallocate the memory</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br></pre></td><td><pre><span><span>#<span>include</span> <span>&lt;stdio.h&gt;</span></span></span><br><span><span>#<span>include</span> <span>&lt;stdlib.h&gt;</span></span></span><br><span></span><br><span><span><span>int</span> <span>play_with_memory</span><span>()</span> </span>{</span><br><span>    <span>int</span> i;</span><br><span>    <span>int</span> *pt = <span>malloc</span>(<span>sizeof</span>(<span>int</span>));</span><br><span></span><br><span>    i = <span>15</span>;</span><br><span>    *pt = <span>49</span>;</span><br><span>    </span><br><span>    <span>// What happens if you comment out this call to free?</span></span><br><span>    <span>free</span>(pt);</span><br><span></span><br><span>    <span>// What happens if you uncomment these statements?</span></span><br><span>    <span>printf</span>(<span>\"%d\\n\"</span>, *pt); <span>// output 49</span></span><br><span>    *pt = <span>7</span>;</span><br><span></span><br><span>    <span>printf</span>(<span>\"%d\\n\"</span>, *pt); <span>// output 7</span></span><br><span></span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br><span></span><br><span><span><span>int</span> <span>main</span><span>()</span> </span>{</span><br><span>    play_with_memory();</span><br><span>    play_with_memory();</span><br><span>    play_with_memory();</span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><blockquote>\n<p>Important issue here: when returned from the function, all variables will be freed from stack, which means that the <code>i</code> and <code>result</code> in the above code will be removed. It will cause a memory leak if we forget to link the memory from <code>malloc</code> to other heap variables. Since there will be no way from elsewhere to access that part of memory.</p>\n</blockquote>\n<ul><li>The danger of memory leak is that if it accumulates, it will finally cause a <code>out of memory</code> issue.</li>\n<li>what happens if we print out the value stored in that memory location after we free up that pointer? <strong>Address is still valid and the value can still be accessed, but this time, we are using the part of memory that does not belong to us</strong>. Note that using unallocated memory is OK in some cases, but it will be dangerous when that part of memory being reallocated. So, always use allocated memory!</li>\n</ul><h2>Passing values</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br></pre></td><td><pre><span><span>#<span>include</span> <span>&lt;stdio.h&gt;</span></span></span><br><span><span>#<span>include</span> <span>&lt;stdlib.h&gt;</span></span></span><br><span></span><br><span><span><span>void</span> <span>helper</span><span>(<span>int</span> **arr_matey)</span> </span>{</span><br><span>   <span>// let's make an array of 3 integers on the heap</span></span><br><span>   *arr_matey = <span>malloc</span>(<span>sizeof</span>(<span>int</span>) * <span>3</span>);</span><br><span></span><br><span>   <span>int</span> *arr = *arr_matey;</span><br><span>   arr[<span>0</span>] = <span>18</span>;</span><br><span>   arr[<span>1</span>] = <span>21</span>;</span><br><span>   arr[<span>2</span>] = <span>23</span>;</span><br><span>}</span><br><span></span><br><span><span><span>int</span> <span>main</span><span>()</span> </span>{</span><br><span>    <span>int</span> *data;</span><br><span>    helper(&amp;data);</span><br><span></span><br><span>    <span>// let's just access one of them for demonstration</span></span><br><span>    <span>printf</span>(<span>\"the middle value: %d\\n\"</span>, data[<span>1</span>]);</span><br><span></span><br><span>    <span>free</span>(data);</span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><ul><li>there are basically two ways to help to avoid memory leak, a) <strong>return value</strong>, if we define that function type to be a pointer type, so that we can return the pointer in order to assign the values in main function. b) <strong>argument</strong>, we pass the one we want to assign values to the function and do the assigning part inside that function, and this time, the function type can be void but still finish the task.</li>\n<li>However, it is much harder to use <code>argument</code> one since in C, the changes inside the function will not be preserved if we return nothing. Therefore, we need to the “address-value” relation in such scenario – That is <strong>we pass in pointer, we change value pointed at pointer, without returning anything, and we’re done.</strong> While problem comes when we want to change the pointer, say this line <code>*arr_matey = malloc(sizeof(int) * 3);</code>, we want to change the pointer now, but such change will not be preserved after function. Therefore, we will need to pass in a <strong>“poiter of pointer” to deal with pointer assignment!</strong> </li>\n</ul><h2>Nested structure</h2><p>if we want to use a nested struture to represent an array, say in that array, each element points to another array, since we don’t know that array size at compilation time, we would use <code>malloc</code> to allocate memory for those int array. The code is like</p>\n<figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span><span>int</span> ** pt = <span>malloc</span>(<span>sizeof</span>(<span>int</span>*)*<span>2</span>);</span><br></pre></td></tr></table></figure><p>Say, now, I want the pt[0] to hold up an array of one integer, the way to do that is to use:</p>\n<figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span>pt[<span>0</span>] = <span>malloc</span>(<span>sizeof</span>(<span>int</span>));</span><br></pre></td></tr></table></figure><p>Similarly, if we want pt[1] to hold up 3 integers, we would use:</p>\n<figure><table><tr><td><pre><span>1</span><br></pre></td><td><pre><span>pt[<span>1</span>] = <span>malloc</span>(<span>sizeof</span>(<span>int</span>)*<span>3</span>);</span><br></pre></td></tr></table></figure><blockquote>\n<p>Note that when we free those pointers, we need to free the innermost pointer first then outer one. </p>\n</blockquote>\n<p>An complete code example:</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br></pre></td><td><pre><span><span>#<span>include</span> <span>&lt;stdio.h&gt;</span></span></span><br><span><span>#<span>include</span> <span>&lt;stdlib.h&gt;</span></span></span><br><span></span><br><span><span><span>int</span> <span>main</span><span>()</span> </span>{</span><br><span></span><br><span>    <span>// this allocates space for the 2 pointers</span></span><br><span>    <span>int</span> **pointers = <span>malloc</span>(<span>sizeof</span>(<span>int</span> *) * <span>2</span>); </span><br><span>    <span>// the first pointer points to a single integer</span></span><br><span>    pointers[<span>0</span>] = <span>malloc</span>(<span>sizeof</span>(<span>int</span>));</span><br><span>    <span>// the second pointer pointes to an array of 3 integers</span></span><br><span>    pointers[<span>1</span>] = <span>malloc</span>(<span>sizeof</span>(<span>int</span>) * <span>3</span>);</span><br><span></span><br><span>    <span>// let's set their values</span></span><br><span>    *pointers[<span>0</span>] = <span>55</span>;</span><br><span></span><br><span>    pointers[<span>1</span>][<span>0</span>] = <span>100</span>;</span><br><span>    pointers[<span>1</span>][<span>1</span>] = <span>200</span>;</span><br><span>    pointers[<span>1</span>][<span>2</span>] = <span>300</span>;</span><br><span></span><br><span>    </span><br><span>    <span>// do other stuff with this memory</span></span><br><span></span><br><span>    <span>// now time to free the memory as we are finished with the data-structure</span></span><br><span>    <span>// first we need to free the inner pieces</span></span><br><span>    <span>free</span>(pointers[<span>0</span>]);</span><br><span>    <span>free</span>(pointers[<span>1</span>]);</span><br><span>    <span>// now we can free the space to hold the array of pointers themselves</span></span><br><span>    <span>free</span>(pointers);</span><br><span>    </span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><h2>Memory model</h2><ul><li>note that th variable in main function does not belong to global variable, indicating it should still go to the stack part. The “global data” part contains mainly three stuff: <strong>a) global variables, b) string literals </strong> Note that for the string literals, the code like this: <code>char* str = \"Hello world!\";</code> can lie in a local function, it just means that the pointer str can be in the stack, while the string literal “Hello world!” is in global data part. </li>\n<li>And dynamic memory allocation lie in heap.</li>\n</ul><h2>String</h2><ul><li><p>difference between a string and a character is that at the end of string, there is a <code>\\0</code> as an ending signal. Once the character array declared, the size is fixed. Note that the difference between these similar version of declaring character array:</p>\n<ul><li><code>char string[20] = \"cool shit\"</code>, it is defining a <strong>string variable</strong>, with a <code>\\0</code> at the end of the array, note that there will be a lot of <code>\\0</code> following the valid words. It can be changed afterwards.</li>\n<li><code>char string[] = \"cool shit\"</code>, defining a <strong>string variable</strong> the size will be fixed according to the first assignment. It can be changed afterwards.</li>\n<li><code>char* string = \"cool shit\"</code>, defining a <strong>string constant</strong>. it is a string literal! cannot be changed!! If you change the string, it will give a “bus error”. Main point here: <em> <strong>it makes string point to a read-only memory where string literal is stored, while the above two way are indeed allocating memory and copy string to them.</strong></em></li>\n</ul></li>\n<li><p>difference between <code>strlen</code> and <code>sizeof</code>. <code>strlen</code> will return the valid number of characters before null character, while <code>sizeof</code> will just give you the size of whole char array including null characters.</p>\n</li>\n<li><p>use <code>strncpy</code> as a stable counterpart of <code>strcpy</code>, the usage is like: <code>strncpy(s1, s2, sizeof(s1));</code> see the complete code below, s2 is a string literal. </p>\n</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></pre></td><td><pre><span><span>#<span>include</span> <span>&lt;stdio.h&gt;</span></span></span><br><span><span>#<span>include</span> <span>&lt;string.h&gt;</span></span></span><br><span></span><br><span><span><span>int</span> <span>main</span><span>()</span> </span>{</span><br><span>    <span>char</span> s1[<span>5</span>];</span><br><span>    <span>char</span> s2[<span>32</span>] = <span>\"University of\"</span>;</span><br><span></span><br><span>    <span>// This is unsafe because s1 may not have enough space</span></span><br><span>    <span>// to hold all the characters copied from s2.</span></span><br><span>    <span>//strcpy(s1, s2);</span></span><br><span></span><br><span>    <span>// This doesn't necessarily null-terminate s1 if there isn't space.</span></span><br><span>    <span>strncpy</span>(s1, s2, <span>sizeof</span>(s1));</span><br><span>    <span>// So we explicitly terminate s1 by setting a null-terminator.</span></span><br><span>    s1[<span>4</span>] = <span>'\\0'</span>;</span><br><span></span><br><span>    <span>printf</span>(<span>\"%s\\n\"</span>, s1);</span><br><span>    <span>printf</span>(<span>\"%s\\n\"</span>, s2);</span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><blockquote>\n<p>Note that s1 is a character array, which means that there is no null characters at the end. if we want to do this way, we want to add null character at the end.</p>\n</blockquote>\n<ul><li>Similarly, <code>strncat(s1, s3, sizeof(s1)-strlen(s1)-1);</code> is the stable version of using strcpy.</li>\n<li><code>char * strchr(const char s, int c);</code> return the index at the first occurence of the character</li>\n<li><code>char * strstr(const char* s1, const char* s2);</code> find sub string. see the code example below:</li>\n</ul><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br></pre></td><td><pre><span><span>#<span>include</span> <span>&lt;stdio.h&gt;</span></span></span><br><span><span>#<span>include</span> <span>&lt;string.h&gt;</span></span></span><br><span></span><br><span><span><span>int</span> <span>main</span><span>()</span> </span>{</span><br><span>    <span>char</span> s1[<span>30</span>] = <span>\"University of C Programming\"</span>;</span><br><span>    <span>char</span> *p;</span><br><span></span><br><span>    <span>// find the index of the first 'v'</span></span><br><span>    p = <span>strchr</span>(s1, <span>'v'</span>);</span><br><span>    <span>if</span> (p == <span>NULL</span>) {</span><br><span>        <span>printf</span>(<span>\"Character not found\\n\"</span>);</span><br><span>    } <span>else</span> {</span><br><span>        <span>printf</span>(<span>\"Character found at index %ld\\n\"</span>, p - s1);</span><br><span>    }</span><br><span></span><br><span>    <span>// find the first token (up to the first space)</span></span><br><span>    p = <span>strchr</span>(s1, <span>' '</span>);</span><br><span>    <span>if</span> (p != <span>NULL</span>) {</span><br><span>        *p = <span>'\\0'</span>;</span><br><span>    }</span><br><span>    <span>printf</span>(<span>\"%s\\n\"</span>, s1);</span><br><span></span><br><span>    <span>return</span> <span>0</span>;</span><br><span>}</span><br></pre></td></tr></table></figure><p>if the character specified in the second argument cannot find the right place, then it will assign NULL to p in this case. We can use pointer subtraction to get the index. </p>\n<blockquote>\n<p>后记： 欢迎加入我的私人公众号， 和你分享我思考的观点和文章：<br><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1ezbljkk2apj20by0byq3q.jpg\" alt=\"公众号二维码\"></p>\n</blockquote>"
		},
		{
			"title": "象征与符号",
			"link": "http://chocoluffy.com/2016/01/23/%E8%B1%A1%E5%BE%81%E4%B8%8E%E7%AC%A6%E5%8F%B7/",
			"guid": "http://chocoluffy.com/2016/01/23/象征与符号/",
			"pubDate": "2016-01-24T04:05:53.000Z",
			"categories": [
				"社会人物",
				"读书笔记",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>是什么， 在流血。</p>",
			"content": "<p>是什么， 在流血。</p>\n<a></a>\n<p><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1f0agj99z92j20zk0zkajv.jpg\" alt=\"mirror\"></p>\n<p>每一个刺耳的反对声音， 都很容易被看作是一种象征， 与其说是自愿地走上风口浪尖， 不如说， 是在大众的狂欢和幻想意淫里演变为一场戏剧式的剑拔弩张。 人们娱乐着， 消遣着， 像是有了将帅挂靠着的小兵肆意地挑逗着对手的神经， 全然不觉语气里的傲慢与肤浅。 枪口最后还是走火了， 不过看热闹的小兵早已作鸟兽散， 留下曾经市井起义逐渐背离初衷的将帅， 在一片哀叹中， 付出沉重的代价。</p>\n<p>关于查理周刊的事情， 我想试着从一个不那么主流， 但是仍然很有趣的角度去想， 究竟什么是象征， 是什么推动了出现象征性。是什么让这种呈现和代表变得躁动不安又难以抗拒。 又是什么， 在流血。</p>\n<p>首先引起我注意的是这几句话</p>\n<ul><li>“一种沉重的象征主义的重量——原本并不存在于我们的漫画中，也离我们很远的东西，现在落在了我们的肩上。”</li>\n<li>“实际上，《查理周刊》一直以来都致力于反对象征主义：我们摧毁符号，打破禁忌，将那些幻想的泡沫破灭。我们很高兴看到人们给予《查理周刊》支持，但同时他们的做法却跟《查理周刊》的初衷背道而驰。”</li>\n<li>“任何意义的象征主义都能被任何人利用起来做他们想做的事。”</li>\n</ul><p>我接着联想到的是， 很久之前的一个大新闻， 戴安娜王妃之死。 如果大家还有印象， 当时那个车祸发生之后的几天， 是接踵而来的铺天盖地关于邪恶的小报记者的评论， 大家指责那些追逐在王妃身后的狗仔记者们， 认为他们手上沾满了鲜血， 要对公众心中那个高贵优雅的戴安娜王妃的事故负上不可推卸的责任。 然而如果仔细推敲， 渴望注视戴安娜王妃高贵而优雅的形象， 又在其陨灭之时渴求安慰的， 究竟是那些努力挖掘“隐私”的小报， 还是拥有着窥视他人生活的这个或许谈不上弱点的本能的大众呢？而那些狗仔小报， 或许只是市场的产物， 只是人们愿意窥视， 哪怕只是对他人生活的一种不恶意的关心的象征。 而一旦顶上了象征的头衔， 也容易在万众注视下成为笔伐口诛的对象。 换句话说， 很可能是人们这种不必然具备恶意的欲望， 促成了那种“有害”的小报和令人们讨厌的狗仔记者。</p>\n<p>听上去挺“悖论”的， 为什么明明是不必然恶意的东西， 会衍生出有害的结果。 而为什么， 主角都是传媒媒体， 都是传播者。</p>\n<p>人们饭前茶后的谈资， 自古放肆得甚至有点愚蠢朋克的法式幽默， 又真得能经受得住媒体放大器般的传播吗？媒体往往是言论自由和新闻自由的象征和符号。 美国宪法史上好几次最精彩的判决和宣判都和言论自由有关， 而关于新闻自由和涉及“所谓的政府内幕的间谍罪”之间的争论也一直不会停止。 人们不希望受到恶意言论所困， 却又畏惧在任何形式上的禁止和压迫上走得更远。 而媒体， 则更像一个扩音器， 无论是积极还是消极的影响都会被施加上令人喘不过气的压迫力。 一个我能想到的理由， 然而并不新鲜， 是更多的人们偏爱剑拔弩张多过鲜花掌声， 反对和刺耳， 带着张着血气的眼神， 比冷静和无为更为刺激和爽感。 而媒体， 只是一次次转发传递的情感累积， 只是在一场场人群的狂欢中那个热气朝天的广场， 没有了人群， 没有了咆哮， 也就没有它本身存在的意义。</p>\n<p>人们可以在自己的本能和欲望中注视到许多象征的缘由。 或许象征本身， 就是人们所力所不及却昼夜痴狂的一种群体记忆吧。而没有了回响， 也就没有了意义。</p>\n<blockquote>\n<p>后记： 这篇文章的大部分构架是我在等地铁的时候偶然想到的。 缘于读书小组的一次主题讨论， 看到朋友分享的一篇文章， 由一些只言片语所启发所引来的一堆胡思乱想。 或许我可以写得更加详细一点， 但是可能大家在自己思考的时候的所思所想也已远超过我的文笔和见解， 多一些余地， 也多一些回响的空间嘛。趁周末的时候写点文字的感觉还是极好的， 望坚持！最后， 本文中关于戴安娜王妃的例子阐述， 也是启发于以前看到的北大法学系苏力教授关于隐私权的探讨， 而那些摘录的句子， 来源于下面这篇朋友转发的文章。附上我所参考的文章原文。</p>\n</blockquote>\n<h2>《查理周刊》幸存者专访：我们不是一种象征，我们只是一本简单的漫画</h2><p>当地时间1月7日，法国漫画杂志《查理周刊》突遭恐怖分子持枪袭击，造成12人死亡，11人受伤。遇难者中包括杂志社五名重要的漫画家以及两名警察。面对这样的暴行，“Je suis Charlie”（我是查理）成为了一句口号，一面宣扬保护言论自由、抵制恐怖主义的旗帜。</p>\n<p>Luz在《查理周刊》工作了20年。1月7日是他的生日，因此他在当天早上在《查理周刊》杂志社总部召开的每周编辑会议上迟到了，因此逃过一劫。现在他同其他的幸存者一起在为1月14日发行的下一期《查理周刊》做准备，这一期漫画将印刷100万份。在这份新的杂志中，Luz和他的同事们将在漫画中描述这周日的共和国大游行。在恐怖分子杀死了他的朋友，他的导师，他的亲人之后，Luz向记者讲述了他的愤怒，他的恐惧，他的怀疑。目前悲痛欲绝的他不能确定在1月7日的悲剧之后他是否还能继续画下去。</p>\n<p>记者：下周三的《查理周刊》的内容将是很敏感的国家与政治问题。在目前这种不稳定的局势下，你们为什么要承担起这样的责任呢？</p>\n<p>Luz：当我最初拿起画笔的时候，我并不认为这是一件危险的事，我们认为我们只是画出类似滑稽的米老鼠的东西而已。但现在，在死亡，枪击，暴力之后，一切都改变了。所以的目光都聚焦在我们身上，我们现在成了一个象征，就像我们画出来的漫画一样。《人道报》Humanité 将《查理周刊》2015年1月7号刊的作家Houellebecq漫画像作为封面，并配上头条标题“自由已被谋杀”，莫大的讽刺。一种沉重的象征主义的重量——原本并不存在于我们的漫画中，也离我们很远的东西，现在落在了我们的肩上。</p>\n<p>《查理周刊》1月7号刊，刚出新作《屈服》的Houellebecq登上封面，书中想象了2022年伊斯兰化了的法国。</p>\n<p>记者：您所说的“象征主义的重量”是什么意思呢？</p>\n<p>Luz: 2007年，当丹麦报纸Jyllands-Posten把一系列穆罕默德的漫画刊登出来之后，我们被看成是为媒体言论自由抗争的麻烦制造者或是勇敢的白衣骑士。在2011年，当我们的办公室被燃烧弹攻击时，我们再一次被看作是白衣骑士。2012年，一部关于穆斯林的喜剧电影上映（穆斯林的无知），当时我们把这部电影画成了相关的漫画，得到了相同的回应：我们再一次成为了危险的麻烦制造者，画出危险的漫画导致法国领事馆关闭、导致在国外的法国人承担恐惧的麻烦制造者。当全球都因此处于恐慌之中时，我们只是该死的一本受大众喜爱的杂志而已。这本杂志成为了国家、国际的象征，但是，被杀死的是“人”，不是“言论自由”！是那些坐在办公室里画漫画的人。</p>\n<p>记者：你的意思是说漫画的本质改变了吗？</p>\n<p>Luz：自从我们开始画有关穆罕默德的漫画开始，漫画“不承担责任”的本质就开始一点点消失了。从2007年开始，我们的漫画被人们以字面上的意思来理解。人们，包括一些像Plantu那样的漫画家（Plantu，法国政治讽刺漫画家）都认为我们不该画那些关于穆罕默德的漫画，因为这些画都在网络上疯传。因此我们得处处小心遭人报复，这种感觉让人难以忍受。</p>\n<p>记者：为什么？</p>\n<p>Luz：从2007年开始，《查理周刊》就受到审查并被警告要承担责任。我们画出的每一幅漫画都被解读成是跟政治有关。这些责任就落到了我们肩上。但我们只是一份杂志，买了，打开看了，再合上，就这么简单。若是人们把我们的漫画传到网上，若是媒体强调我们的一些漫画，那是他们的责任，不是我们的。</p>\n<p>记者：但同你们事与愿违的事情发生了。</p>\n<p>Luz：我们被加上了象征主义的责任，而这本不是《查理周刊》的初衷。我们跟Plantu不同，我们反对象征主义。“战争中鸽子象征着和平”这类隐喻不是我们想要表达的。我们是在细节上下功夫，我们注重的是怎样把我们画的东西用法式幽默表达出来。</p>\n<p>记者：漫画在某些情况下会被认为是粗鲁的，或是很朋克的东西。</p>\n<p>Luz：有些时候愚蠢，有些时候粗鲁，至于朋克，那是肯定的。有时候漫画不会产生任何影响，另一些时候它就只是供人消遣的娱乐。《查理周刊》聚集了一群思想差异很大的漫画家。根据不同的漫画家用不同的风格来表现一副漫画——画政治或是艺术，漫画的本质也在改变。但是这种多样性的表达方式现在却不复存在了。每一幅漫画都被看作是我们所有人一起完成的。实际上，《查理周刊》一直以来都致力于反对象征主义：我们摧毁符号，打破禁忌，将那些幻想的泡沫破灭。我们很高兴看到人们给予《查理周刊》支持，但同时他们的做法却跟《查理周刊》的初衷背道而驰。</p>\n<p>记者：你们现在已经成为引领民族团结的旗帜。</p>\n<p>Luz：这种团结能帮助奥朗德巩固整个国家，同样对于勒庞提倡的恢复死刑的主张也有帮助。任何意义的象征主义都能被任何人利用起来做他们想做的事。而这恰恰跟《查理周刊》追求的不同，你不能去做任何你幻想出来的事情。当我们嘲讽，开政治的玩笑，或者说是娱乐大众的时候，我们没有成为一种符号。我认为Charb（《查理周刊》主编，在11.7恐袭案中遇难）是20世纪末、21世纪初的Jean-Marc Reiser，他用自己的方式对这个社会做出评价。他画出藏在表象下的阴影，那些爱说谎的丑陋的人。而现在我们也被掩盖在表象下了。</p>\n<p>记者：您的意思是？</p>\n<p>Luz：在目前一种情绪状态下发布《查理周刊》是一个正确的时机吗？这样快速地对所攻击的象征主义做出回应适合吗？我很怀疑。用象征主义来回应象征主义，这不是《查理周刊》做的事。昨天晚上我在脑海中描绘出一幅漫画，不过我可能不会把它画出来：地板上一滩滩污渍代表着遇难者倒下的地方，一幅眼镜散落在角落说“哈哈哈”，背景是黑色。这不是一个好的主意，因为它会被打上象征主义的标签。</p>\n<p>记者：所以您的问题时“事件过后你们将以什么方式继续画下去？”</p>\n<p>Luz：是的，以及我怎样在这样的背景下画画，在《查理周刊》被赋予了那么多幻想之后。</p>\n<p>记者：《查理周刊》将怎么继续下去呢？</p>\n<p>Luz：这将会很复杂。除了我之前提到的那些原因之外，我们那几个善于画画、善于思考政治、道德、思想激进的同事—— Charb, Tignous, Honoré，还有其他几位，不在了。在这种困难的时刻，我们剩下的人承担着重任。现在只剩下Catherine, Willem, Coco以及我，还有受伤的Riss。单凭我们几个人的力量怎么才能越过这种象征主义呢？（早前从《查理周刊》离职的Jul现在前来帮助策划下一期的内容。）每个人都能成为漫画家，但他们能抓住查理的精神吗？我们的精神流传了22年了，现在这份杂志得以生存至今都是杂志社所有成员的努力。</p>\n<p>记者：你们觉得有必要将先知画进讽刺漫画里吗？抑或你们有时候会觉得自己掉进了陷阱里？</p>\n<p>Luz：有趣的是在2007年的事件过后我们继续画了一些有关穆罕默德的漫画。在2007年、2011年以及2012年三次画的默罕默德漫画引起争议之后，Charb 和 Zineb El-Rhazoui（在《查理周刊》工作的穆斯林女记者） 又出了两卷关于穆罕默德生活的漫画，但并没有引起轰动。我们的目的达到了。Charb 想要按照这个设想一直进行下去，穿着他的登山鞋，和他喜欢得不得了的实际上很丑的军裤，站在高处（笑）。Charb相信我们可以继续克服禁忌和符号标准。但现在，我们成为了一种符号。当一种符号就是你自己的时候，你能怎么样去摧毁它？</p>\n<p>站在被烧毁的办公楼前的Charb。</p>\n<p>记者：我不知道。</p>\n<p>Luz：我也不知道。这周我不打算去想这个问题，我也不确定以后我会不会来解决它。我们会继续发布《查理周刊》。我会强迫我自己的。我会去思考我死去的朋友们，我知道他们不是为了法国而倒下的！今天，看上去似乎是《查理周刊》为言论自由而死了。但事实很简单，就是我们的朋友死了。我们爱的朋友，那些有着让我们非常欣赏的才华的朋友死了。</p>\n<p>记者：在BFMTV上，我们看到现在局势很混乱。Charb的女友Jeannette Bougrab 说，他们值得被埋葬在法国的先贤祠里。</p>\n<p>Luz：《查理周刊》不同意这样做。在先贤祠里被火葬对于居里夫人来说并没有改变任何东西！</p>\n<p>记者：这将是一个很好的纪念方式。。。</p>\n<p>Luz：1月7日晚的自发集会我没有去。在那里人们唱起了国歌。我们谈起Charb, Tignous, Cabus, Honoré, Wolinski: 他们一定会嘲笑这种行为态度。人们用他们喜欢的方式来表达自己，但是共和国不应该也变成一个歇斯底里的送葬者。这是一种悲哀。</p>\n<p>记者：我想这将成为你把明天的集会记录在漫画里的理由吧？</p>\n<p>Luz：我也不知道。毫无疑问，明天将会有各种美好的场面，泪水，微笑，或许还会有点荒谬。同时这也会表现出《查理周刊》本质的变化：现在来支持我们的人中，有很多都从来没读过我们的作品。我并不是跟他们生气。我们的目标从来都不是说服所有人。</p>\n<p>记者：去年11月，Charb发出声明呼吁大家来订阅《查理周刊》，来拯救这本杂志。那个时候这本杂志很孤独。</p>\n<p>Luz：自从第三次因为画默罕默德而受到争议之后，一些时候我们感到很孤独。很多关于《查理周刊》无神论的说法、思想都涌现了出来。但实际上我就就只是简简单单，快乐的不信教的人而已。死掉的那些，都是快乐的无信仰的人。现在他们死了，不存在了，就跟其他所有人一样。</p>\n<p>记者：对于瓦尔斯总理没有邀请右派的勒庞来参加明天的共和国大游行一事，你怎么看？</p>\n<p>Luz：我没有任何看法。</p>\n<p>记者：你认为现在人们是有要拯救《查理周刊》的趋势吗？</p>\n<p>Luz：说老实话，去救什么？现在大家还在势头上，有气势。而在一年的时间里，这些为言论自由而战的气势又会剩下多少？会给予私人媒体资金赞助吗？人们会抵制纸媒和报刊亭的衰落吗？人们还会买报纸杂志吗？这些气势会剩下什么？也许会剩下，也许不会。</p>\n<p>记者：你们将如何工作？</p>\n<p>Luz：我们将继续画那些快乐的小人儿。作为漫画家，我们的工作是以这些快乐的人们为素材来画成漫画，以传达一个观点，就是我们所有人都是快乐的小人物，我们会努力把我们需要做的做好。那些被杀害的人都只是画出那些欢快的小人儿的普通人。</p>\n<p>记者：因此让你们这些简单快乐的小人物来拯救整个法国，未免太沉重了？</p>\n<p>Luz：是的。</p>\n<p>（来源：法媒les in rocks，采访：Anne Laffeter）</p>\n<blockquote>\n<p>后记： 欢迎加入我的私人公众号， 和你分享我思考的观点和文章：<br><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1ezbljkk2apj20by0byq3q.jpg\" alt=\"公众号二维码\"></p>\n</blockquote>"
		},
		{
			"title": "Responsive web design[第二期]-position/overlay",
			"link": "http://chocoluffy.com/2016/01/20/Responsive-web-design-%E7%AC%AC%E4%BA%8C%E6%9C%9F-position-overlay/",
			"guid": "http://chocoluffy.com/2016/01/20/Responsive-web-design-第二期-position-overlay/",
			"pubDate": "2016-01-20T20:50:19.000Z",
			"categories": [
				"web design",
				"技术"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>在使用position等css属性的时候会经常在’absolute’,’relative’和’static’上进坑。 本文从实战的角度介绍position的各种应用和如何添加一层优雅的渐变背景过渡层。</p>",
			"content": "<p>在使用position等css属性的时候会经常在’absolute’,’relative’和’static’上进坑。 本文从实战的角度介绍position的各种应用和如何添加一层优雅的渐变背景过渡层。</p>\n<a></a>\n<h2>position: static</h2><p>when dealing with nested container, the parent div is usually set to be <code>position: relative</code> while child div is <code>position: absolute</code> so that the child element can be positioned to any pos within parent container, if the parent div is set to <code>position: static</code>, child element will ignore parent position.</p>\n<blockquote>\n<p>Note that <code>position: static</code> is CSS default setting, so if we want to use <code>position: absolute</code>, we should always set the parent element to <code>position: relative</code>. ReactNative set the default value back, so no worries.</p>\n</blockquote>\n<p>when use position properties like <code>top</code> and <code>left</code>, we usually set them to <code>50%</code>, but the result will be like the element’s top left corner is sticked to the center, while the rest of it is not at the center, which is not what we want, we usually use <code>transform</code> property and get it to <code>-50%</code> to center the element.</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br></pre></td><td><pre><span>top: <span>50</span>%;</span><br><span>left: <span>50</span>%;</span><br><span>transform: translate(-<span>50</span>%, -<span>50</span>%);</span><br></pre></td></tr></table></figure><p>这里我们要说说 static 元素的另外一个坑。</p>\n<p>absolute, relative: 有 z-index。<br>static: 没有 z-index。<br>没有 z-index 的元素默认在有 z-index 的元素下面。</p>\n<p>img 和 h1 元素都是 position: static。z-index 对 static 元素不起作用，因此它们都在绝对定位的元素下面。</p>\n<h2>position: relative</h2><p>接下来看看我们嘴经常见到的<code>position: relative</code>。<br>简单地说， 就是在这个元素原本的位置上做位移， 因为有了<code>position: relative</code>的设定， 我们可以用<code>top``left</code>来移动这个元素。<br>If you specify position:relative, then you can use top or bottom, and left or right to move the element relative to where it would normally occur in the document.</p>\n<p>Let’s move div-1 down 20 pixels, and to the left 40 pixels:<br><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></pre></td><td><pre><span><span>#div-1</span> <span>{</span><br><span> <span><span>position</span>:<span>relative</span></span>;</span><br><span> <span><span>top</span>:<span><span>20px</span></span></span>;</span><br><span> <span><span>left</span>:<span>-<span>40px</span></span></span>;</span><br><span>}</span></span><br></pre></td></tr></table></figure></p>\n<p>Notice the space where div-1 normally would have been if we had not moved it: now it is an empty space. The next element (div-after) did not move when we moved div-1. That’s because div-1 still occupies that original space in the document, even though we have moved it. 效果参考：<img src=\"http://ww3.sinaimg.cn/large/c5ee78b5gw1f08roukzilj20ry0lwjw8.jpg\" alt=\"position relative\"></p>\n<p>另外， position:relative 还带来了z-index的属性。</p>\n<ul><li>references from <a href=\"https://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/\" target=\"_blank\" rel=\"external\">Absolute, Relative, Fixed Positioning: How Do They Differ?</a><br>There are two other things that happen when you set position: relative; on an element that you should be aware of. One is that it introduces the ability to use z-index on that element, which doesn’t really work with statically positioned elements. Even if you don’t set a z-index value, this element will now appear on top of any other statically positioned element. You can’t fight it by setting a higher z-index value on a statically positioned element. The other thing that happens is it limits the scope of absolutely positioned child elements. Any element that is a child of the relatively positioned element can be absolutely positioned within that block.</li>\n</ul><h2>position: absolute</h2><p>如果我们使用<code>position: absolute</code>呢, 这个元素将会脱离文本， 我们可以人意将它摆放到的想去的位置， 注意和static的区别是， 这个absolute是相对<em><strong>上一个定位为relative</strong></em>的定位， 而static是相对浏览器的定位。</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></pre></td><td><pre><span><span>#div-<span>1</span> {</span></span><br><span> position:relative;</span><br><span>}</span><br><span><span>#div-<span>1</span>a {</span></span><br><span> position:absolute;</span><br><span> top:<span>0</span>;</span><br><span> right:<span>0</span>;</span><br><span> width:<span>200</span>px;</span><br><span>}</span><br></pre></td></tr></table></figure><p>效果参考：<img src=\"http://ww4.sinaimg.cn/large/c5ee78b5gw1f08rtih4o4j20pe0iadk1.jpg\" alt=\"relative and absolute\"></p>\n<blockquote>\n<p>最后一个补充：我们常常和<code>float</code>搭配使用的<code>clear: both</code>, 作用是使得定义了该属性的元素的左侧和右侧均不允许出现浮动元素。</p>\n</blockquote>\n<h2>滚动控制</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br></pre></td><td><pre><span>&lt;div id=\"slider-control\"&gt;</span><br><span>  &lt;a href=\"#native\" class=\"active\"&gt;</span><br><span>    &lt;div class=\"dot\"&gt;&lt;/div&gt;</span><br><span>  &lt;/a&gt;</span><br><span></span><br><span>  &lt;a href=\"#touch\"&gt;</span><br><span>    &lt;div class=\"dot\"&gt;&lt;/div&gt;</span><br><span>  &lt;/a&gt;</span><br><span></span><br><span>  &lt;a href=\"#async\"&gt;</span><br><span>    &lt;div class=\"dot\"&gt;&lt;/div&gt;</span><br><span>  &lt;/a&gt;</span><br><span></span><br><span>  &lt;a href=\"#flex\"&gt;</span><br><span>    &lt;div class=\"dot\"&gt;&lt;/div&gt;</span><br><span>  &lt;/a&gt;</span><br><span>&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>让它们position: fixed, 效果参考：</p>\n<p><img src=\"http://ww3.sinaimg.cn/large/c5ee78b5gw1f06g8ze3fhj20yo0pw76w.jpg\" alt=\"movement control\"></p>\n<h2>overlay 平滑过渡</h2><figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></pre></td><td><pre><span>&lt;section&gt;</span><br><span>    &lt;div class=\"container\" id=\"intro-section\"&gt;</span><br><span>    &lt;div class=\"overlay\"&gt;&lt;/div&gt;</span><br><span>    &lt;h1&gt;I Love React&lt;/h1&gt;</span><br><span>    &lt;p&gt;I just want to see the so-called live-coding&lt;/p&gt;</span><br><span>    &lt;/div&gt;</span><br><span>&lt;/section&gt;</span><br></pre></td></tr></table></figure><p>将最上面的container的背景设置为图片背景， 然后中间加一个div.overlay的div, 然后通过渐变设置其背景为主背景颜色。</p>\n<figure><table><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></pre></td><td><pre><span><span>#intro-section{</span></span><br><span>  background-image: url(../image/background.jpg);</span><br><span>  background-size: cover;</span><br><span>  background-position: center;</span><br><span>}</span><br><span></span><br><span><span>#intro-section h1, p{</span></span><br><span>  position: relative;</span><br><span>  z-index: <span>1</span>;</span><br><span>}</span><br><span></span><br><span>.overlay{</span><br><span>  position: absolute;</span><br><span>  top: <span>0</span>;</span><br><span>  left: <span>0</span>;</span><br><span>  width: <span>100</span>%;</span><br><span>  height: <span>100</span>%;</span><br><span>  background-image: linear-gradient(rgba(<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>),rgba(<span>22</span>, <span>21</span>, <span>37</span>, <span>1</span>));</span><br><span>}</span><br></pre></td></tr></table></figure><p><img src=\"http://ww4.sinaimg.cn/large/c5ee78b5gw1f06lr99d5xj21kw0q47cw.jpg\" alt=\"overlay\"></p>\n<h2>参考资料</h2><ul><li><a href=\"http://hex2rgba.devoth.com/\" target=\"_blank\" rel=\"external\">hex to rgba online converter</a></li>\n<li><a href=\"https://github.com/luckymore0520/sike-react-ilovereact\" target=\"_blank\" rel=\"external\">ilovereact</a></li>\n<li><a href=\"http://gugugupan.github.io/sike-react-ilovereact/\" target=\"_blank\" rel=\"external\">最后成品效果ilovereact－添加动画</a></li>\n<li><a href=\"https://github.com/gugugupan/sike-react-ilovereact/blob/master/index.html\" target=\"_blank\" rel=\"external\">上面github项目的index.html</a></li>\n</ul><blockquote>\n<p>后记： 欢迎加入我的私人公众号， 和你分享我思考的观点和文章：<br><img src=\"http://ww2.sinaimg.cn/large/c5ee78b5gw1ezbljkk2apj20by0byq3q.jpg\" alt=\"公众号二维码\"></p>\n</blockquote>"
		},
		{
			"title": "时间知道[持续更新...]",
			"link": "http://chocoluffy.com/2016/01/12/%E6%97%B6%E9%97%B4%E7%9F%A5%E9%81%93-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/",
			"guid": "http://chocoluffy.com/2016/01/12/时间知道-持续更新/",
			"pubDate": "2016-01-12T17:46:57.000Z",
			"categories": [
				"收藏帖",
				"原创"
			],
			"author": "Shunzhe Yu",
			"thumbnail": "",
			"description": "<p>因为， 只有时间知道。</p>",
			"content": "<p>因为， 只有时间知道。</p>\n<a></a>\n<h2>技术</h2><ul><li><a href=\"http://hanhailong.com/\" target=\"_blank\" rel=\"external\">韩海龙的技术博客(Android\\IOS)</a></li>\n<li><a href=\"http://jinglei.me/\" target=\"_blank\" rel=\"external\">荆雷的技术博客(React\\Meteor)</a></li>\n<li><a href=\"http://ramiro.org/vis/hn-most-linked-books-unique-users/\" target=\"_blank\" rel=\"external\">Hacker News上评价最高的书</a></li>\n<li><a href=\"http://www.yehbeats.com/\" target=\"_blank\" rel=\"external\">YeHbeats的技术博客(Python\\Hexo)</a></li>\n<li><a href=\"http://zyden.vicp.cc/#blog\" target=\"_blank\" rel=\"external\">Den的技术博客(Swift\\Design)</a></li>\n<li><a href=\"http://aljun.me/\" target=\"_blank\" rel=\"external\">Aljun的博客(Python)</a></li>\n</ul><h2>文字</h2><ul><li><a href=\"http://think-different-8.lofter.com/view\" target=\"_blank\" rel=\"external\">余舜哲的lofter足迹</a></li>\n</ul>"
		}
	]
}
